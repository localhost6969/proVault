import{e as Ur,$ as Du}from"./events-f1433338.js";import{c as Im}from"./_commonjs-dynamic-modules-302442b1.js";import{b3 as Dn,d as _r,r as xm,b4 as vr,b5 as cr,b6 as tu,b7 as Om,e as Nd}from"./index-2c0fe92c.js";var Zo={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ru=function(i,e){return ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ru(i,e)};function Pm(i,e){ru(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var iu=function(){return iu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},iu.apply(this,arguments)};function Am(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Tm(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Rm(i,e){return function(t,s){e(t,s,i)}}function Cm(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Nm(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(w){try{p(s.next(w))}catch(P){l(P)}}function y(w){try{p(s.throw(w))}catch(P){l(P)}}function p(w){w.done?c(w.value):o(w.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function $m(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(w){return y([p,w])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Dm(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Fm(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function nu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $d(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Lm(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat($d(arguments[e]));return i}function Um(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function bs(i){return this instanceof bs?(this.v=i,this):new bs(i)}function jm(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(I){s[I]&&(o[I]=function(T){return new Promise(function($,B){c.push([I,T,$,B])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch($){P(c[0][3],$)}}function y(I){I.value instanceof bs?Promise.resolve(I.value.v).then(p,w):P(c[0][2],I)}function p(I){f("next",I)}function w(I){f("throw",I)}function P(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Mm(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:bs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function qm(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof nu=="function"?nu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function Hm(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function zm(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function Bm(i){return i&&i.__esModule?i:{default:i}}function Km(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Vm(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const km=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return iu},__asyncDelegator:Mm,__asyncGenerator:jm,__asyncValues:qm,__await:bs,__awaiter:Nm,__classPrivateFieldGet:Km,__classPrivateFieldSet:Vm,__createBinding:Dm,__decorate:Tm,__exportStar:Fm,__extends:Pm,__generator:$m,__importDefault:Bm,__importStar:zm,__makeTemplateObject:Hm,__metadata:Cm,__param:Rm,__read:$d,__rest:Am,__spread:Lm,__spreadArrays:Um,__values:nu},Symbol.toStringTag,{value:"Module"})),Dd=Dn(km);var As={};Object.defineProperty(As,"__esModule",{value:!0});function Gm(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}As.safeJsonParse=Gm;function Wm(i){return typeof i=="string"?i:JSON.stringify(i,(e,t)=>typeof t>"u"?null:t)}As.safeJsonStringify=Wm;var ns={exports:{}},tf;function Ym(){return tf||(tf=1,function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof _r<"u"&&_r.localStorage?ns.exports=_r.localStorage:typeof window<"u"&&window.localStorage?ns.exports=window.localStorage:ns.exports=new e}()),ns.exports}var Fc={},ss={},rf;function Jm(){if(rf)return ss;rf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.IKeyValueStorage=void 0;class i{}return ss.IKeyValueStorage=i,ss}var os={},nf;function Qm(){if(nf)return os;nf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.parseEntry=void 0;const i=As;function e(t){var s;return[t[0],i.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return os.parseEntry=e,os}var sf;function Xm(){return sf||(sf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Dd;e.__exportStar(Jm(),i),e.__exportStar(Qm(),i)}(Fc)),Fc}Object.defineProperty(Zo,"__esModule",{value:!0});Zo.KeyValueStorage=void 0;const An=Dd,of=As,Zm=An.__importDefault(Ym()),eb=Xm();class Fd{constructor(){this.localStorage=Zm.default}getKeys(){return An.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return An.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(eb.parseEntry)})}getItem(e){return An.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return of.safeJsonParse(t)})}setItem(e,t){return An.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,of.safeJsonStringify(t))})}removeItem(e){return An.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Zo.KeyValueStorage=Fd;var tb=Zo.default=Fd,Fn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var su=function(i,e){return su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},su(i,e)};function rb(i,e){su(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ou=function(){return ou=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},ou.apply(this,arguments)};function ib(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function nb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function sb(i,e){return function(t,s){e(t,s,i)}}function ob(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function ab(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(w){try{p(s.next(w))}catch(P){l(P)}}function y(w){try{p(s.throw(w))}catch(P){l(P)}}function p(w){w.done?c(w.value):o(w.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function cb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(w){return y([p,w])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function ub(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function hb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function au(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ld(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function lb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ld(arguments[e]));return i}function fb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function ws(i){return this instanceof ws?(this.v=i,this):new ws(i)}function db(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(I){s[I]&&(o[I]=function(T){return new Promise(function($,B){c.push([I,T,$,B])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch($){P(c[0][3],$)}}function y(I){I.value instanceof ws?Promise.resolve(I.value.v).then(p,w):P(c[0][2],I)}function p(I){f("next",I)}function w(I){f("throw",I)}function P(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function pb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:ws(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function gb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof au=="function"?au(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function yb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function _b(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function vb(i){return i&&i.__esModule?i:{default:i}}function mb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function bb(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const wb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ou},__asyncDelegator:pb,__asyncGenerator:db,__asyncValues:gb,__await:ws,__awaiter:ab,__classPrivateFieldGet:mb,__classPrivateFieldSet:bb,__createBinding:ub,__decorate:nb,__exportStar:hb,__extends:rb,__generator:cb,__importDefault:vb,__importStar:_b,__makeTemplateObject:yb,__metadata:ob,__param:sb,__read:Ld,__rest:ib,__spread:lb,__spreadArrays:fb,__values:au},Symbol.toStringTag,{value:"Module"})),ea=Dn(wb);var as={},_e={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cu=function(i,e){return cu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},cu(i,e)};function Eb(i,e){cu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var uu=function(){return uu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},uu.apply(this,arguments)};function Sb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Ib(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function xb(i,e){return function(t,s){e(t,s,i)}}function Ob(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Pb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(w){try{p(s.next(w))}catch(P){l(P)}}function y(w){try{p(s.throw(w))}catch(P){l(P)}}function p(w){w.done?c(w.value):o(w.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function Ab(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(w){return y([p,w])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Tb(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Rb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function hu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ud(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Cb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ud(arguments[e]));return i}function Nb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Es(i){return this instanceof Es?(this.v=i,this):new Es(i)}function $b(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(I){s[I]&&(o[I]=function(T){return new Promise(function($,B){c.push([I,T,$,B])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch($){P(c[0][3],$)}}function y(I){I.value instanceof Es?Promise.resolve(I.value.v).then(p,w):P(c[0][2],I)}function p(I){f("next",I)}function w(I){f("throw",I)}function P(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Db(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Es(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Fb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof hu=="function"?hu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function Lb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Ub(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function jb(i){return i&&i.__esModule?i:{default:i}}function Mb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function qb(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const Hb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return uu},__asyncDelegator:Db,__asyncGenerator:$b,__asyncValues:Fb,__await:Es,__awaiter:Pb,__classPrivateFieldGet:Mb,__classPrivateFieldSet:qb,__createBinding:Tb,__decorate:Ib,__exportStar:Rb,__extends:Eb,__generator:Ab,__importDefault:jb,__importStar:Ub,__makeTemplateObject:Lb,__metadata:Ob,__param:xb,__read:Ud,__rest:Sb,__spread:Cb,__spreadArrays:Nb,__values:hu},Symbol.toStringTag,{value:"Module"})),ta=Dn(Hb);var Lc={},cs={},af;function zb(){if(af)return cs;af=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return cs.delay=i,cs}var Qi={},Uc={},Xi={},cf;function Bb(){return cf||(cf=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.ONE_THOUSAND=Xi.ONE_HUNDRED=void 0,Xi.ONE_HUNDRED=100,Xi.ONE_THOUSAND=1e3),Xi}var jc={},uf;function Kb(){return uf||(uf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(jc)),jc}var hf;function jd(){return hf||(hf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ta;e.__exportStar(Bb(),i),e.__exportStar(Kb(),i)}(Uc)),Uc}var lf;function Vb(){if(lf)return Qi;lf=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.fromMiliseconds=Qi.toMiliseconds=void 0;const i=jd();function e(s){return s*i.ONE_THOUSAND}Qi.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return Qi.fromMiliseconds=t,Qi}var ff;function kb(){return ff||(ff=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ta;e.__exportStar(zb(),i),e.__exportStar(Vb(),i)}(Lc)),Lc}var Pn={},df;function Gb(){if(df)return Pn;df=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Pn.Watch=i,Pn.default=i,Pn}var Mc={},us={},pf;function Wb(){if(pf)return us;pf=1,Object.defineProperty(us,"__esModule",{value:!0}),us.IWatch=void 0;class i{}return us.IWatch=i,us}var gf;function Yb(){return gf||(gf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ta.__exportStar(Wb(),i)}(Mc)),Mc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ta;e.__exportStar(kb(),i),e.__exportStar(Gb(),i),e.__exportStar(Yb(),i),e.__exportStar(jd(),i)})(_e);var qc={},hs={};let rn=class{};const Jb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:rn},Symbol.toStringTag,{value:"Module"})),Qb=Dn(Jb);var yf;function Xb(){if(yf)return hs;yf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.IHeartBeat=void 0;const i=Qb;class e extends i.IEvents{constructor(s){super()}}return hs.IHeartBeat=e,hs}var _f;function Md(){return _f||(_f=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ea.__exportStar(Xb(),i)}(qc)),qc}var Hc={},Zi={},vf;function Zb(){if(vf)return Zi;vf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.HEARTBEAT_EVENTS=Zi.HEARTBEAT_INTERVAL=void 0;const i=_e;return Zi.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Zi}var mf;function qd(){return mf||(mf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ea.__exportStar(Zb(),i)}(Hc)),Hc}var bf;function ew(){if(bf)return as;bf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.HeartBeat=void 0;const i=ea,e=Ur,t=_e,s=Md(),o=qd();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return as.HeartBeat=c,as}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ea;e.__exportStar(ew(),i),e.__exportStar(Md(),i),e.__exportStar(qd(),i)})(Fn);var Ze={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lu=function(i,e){return lu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},lu(i,e)};function tw(i,e){lu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var fu=function(){return fu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},fu.apply(this,arguments)};function rw(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function iw(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function nw(i,e){return function(t,s){e(t,s,i)}}function sw(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function ow(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(w){try{p(s.next(w))}catch(P){l(P)}}function y(w){try{p(s.throw(w))}catch(P){l(P)}}function p(w){w.done?c(w.value):o(w.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function aw(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(w){return y([p,w])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function cw(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function uw(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function du(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hd(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function hw(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Hd(arguments[e]));return i}function lw(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ss(i){return this instanceof Ss?(this.v=i,this):new Ss(i)}function fw(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(I){s[I]&&(o[I]=function(T){return new Promise(function($,B){c.push([I,T,$,B])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch($){P(c[0][3],$)}}function y(I){I.value instanceof Ss?Promise.resolve(I.value.v).then(p,w):P(c[0][2],I)}function p(I){f("next",I)}function w(I){f("throw",I)}function P(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function dw(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ss(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function pw(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof du=="function"?du(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function gw(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function yw(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function _w(i){return i&&i.__esModule?i:{default:i}}function vw(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function mw(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const bw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return fu},__asyncDelegator:dw,__asyncGenerator:fw,__asyncValues:pw,__await:Ss,__awaiter:ow,__classPrivateFieldGet:vw,__classPrivateFieldSet:mw,__createBinding:cw,__decorate:iw,__exportStar:uw,__extends:tw,__generator:aw,__importDefault:_w,__importStar:yw,__makeTemplateObject:gw,__metadata:sw,__param:nw,__read:Hd,__rest:rw,__spread:hw,__spreadArrays:lw,__values:du},Symbol.toStringTag,{value:"Module"})),ww=Dn(bw);var zc,wf;function Ew(){if(wf)return zc;wf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}zc=e;function e(t,s,o){var c=o&&o.stringify||i,l=1;if(typeof t=="object"&&t!==null){var f=s.length+l;if(f===1)return t;var y=new Array(f);y[0]=c(t);for(var p=1;p<f;p++)y[p]=c(s[p]);return y.join(" ")}if(typeof t!="string")return t;var w=s.length;if(w===0)return t;for(var P="",I=1-l,T=-1,$=t&&t.length||0,B=0;B<$;){if(t.charCodeAt(B)===37&&B+1<$){switch(T=T>-1?T:0,t.charCodeAt(B+1)){case 100:case 102:if(I>=w||s[I]==null)break;T<B&&(P+=t.slice(T,B)),P+=Number(s[I]),T=B+2,B++;break;case 105:if(I>=w||s[I]==null)break;T<B&&(P+=t.slice(T,B)),P+=Math.floor(Number(s[I])),T=B+2,B++;break;case 79:case 111:case 106:if(I>=w||s[I]===void 0)break;T<B&&(P+=t.slice(T,B));var k=typeof s[I];if(k==="string"){P+="'"+s[I]+"'",T=B+2,B++;break}if(k==="function"){P+=s[I].name||"<anonymous>",T=B+2,B++;break}P+=c(s[I]),T=B+2,B++;break;case 115:if(I>=w)break;T<B&&(P+=t.slice(T,B)),P+=String(s[I]),T=B+2,B++;break;case 37:T<B&&(P+=t.slice(T,B)),P+="%",T=B+2,B++,I--;break}++I}++B}return T===-1?t:(T<$&&(P+=t.slice(T)),P)}return zc}var Bc,Ef;function Sw(){if(Ef)return Bc;Ef=1;const i=Ew();Bc=o;const e=C().console||{},t={mapHttpRequest:$,mapHttpResponse:$,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:$,res:$,err:I};function s(E,u){return Array.isArray(E)?E.filter(function(Y){return Y!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const Y=E.serializers||{},G=s(E.browser.serialize,Y);let ne=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ne=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),E.enabled===!1&&(E.level="silent");const de=E.level||"info",m=Object.create(b);m.log||(m.log=k),Object.defineProperty(m,"levelVal",{get:ee}),Object.defineProperty(m,"level",{get:Q,set:K});const O={transmit:u,serialize:G,asObject:E.browser.asObject,levels:ce,timestamp:T(E)};m.levels=o.levels,m.level=de,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=k,m.serializers=Y,m._serialize=G,m._stdErrSerialize=ne,m.child=V,u&&(m._logEvent=P());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function K(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(O,m,"error","log"),c(O,m,"fatal","error"),c(O,m,"warn","error"),c(O,m,"info","log"),c(O,m,"debug","log"),c(O,m,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},G&&J.serializers&&(re.serializers=J.serializers);const be=re.serializers;if(G&&be){var se=Object.assign({},Y,be),we=E.browser.serialize===!0?Object.keys(se):G;delete J.serializers,y([J],we,se,this._stdErrSerialize)}function le(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,J,"error"),this.fatal=p(ve,J,"fatal"),this.warn=p(ve,J,"warn"),this.info=p(ve,J,"info"),this.debug=p(ve,J,"debug"),this.trace=p(ve,J,"trace"),se&&(this.serializers=se,this._serialize=we),u&&(this._logEvent=P([].concat(ve._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return m}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ae,epochTime:F,unixTime:M,isoTime:A});function c(E,u,b,Y){const G=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?k:G[b]?G[b]:e[b]||e[Y]||k,l(E,u,b)}function l(E,u,b){!E.transmit&&u[b]===k||(u[b]=function(Y){return function(){const ne=E.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var m=0;m<ce.length;m++)ce[m]=arguments[m];if(E.serialize&&!E.asObject&&y(ce,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?Y.call(de,f(this,b,ce,ne)):Y.apply(de,ce),E.transmit){const O=E.transmit.level||u.level,ee=o.levels.values[O],Q=o.levels.values[b];if(Q<ee)return;w(this,{ts:ne,methodLevel:b,methodValue:Q,transmitLevel:O,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ce)}}}(u[b]))}function f(E,u,b,Y){E._serialize&&y(b,E._serialize,E.serializers,E._stdErrSerialize);const G=b.slice();let ne=G[0];const ce={};Y&&(ce.time=Y),ce.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),ne!==null&&typeof ne=="object"){for(;de--&&typeof G[0]=="object";)Object.assign(ce,G.shift());ne=G.length?i(G.shift(),G):void 0}else typeof ne=="string"&&(ne=i(G.shift(),G));return ne!==void 0&&(ce.msg=ne),ce}function y(E,u,b,Y){for(const G in E)if(Y&&E[G]instanceof Error)E[G]=o.stdSerializers.err(E[G]);else if(typeof E[G]=="object"&&!Array.isArray(E[G]))for(const ne in E[G])u&&u.indexOf(ne)>-1&&ne in b&&(E[G][ne]=b[ne](E[G][ne]))}function p(E,u,b){return function(){const Y=new Array(1+arguments.length);Y[0]=u;for(var G=1;G<Y.length;G++)Y[G]=arguments[G-1];return E[b].apply(this,Y)}}function w(E,u,b){const Y=u.send,G=u.ts,ne=u.methodLevel,ce=u.methodValue,de=u.val,m=E._logEvent.bindings;y(b,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=G,E._logEvent.messages=b.filter(function(O){return m.indexOf(O)===-1}),E._logEvent.level.label=ne,E._logEvent.level.value=ce,Y(ne,E._logEvent,de),E._logEvent=P(m)}function P(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function I(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const b in E)u[b]===void 0&&(u[b]=E[b]);return u}function T(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ae:F}function $(){return{}}function B(E){return E}function k(){}function ae(){return!1}function F(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function A(){return new Date(Date.now()).toISOString()}function C(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Bc}var en={},Sf;function zd(){return Sf||(Sf=1,Object.defineProperty(en,"__esModule",{value:!0}),en.PINO_CUSTOM_CONTEXT_KEY=en.PINO_LOGGER_DEFAULTS=void 0,en.PINO_LOGGER_DEFAULTS={level:"info"},en.PINO_CUSTOM_CONTEXT_KEY="custom_context"),en}var sr={},If;function Iw(){if(If)return sr;If=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const i=zd();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=e;function t(f,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}sr.getBrowserLoggerContext=t;function s(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){return f[p]=y,f}sr.setBrowserLoggerContext=s;function o(f,y=i.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof f.bindings>"u"?p=t(f,y):p=f.bindings().context||"",p}sr.getLoggerContext=o;function c(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){const w=o(f,p);return w.trim()?`${w}/${y}`:y}sr.formatChildLoggerContext=c;function l(f,y,p=i.PINO_CUSTOM_CONTEXT_KEY){const w=c(f,y,p),P=f.child({context:w});return s(P,w,p)}return sr.generateChildLogger=l,sr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=ww,t=e.__importDefault(Sw());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(zd(),i),e.__exportStar(Iw(),i)})(Ze);class xw extends rn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let Ow=class extends rn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}};class Pw{constructor(e,t){this.logger=e,this.core=t}}let Aw=class extends rn{constructor(e,t){super(),this.relayer=e,this.logger=t}},Tw=class extends rn{constructor(e){super()}},Rw=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class Cw extends rn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let Nw=class extends rn{constructor(e,t){super(),this.core=e,this.logger=t}},$w=class{constructor(e,t){this.projectId=e,this.logger=t}},Dw=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Fw=class{constructor(e){this.client=e}};const Lw=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Uw=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Fu(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return Uw(i)}catch{return i}}function Is(i){return typeof i=="string"?i:Lw(i)||""}var Lu={},Ln={},ra={},ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.BrowserRandomSource=void 0;const xf=65536;class jw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=xf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,xf)));return t}}ia.BrowserRandomSource=jw;var na={},Or={};Object.defineProperty(Or,"__esModule",{value:!0});function Mw(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Or.wipe=Mw;Object.defineProperty(na,"__esModule",{value:!0});na.NodeRandomSource=void 0;const qw=Or;class Hw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Im<"u"){const e=xm;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,qw.wipe)(t),s}}na.NodeRandomSource=Hw;Object.defineProperty(ra,"__esModule",{value:!0});ra.SystemRandomSource=void 0;const zw=ia,Bw=na;class Kw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new zw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Bw.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ra.SystemRandomSource=Kw;var Le={},Bd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var p=f>>>16&65535,w=f&65535,P=y>>>16&65535,I=y&65535;return w*I+(p*I+w*P<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function o(f,y){return f<<y|f>>>32-y}i.rotl=o;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Bd);Object.defineProperty(Le,"__esModule",{value:!0});var Kd=Bd;function Vw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Le.readInt16BE=Vw;function kw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Le.readUint16BE=kw;function Gw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Le.readInt16LE=Gw;function Ww(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Le.readUint16LE=Ww;function Vd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Le.writeUint16BE=Vd;Le.writeInt16BE=Vd;function kd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Le.writeUint16LE=kd;Le.writeInt16LE=kd;function pu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Le.readInt32BE=pu;function gu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Le.readUint32BE=gu;function yu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Le.readInt32LE=yu;function _u(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Le.readUint32LE=_u;function ko(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Le.writeUint32BE=ko;Le.writeInt32BE=ko;function Go(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Le.writeUint32LE=Go;Le.writeInt32LE=Go;function Yw(i,e){e===void 0&&(e=0);var t=pu(i,e),s=pu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=Yw;function Jw(i,e){e===void 0&&(e=0);var t=gu(i,e),s=gu(i,e+4);return t*4294967296+s}Le.readUint64BE=Jw;function Qw(i,e){e===void 0&&(e=0);var t=yu(i,e),s=yu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=Qw;function Xw(i,e){e===void 0&&(e=0);var t=_u(i,e),s=_u(i,e+4);return s*4294967296+t}Le.readUint64LE=Xw;function Gd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ko(i/4294967296>>>0,e,t),ko(i>>>0,e,t+4),e}Le.writeUint64BE=Gd;Le.writeInt64BE=Gd;function Wd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Go(i>>>0,e,t),Go(i/4294967296>>>0,e,t+4),e}Le.writeUint64LE=Wd;Le.writeInt64LE=Wd;function Zw(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=Zw;function eE(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=eE;function tE(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Kd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=tE;function rE(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Kd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=rE;function iE(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Le.readFloat32BE=iE;function nE(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=nE;function sE(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Le.readFloat64BE=sE;function oE(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=oE;function aE(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Le.writeFloat32BE=aE;function cE(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Le.writeFloat32LE=cE;function uE(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Le.writeFloat64BE=uE;function hE(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Le.writeFloat64LE=hE;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=ra,t=Le,s=Or;i.defaultRandomSource=new e.SystemRandomSource;function o(p,w=i.defaultRandomSource){return w.randomBytes(p)}i.randomBytes=o;function c(p=i.defaultRandomSource){const w=o(4,p),P=(0,t.readUint32LE)(w);return(0,s.wipe)(w),P}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,w=l,P=i.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let I="";const T=w.length,$=256-256%T;for(;p>0;){const B=o(Math.ceil(p*256/$),P);for(let k=0;k<B.length&&p>0;k++){const ae=B[k];ae<$&&(I+=w.charAt(ae%T),p--)}(0,s.wipe)(B)}return I}i.randomString=f;function y(p,w=l,P=i.defaultRandomSource){const I=Math.ceil(p/(Math.log(w.length)/Math.LN2));return f(I,w,P)}i.randomStringForEntropy=y})(Ln);var Yd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Or;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=y[w++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[w++],p--;return this},f.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,P=p/536870912|0,I=p<<3,T=p%128<112?128:256;this._buffer[w]=128;for(var $=w+1;$<T-8;$++)this._buffer[$]=0;e.writeUint32BE(P,this._buffer,T-8),e.writeUint32BE(I,this._buffer,T-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var $=0;$<this.digestLength/8;$++)e.writeUint32BE(this._stateHi[$],y,$*8),e.writeUint32BE(this._stateLo[$],y,$*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,p,w,P,I,T){for(var $=p[0],B=p[1],k=p[2],ae=p[3],F=p[4],M=p[5],A=p[6],C=p[7],E=w[0],u=w[1],b=w[2],Y=w[3],G=w[4],ne=w[5],ce=w[6],de=w[7],m,O,ee,Q,K,V,J,re;T>=128;){for(var be=0;be<16;be++){var se=8*be+I;f[be]=e.readUint32BE(P,se),y[be]=e.readUint32BE(P,se+4)}for(var be=0;be<80;be++){var we=$,le=B,ve=k,H=ae,q=F,D=M,d=A,R=C,oe=E,fe=u,xe=b,ze=Y,Ve=G,Ue=ne,pt=ce,gt=de;if(m=C,O=de,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=(F>>>14|G<<32-14)^(F>>>18|G<<32-18)^(G>>>41-32|F<<32-(41-32)),O=(G>>>14|F<<32-14)^(G>>>18|F<<32-18)^(F>>>41-32|G<<32-(41-32)),K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,m=F&M^~F&A,O=G&ne^~G&ce,K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,m=o[be*2],O=o[be*2+1],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,m=f[be%16],O=y[be%16],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=K&65535|V<<16,m=ee,O=Q,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=($>>>28|E<<32-28)^(E>>>34-32|$<<32-(34-32))^(E>>>39-32|$<<32-(39-32)),O=(E>>>28|$<<32-28)^($>>>34-32|E<<32-(34-32))^($>>>39-32|E<<32-(39-32)),K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,m=$&B^$&k^B&k,O=E&u^E&b^u&b,K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,R=J&65535|re<<16,gt=K&65535|V<<16,m=H,O=ze,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=ee,O=Q,K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,H=J&65535|re<<16,ze=K&65535|V<<16,B=we,k=le,ae=ve,F=H,M=q,A=D,C=d,$=R,u=oe,b=fe,Y=xe,G=ze,ne=Ve,ce=Ue,de=pt,E=gt,be%16===15)for(var se=0;se<16;se++)m=f[se],O=y[se],K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=f[(se+9)%16],O=y[(se+9)%16],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,ee=f[(se+1)%16],Q=y[(se+1)%16],m=(ee>>>1|Q<<32-1)^(ee>>>8|Q<<32-8)^ee>>>7,O=(Q>>>1|ee<<32-1)^(Q>>>8|ee<<32-8)^(Q>>>7|ee<<32-7),K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,ee=f[(se+14)%16],Q=y[(se+14)%16],m=(ee>>>19|Q<<32-19)^(Q>>>61-32|ee<<32-(61-32))^ee>>>6,O=(Q>>>19|ee<<32-19)^(ee>>>61-32|Q<<32-(61-32))^(Q>>>6|ee<<32-6),K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,f[se]=J&65535|re<<16,y[se]=K&65535|V<<16}m=$,O=E,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[0],O=w[0],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[0]=$=J&65535|re<<16,w[0]=E=K&65535|V<<16,m=B,O=u,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[1],O=w[1],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[1]=B=J&65535|re<<16,w[1]=u=K&65535|V<<16,m=k,O=b,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[2],O=w[2],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[2]=k=J&65535|re<<16,w[2]=b=K&65535|V<<16,m=ae,O=Y,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[3],O=w[3],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[3]=ae=J&65535|re<<16,w[3]=Y=K&65535|V<<16,m=F,O=G,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[4],O=w[4],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[4]=F=J&65535|re<<16,w[4]=G=K&65535|V<<16,m=M,O=ne,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[5],O=w[5],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[5]=M=J&65535|re<<16,w[5]=ne=K&65535|V<<16,m=A,O=ce,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[6],O=w[6],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[6]=A=J&65535|re<<16,w[6]=ce=K&65535|V<<16,m=C,O=de,K=O&65535,V=O>>>16,J=m&65535,re=m>>>16,m=p[7],O=w[7],K+=O&65535,V+=O>>>16,J+=m&65535,re+=m>>>16,V+=K>>>16,J+=V>>>16,re+=J>>>16,p[7]=C=J&65535|re<<16,w[7]=de=K&65535|V<<16,I+=128,T-=128}return I}function l(f){var y=new s;y.update(f);var p=y.digest();return y.clean(),p}i.hash=l})(Yd);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=Ln,t=Yd,s=Or;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(H){const q=new Float64Array(16);if(H)for(let D=0;D<H.length;D++)q[D]=H[D];return q}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),P=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(H,q){for(let D=0;D<16;D++)H[D]=q[D]|0}function $(H){let q=1;for(let D=0;D<16;D++){let d=H[D]+q+65535;q=Math.floor(d/65536),H[D]=d-q*65536}H[0]+=q-1+37*(q-1)}function B(H,q,D){const d=~(D-1);for(let R=0;R<16;R++){const oe=d&(H[R]^q[R]);H[R]^=oe,q[R]^=oe}}function k(H,q){const D=o(),d=o();for(let R=0;R<16;R++)d[R]=q[R];$(d),$(d),$(d);for(let R=0;R<2;R++){D[0]=d[0]-65517;for(let fe=1;fe<15;fe++)D[fe]=d[fe]-65535-(D[fe-1]>>16&1),D[fe-1]&=65535;D[15]=d[15]-32767-(D[14]>>16&1);const oe=D[15]>>16&1;D[14]&=65535,B(d,D,1-oe)}for(let R=0;R<16;R++)H[2*R]=d[R]&255,H[2*R+1]=d[R]>>8}function ae(H,q){let D=0;for(let d=0;d<32;d++)D|=H[d]^q[d];return(1&D-1>>>8)-1}function F(H,q){const D=new Uint8Array(32),d=new Uint8Array(32);return k(D,H),k(d,q),ae(D,d)}function M(H){const q=new Uint8Array(32);return k(q,H),q[0]&1}function A(H,q){for(let D=0;D<16;D++)H[D]=q[2*D]+(q[2*D+1]<<8);H[15]&=32767}function C(H,q,D){for(let d=0;d<16;d++)H[d]=q[d]+D[d]}function E(H,q,D){for(let d=0;d<16;d++)H[d]=q[d]-D[d]}function u(H,q,D){let d,R,oe=0,fe=0,xe=0,ze=0,Ve=0,Ue=0,pt=0,gt=0,Me=0,Oe=0,$e=0,De=0,qe=0,Ae=0,Fe=0,Ie=0,Te=0,Be=0,Pe=0,ke=0,We=0,et=0,tt=0,Je=0,Zt=0,ur=0,Gr=0,er=0,ri=0,wi=0,Ui=0,Et=D[0],yt=D[1],St=D[2],It=D[3],bt=D[4],_t=D[5],Dt=D[6],Ft=D[7],xt=D[8],Lt=D[9],Ot=D[10],Tt=D[11],Pt=D[12],ht=D[13],Ut=D[14],jt=D[15];d=q[0],oe+=d*Et,fe+=d*yt,xe+=d*St,ze+=d*It,Ve+=d*bt,Ue+=d*_t,pt+=d*Dt,gt+=d*Ft,Me+=d*xt,Oe+=d*Lt,$e+=d*Ot,De+=d*Tt,qe+=d*Pt,Ae+=d*ht,Fe+=d*Ut,Ie+=d*jt,d=q[1],fe+=d*Et,xe+=d*yt,ze+=d*St,Ve+=d*It,Ue+=d*bt,pt+=d*_t,gt+=d*Dt,Me+=d*Ft,Oe+=d*xt,$e+=d*Lt,De+=d*Ot,qe+=d*Tt,Ae+=d*Pt,Fe+=d*ht,Ie+=d*Ut,Te+=d*jt,d=q[2],xe+=d*Et,ze+=d*yt,Ve+=d*St,Ue+=d*It,pt+=d*bt,gt+=d*_t,Me+=d*Dt,Oe+=d*Ft,$e+=d*xt,De+=d*Lt,qe+=d*Ot,Ae+=d*Tt,Fe+=d*Pt,Ie+=d*ht,Te+=d*Ut,Be+=d*jt,d=q[3],ze+=d*Et,Ve+=d*yt,Ue+=d*St,pt+=d*It,gt+=d*bt,Me+=d*_t,Oe+=d*Dt,$e+=d*Ft,De+=d*xt,qe+=d*Lt,Ae+=d*Ot,Fe+=d*Tt,Ie+=d*Pt,Te+=d*ht,Be+=d*Ut,Pe+=d*jt,d=q[4],Ve+=d*Et,Ue+=d*yt,pt+=d*St,gt+=d*It,Me+=d*bt,Oe+=d*_t,$e+=d*Dt,De+=d*Ft,qe+=d*xt,Ae+=d*Lt,Fe+=d*Ot,Ie+=d*Tt,Te+=d*Pt,Be+=d*ht,Pe+=d*Ut,ke+=d*jt,d=q[5],Ue+=d*Et,pt+=d*yt,gt+=d*St,Me+=d*It,Oe+=d*bt,$e+=d*_t,De+=d*Dt,qe+=d*Ft,Ae+=d*xt,Fe+=d*Lt,Ie+=d*Ot,Te+=d*Tt,Be+=d*Pt,Pe+=d*ht,ke+=d*Ut,We+=d*jt,d=q[6],pt+=d*Et,gt+=d*yt,Me+=d*St,Oe+=d*It,$e+=d*bt,De+=d*_t,qe+=d*Dt,Ae+=d*Ft,Fe+=d*xt,Ie+=d*Lt,Te+=d*Ot,Be+=d*Tt,Pe+=d*Pt,ke+=d*ht,We+=d*Ut,et+=d*jt,d=q[7],gt+=d*Et,Me+=d*yt,Oe+=d*St,$e+=d*It,De+=d*bt,qe+=d*_t,Ae+=d*Dt,Fe+=d*Ft,Ie+=d*xt,Te+=d*Lt,Be+=d*Ot,Pe+=d*Tt,ke+=d*Pt,We+=d*ht,et+=d*Ut,tt+=d*jt,d=q[8],Me+=d*Et,Oe+=d*yt,$e+=d*St,De+=d*It,qe+=d*bt,Ae+=d*_t,Fe+=d*Dt,Ie+=d*Ft,Te+=d*xt,Be+=d*Lt,Pe+=d*Ot,ke+=d*Tt,We+=d*Pt,et+=d*ht,tt+=d*Ut,Je+=d*jt,d=q[9],Oe+=d*Et,$e+=d*yt,De+=d*St,qe+=d*It,Ae+=d*bt,Fe+=d*_t,Ie+=d*Dt,Te+=d*Ft,Be+=d*xt,Pe+=d*Lt,ke+=d*Ot,We+=d*Tt,et+=d*Pt,tt+=d*ht,Je+=d*Ut,Zt+=d*jt,d=q[10],$e+=d*Et,De+=d*yt,qe+=d*St,Ae+=d*It,Fe+=d*bt,Ie+=d*_t,Te+=d*Dt,Be+=d*Ft,Pe+=d*xt,ke+=d*Lt,We+=d*Ot,et+=d*Tt,tt+=d*Pt,Je+=d*ht,Zt+=d*Ut,ur+=d*jt,d=q[11],De+=d*Et,qe+=d*yt,Ae+=d*St,Fe+=d*It,Ie+=d*bt,Te+=d*_t,Be+=d*Dt,Pe+=d*Ft,ke+=d*xt,We+=d*Lt,et+=d*Ot,tt+=d*Tt,Je+=d*Pt,Zt+=d*ht,ur+=d*Ut,Gr+=d*jt,d=q[12],qe+=d*Et,Ae+=d*yt,Fe+=d*St,Ie+=d*It,Te+=d*bt,Be+=d*_t,Pe+=d*Dt,ke+=d*Ft,We+=d*xt,et+=d*Lt,tt+=d*Ot,Je+=d*Tt,Zt+=d*Pt,ur+=d*ht,Gr+=d*Ut,er+=d*jt,d=q[13],Ae+=d*Et,Fe+=d*yt,Ie+=d*St,Te+=d*It,Be+=d*bt,Pe+=d*_t,ke+=d*Dt,We+=d*Ft,et+=d*xt,tt+=d*Lt,Je+=d*Ot,Zt+=d*Tt,ur+=d*Pt,Gr+=d*ht,er+=d*Ut,ri+=d*jt,d=q[14],Fe+=d*Et,Ie+=d*yt,Te+=d*St,Be+=d*It,Pe+=d*bt,ke+=d*_t,We+=d*Dt,et+=d*Ft,tt+=d*xt,Je+=d*Lt,Zt+=d*Ot,ur+=d*Tt,Gr+=d*Pt,er+=d*ht,ri+=d*Ut,wi+=d*jt,d=q[15],Ie+=d*Et,Te+=d*yt,Be+=d*St,Pe+=d*It,ke+=d*bt,We+=d*_t,et+=d*Dt,tt+=d*Ft,Je+=d*xt,Zt+=d*Lt,ur+=d*Ot,Gr+=d*Tt,er+=d*Pt,ri+=d*ht,wi+=d*Ut,Ui+=d*jt,oe+=38*Te,fe+=38*Be,xe+=38*Pe,ze+=38*ke,Ve+=38*We,Ue+=38*et,pt+=38*tt,gt+=38*Je,Me+=38*Zt,Oe+=38*ur,$e+=38*Gr,De+=38*er,qe+=38*ri,Ae+=38*wi,Fe+=38*Ui,R=1,d=oe+R+65535,R=Math.floor(d/65536),oe=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=ze+R+65535,R=Math.floor(d/65536),ze=d-R*65536,d=Ve+R+65535,R=Math.floor(d/65536),Ve=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=pt+R+65535,R=Math.floor(d/65536),pt=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=Me+R+65535,R=Math.floor(d/65536),Me=d-R*65536,d=Oe+R+65535,R=Math.floor(d/65536),Oe=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=De+R+65535,R=Math.floor(d/65536),De=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Ae+R+65535,R=Math.floor(d/65536),Ae=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,oe+=R-1+37*(R-1),R=1,d=oe+R+65535,R=Math.floor(d/65536),oe=d-R*65536,d=fe+R+65535,R=Math.floor(d/65536),fe=d-R*65536,d=xe+R+65535,R=Math.floor(d/65536),xe=d-R*65536,d=ze+R+65535,R=Math.floor(d/65536),ze=d-R*65536,d=Ve+R+65535,R=Math.floor(d/65536),Ve=d-R*65536,d=Ue+R+65535,R=Math.floor(d/65536),Ue=d-R*65536,d=pt+R+65535,R=Math.floor(d/65536),pt=d-R*65536,d=gt+R+65535,R=Math.floor(d/65536),gt=d-R*65536,d=Me+R+65535,R=Math.floor(d/65536),Me=d-R*65536,d=Oe+R+65535,R=Math.floor(d/65536),Oe=d-R*65536,d=$e+R+65535,R=Math.floor(d/65536),$e=d-R*65536,d=De+R+65535,R=Math.floor(d/65536),De=d-R*65536,d=qe+R+65535,R=Math.floor(d/65536),qe=d-R*65536,d=Ae+R+65535,R=Math.floor(d/65536),Ae=d-R*65536,d=Fe+R+65535,R=Math.floor(d/65536),Fe=d-R*65536,d=Ie+R+65535,R=Math.floor(d/65536),Ie=d-R*65536,oe+=R-1+37*(R-1),H[0]=oe,H[1]=fe,H[2]=xe,H[3]=ze,H[4]=Ve,H[5]=Ue,H[6]=pt,H[7]=gt,H[8]=Me,H[9]=Oe,H[10]=$e,H[11]=De,H[12]=qe,H[13]=Ae,H[14]=Fe,H[15]=Ie}function b(H,q){u(H,q,q)}function Y(H,q){const D=o();let d;for(d=0;d<16;d++)D[d]=q[d];for(d=253;d>=0;d--)b(D,D),d!==2&&d!==4&&u(D,D,q);for(d=0;d<16;d++)H[d]=D[d]}function G(H,q){const D=o();let d;for(d=0;d<16;d++)D[d]=q[d];for(d=250;d>=0;d--)b(D,D),d!==1&&u(D,D,q);for(d=0;d<16;d++)H[d]=D[d]}function ne(H,q){const D=o(),d=o(),R=o(),oe=o(),fe=o(),xe=o(),ze=o(),Ve=o(),Ue=o();E(D,H[1],H[0]),E(Ue,q[1],q[0]),u(D,D,Ue),C(d,H[0],H[1]),C(Ue,q[0],q[1]),u(d,d,Ue),u(R,H[3],q[3]),u(R,R,p),u(oe,H[2],q[2]),C(oe,oe,oe),E(fe,d,D),E(xe,oe,R),C(ze,oe,R),C(Ve,d,D),u(H[0],fe,xe),u(H[1],Ve,ze),u(H[2],ze,xe),u(H[3],fe,Ve)}function ce(H,q,D){for(let d=0;d<4;d++)B(H[d],q[d],D)}function de(H,q){const D=o(),d=o(),R=o();Y(R,q[2]),u(D,q[0],R),u(d,q[1],R),k(H,d),H[31]^=M(D)<<7}function m(H,q,D){T(H[0],l),T(H[1],f),T(H[2],f),T(H[3],l);for(let d=255;d>=0;--d){const R=D[d/8|0]>>(d&7)&1;ce(H,q,R),ne(q,H),ne(H,H),ce(H,q,R)}}function O(H,q){const D=[o(),o(),o(),o()];T(D[0],w),T(D[1],P),T(D[2],f),u(D[3],w,P),m(H,D,q)}function ee(H){if(H.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const q=(0,t.hash)(H);q[0]&=248,q[31]&=127,q[31]|=64;const D=new Uint8Array(32),d=[o(),o(),o(),o()];O(d,q),de(D,d);const R=new Uint8Array(64);return R.set(H),R.set(D,32),{publicKey:D,secretKey:R}}i.generateKeyPairFromSeed=ee;function Q(H){const q=(0,e.randomBytes)(32,H),D=ee(q);return(0,s.wipe)(q),D}i.generateKeyPair=Q;function K(H){if(H.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}i.extractPublicKeyFromSecretKey=K;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(H,q){let D,d,R,oe;for(d=63;d>=32;--d){for(D=0,R=d-32,oe=d-12;R<oe;++R)q[R]+=D-16*q[d]*V[R-(d-32)],D=Math.floor((q[R]+128)/256),q[R]-=D*256;q[R]+=D,q[d]=0}for(D=0,R=0;R<32;R++)q[R]+=D-(q[31]>>4)*V[R],D=q[R]>>8,q[R]&=255;for(R=0;R<32;R++)q[R]-=D*V[R];for(d=0;d<32;d++)q[d+1]+=q[d]>>8,H[d]=q[d]&255}function re(H){const q=new Float64Array(64);for(let D=0;D<64;D++)q[D]=H[D];for(let D=0;D<64;D++)H[D]=0;J(H,q)}function be(H,q){const D=new Float64Array(64),d=[o(),o(),o(),o()],R=(0,t.hash)(H.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const oe=new Uint8Array(64);oe.set(R.subarray(32),32);const fe=new t.SHA512;fe.update(oe.subarray(32)),fe.update(q);const xe=fe.digest();fe.clean(),re(xe),O(d,xe),de(oe,d),fe.reset(),fe.update(oe.subarray(0,32)),fe.update(H.subarray(32)),fe.update(q);const ze=fe.digest();re(ze);for(let Ve=0;Ve<32;Ve++)D[Ve]=xe[Ve];for(let Ve=0;Ve<32;Ve++)for(let Ue=0;Ue<32;Ue++)D[Ve+Ue]+=ze[Ve]*R[Ue];return J(oe.subarray(32),D),oe}i.sign=be;function se(H,q){const D=o(),d=o(),R=o(),oe=o(),fe=o(),xe=o(),ze=o();return T(H[2],f),A(H[1],q),b(R,H[1]),u(oe,R,y),E(R,R,H[2]),C(oe,H[2],oe),b(fe,oe),b(xe,fe),u(ze,xe,fe),u(D,ze,R),u(D,D,oe),G(D,D),u(D,D,R),u(D,D,oe),u(D,D,oe),u(H[0],D,oe),b(d,H[0]),u(d,d,oe),F(d,R)&&u(H[0],H[0],I),b(d,H[0]),u(d,d,oe),F(d,R)?-1:(M(H[0])===q[31]>>7&&E(H[0],l,H[0]),u(H[3],H[0],H[1]),0)}function we(H,q,D){const d=new Uint8Array(32),R=[o(),o(),o(),o()],oe=[o(),o(),o(),o()];if(D.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(se(oe,H))return!1;const fe=new t.SHA512;fe.update(D.subarray(0,32)),fe.update(H),fe.update(q);const xe=fe.digest();return re(xe),m(R,oe,xe),O(oe,D.subarray(32)),ne(R,oe),de(d,R),!ae(D,d)}i.verify=we;function le(H){let q=[o(),o(),o(),o()];if(se(q,H))throw new Error("Ed25519: invalid public key");let D=o(),d=o(),R=q[1];C(D,f,R),E(d,f,R),Y(d,d),u(D,D,d);let oe=new Uint8Array(32);return k(oe,D),oe}i.convertPublicKeyToX25519=le;function ve(H){const q=(0,t.hash)(H.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const D=new Uint8Array(q.subarray(0,32));return(0,s.wipe)(q),D}i.convertSecretKeyToX25519=ve})(Lu);const lE="EdDSA",fE="JWT",Jd=".",Qd="base64url",dE="utf8",pE="utf8",gE=":",yE="did",_E="key",Of="base58btc",vE="z",mE="K36",bE=32;function Wo(i){return cr(vr(Is(i),dE),Qd)}function Xd(i){const e=vr(mE,Of),t=vE+cr(tu([e,i]),Of);return[yE,_E,t].join(gE)}function wE(i){return cr(i,Qd)}function EE(i){return vr([Wo(i.header),Wo(i.payload)].join(Jd),pE)}function SE(i){return[Wo(i.header),Wo(i.payload),wE(i.signature)].join(Jd)}function Pf(i=Ln.randomBytes(bE)){return Lu.generateKeyPairFromSeed(i)}async function IE(i,e,t,s,o=_e.fromMiliseconds(Date.now())){const c={alg:lE,typ:fE},l=Xd(s.publicKey),f=o+t,y={iss:l,sub:i,aud:e,iat:o,exp:f},p=EE({header:c,payload:y}),w=Lu.sign(s.secretKey,p);return SE({header:c,payload:y,signature:w})}var Uu={},sa={};Object.defineProperty(sa,"__esModule",{value:!0});var Qt=Le,vu=Or,xE=20;function OE(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],w=t[15]<<24|t[14]<<16|t[13]<<8|t[12],P=t[19]<<24|t[18]<<16|t[17]<<8|t[16],I=t[23]<<24|t[22]<<16|t[21]<<8|t[20],T=t[27]<<24|t[26]<<16|t[25]<<8|t[24],$=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],k=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ae=e[11]<<24|e[10]<<16|e[9]<<8|e[8],F=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,A=o,C=c,E=l,u=f,b=y,Y=p,G=w,ne=P,ce=I,de=T,m=$,O=B,ee=k,Q=ae,K=F,V=0;V<xE;V+=2)M=M+u|0,O^=M,O=O>>>32-16|O<<16,ne=ne+O|0,u^=ne,u=u>>>32-12|u<<12,A=A+b|0,ee^=A,ee=ee>>>32-16|ee<<16,ce=ce+ee|0,b^=ce,b=b>>>32-12|b<<12,C=C+Y|0,Q^=C,Q=Q>>>32-16|Q<<16,de=de+Q|0,Y^=de,Y=Y>>>32-12|Y<<12,E=E+G|0,K^=E,K=K>>>32-16|K<<16,m=m+K|0,G^=m,G=G>>>32-12|G<<12,C=C+Y|0,Q^=C,Q=Q>>>32-8|Q<<8,de=de+Q|0,Y^=de,Y=Y>>>32-7|Y<<7,E=E+G|0,K^=E,K=K>>>32-8|K<<8,m=m+K|0,G^=m,G=G>>>32-7|G<<7,A=A+b|0,ee^=A,ee=ee>>>32-8|ee<<8,ce=ce+ee|0,b^=ce,b=b>>>32-7|b<<7,M=M+u|0,O^=M,O=O>>>32-8|O<<8,ne=ne+O|0,u^=ne,u=u>>>32-7|u<<7,M=M+b|0,K^=M,K=K>>>32-16|K<<16,de=de+K|0,b^=de,b=b>>>32-12|b<<12,A=A+Y|0,O^=A,O=O>>>32-16|O<<16,m=m+O|0,Y^=m,Y=Y>>>32-12|Y<<12,C=C+G|0,ee^=C,ee=ee>>>32-16|ee<<16,ne=ne+ee|0,G^=ne,G=G>>>32-12|G<<12,E=E+u|0,Q^=E,Q=Q>>>32-16|Q<<16,ce=ce+Q|0,u^=ce,u=u>>>32-12|u<<12,C=C+G|0,ee^=C,ee=ee>>>32-8|ee<<8,ne=ne+ee|0,G^=ne,G=G>>>32-7|G<<7,E=E+u|0,Q^=E,Q=Q>>>32-8|Q<<8,ce=ce+Q|0,u^=ce,u=u>>>32-7|u<<7,A=A+Y|0,O^=A,O=O>>>32-8|O<<8,m=m+O|0,Y^=m,Y=Y>>>32-7|Y<<7,M=M+b|0,K^=M,K=K>>>32-8|K<<8,de=de+K|0,b^=de,b=b>>>32-7|b<<7;Qt.writeUint32LE(M+s|0,i,0),Qt.writeUint32LE(A+o|0,i,4),Qt.writeUint32LE(C+c|0,i,8),Qt.writeUint32LE(E+l|0,i,12),Qt.writeUint32LE(u+f|0,i,16),Qt.writeUint32LE(b+y|0,i,20),Qt.writeUint32LE(Y+p|0,i,24),Qt.writeUint32LE(G+w|0,i,28),Qt.writeUint32LE(ne+P|0,i,32),Qt.writeUint32LE(ce+I|0,i,36),Qt.writeUint32LE(de+T|0,i,40),Qt.writeUint32LE(m+$|0,i,44),Qt.writeUint32LE(O+B|0,i,48),Qt.writeUint32LE(ee+k|0,i,52),Qt.writeUint32LE(Q+ae|0,i,56),Qt.writeUint32LE(K+F|0,i,60)}function Zd(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){OE(f,c,i);for(var p=y;p<y+64&&p<t.length;p++)s[p]=t[p]^f[p-y];AE(c,0,l)}return vu.wipe(f),o===0&&vu.wipe(c),s}sa.streamXOR=Zd;function PE(i,e,t,s){return s===void 0&&(s=0),vu.wipe(t),Zd(i,e,t,t,s)}sa.stream=PE;function AE(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var ep={},Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});function TE(i,e,t){return~(i-1)&e|i-1&t}Fi.select=TE;function RE(i,e){return(i|0)-(e|0)-1>>>31&1}Fi.lessOrEqual=RE;function tp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Fi.compare=tp;function CE(i,e){return i.length===0||e.length===0?!1:tp(i,e)!==0}Fi.equal=CE;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Fi,t=Or;i.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var p=f[2]|f[3]<<8;this._r[1]=(y>>>13|p<<3)&8191;var w=f[4]|f[5]<<8;this._r[2]=(p>>>10|w<<6)&7939;var P=f[6]|f[7]<<8;this._r[3]=(w>>>7|P<<9)&8191;var I=f[8]|f[9]<<8;this._r[4]=(P>>>4|I<<12)&255,this._r[5]=I>>>1&8190;var T=f[10]|f[11]<<8;this._r[6]=(I>>>14|T<<2)&8191;var $=f[12]|f[13]<<8;this._r[7]=(T>>>11|$<<5)&8065;var B=f[14]|f[15]<<8;this._r[8]=($>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,y,p){for(var w=this._fin?0:2048,P=this._h[0],I=this._h[1],T=this._h[2],$=this._h[3],B=this._h[4],k=this._h[5],ae=this._h[6],F=this._h[7],M=this._h[8],A=this._h[9],C=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],Y=this._r[4],G=this._r[5],ne=this._r[6],ce=this._r[7],de=this._r[8],m=this._r[9];p>=16;){var O=f[y+0]|f[y+1]<<8;P+=O&8191;var ee=f[y+2]|f[y+3]<<8;I+=(O>>>13|ee<<3)&8191;var Q=f[y+4]|f[y+5]<<8;T+=(ee>>>10|Q<<6)&8191;var K=f[y+6]|f[y+7]<<8;$+=(Q>>>7|K<<9)&8191;var V=f[y+8]|f[y+9]<<8;B+=(K>>>4|V<<12)&8191,k+=V>>>1&8191;var J=f[y+10]|f[y+11]<<8;ae+=(V>>>14|J<<2)&8191;var re=f[y+12]|f[y+13]<<8;F+=(J>>>11|re<<5)&8191;var be=f[y+14]|f[y+15]<<8;M+=(re>>>8|be<<8)&8191,A+=be>>>5|w;var se=0,we=se;we+=P*C,we+=I*(5*m),we+=T*(5*de),we+=$*(5*ce),we+=B*(5*ne),se=we>>>13,we&=8191,we+=k*(5*G),we+=ae*(5*Y),we+=F*(5*b),we+=M*(5*u),we+=A*(5*E),se+=we>>>13,we&=8191;var le=se;le+=P*E,le+=I*C,le+=T*(5*m),le+=$*(5*de),le+=B*(5*ce),se=le>>>13,le&=8191,le+=k*(5*ne),le+=ae*(5*G),le+=F*(5*Y),le+=M*(5*b),le+=A*(5*u),se+=le>>>13,le&=8191;var ve=se;ve+=P*u,ve+=I*E,ve+=T*C,ve+=$*(5*m),ve+=B*(5*de),se=ve>>>13,ve&=8191,ve+=k*(5*ce),ve+=ae*(5*ne),ve+=F*(5*G),ve+=M*(5*Y),ve+=A*(5*b),se+=ve>>>13,ve&=8191;var H=se;H+=P*b,H+=I*u,H+=T*E,H+=$*C,H+=B*(5*m),se=H>>>13,H&=8191,H+=k*(5*de),H+=ae*(5*ce),H+=F*(5*ne),H+=M*(5*G),H+=A*(5*Y),se+=H>>>13,H&=8191;var q=se;q+=P*Y,q+=I*b,q+=T*u,q+=$*E,q+=B*C,se=q>>>13,q&=8191,q+=k*(5*m),q+=ae*(5*de),q+=F*(5*ce),q+=M*(5*ne),q+=A*(5*G),se+=q>>>13,q&=8191;var D=se;D+=P*G,D+=I*Y,D+=T*b,D+=$*u,D+=B*E,se=D>>>13,D&=8191,D+=k*C,D+=ae*(5*m),D+=F*(5*de),D+=M*(5*ce),D+=A*(5*ne),se+=D>>>13,D&=8191;var d=se;d+=P*ne,d+=I*G,d+=T*Y,d+=$*b,d+=B*u,se=d>>>13,d&=8191,d+=k*E,d+=ae*C,d+=F*(5*m),d+=M*(5*de),d+=A*(5*ce),se+=d>>>13,d&=8191;var R=se;R+=P*ce,R+=I*ne,R+=T*G,R+=$*Y,R+=B*b,se=R>>>13,R&=8191,R+=k*u,R+=ae*E,R+=F*C,R+=M*(5*m),R+=A*(5*de),se+=R>>>13,R&=8191;var oe=se;oe+=P*de,oe+=I*ce,oe+=T*ne,oe+=$*G,oe+=B*Y,se=oe>>>13,oe&=8191,oe+=k*b,oe+=ae*u,oe+=F*E,oe+=M*C,oe+=A*(5*m),se+=oe>>>13,oe&=8191;var fe=se;fe+=P*m,fe+=I*de,fe+=T*ce,fe+=$*ne,fe+=B*G,se=fe>>>13,fe&=8191,fe+=k*Y,fe+=ae*b,fe+=F*u,fe+=M*E,fe+=A*C,se+=fe>>>13,fe&=8191,se=(se<<2)+se|0,se=se+we|0,we=se&8191,se=se>>>13,le+=se,P=we,I=le,T=ve,$=H,B=q,k=D,ae=d,F=R,M=oe,A=fe,y+=16,p-=16}this._h[0]=P,this._h[1]=I,this._h[2]=T,this._h[3]=$,this._h[4]=B,this._h[5]=k,this._h[6]=ae,this._h[7]=F,this._h[8]=M,this._h[9]=A},l.prototype.finish=function(f,y){y===void 0&&(y=0);var p=new Uint16Array(10),w,P,I,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=w,w=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,p[0]=this._h[0]+5,w=p[0]>>>13,p[0]&=8191,T=1;T<10;T++)p[T]=this._h[T]+w,w=p[T]>>>13,p[T]&=8191;for(p[9]-=8192,P=(w^1)-1,T=0;T<10;T++)p[T]&=P;for(P=~P,T=0;T<10;T++)this._h[T]=this._h[T]&P|p[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,I=this._h[0]+this._pad[0],this._h[0]=I&65535,T=1;T<8;T++)I=(this._h[T]+this._pad[T]|0)+(I>>>16)|0,this._h[T]=I&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var y=0,p=f.length,w;if(this._leftover){w=16-this._leftover,w>p&&(w=p);for(var P=0;P<w;P++)this._buffer[this._leftover+P]=f[y+P];if(p-=w,y+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(w=p-p%16,this._blocks(f,y,w),y+=w,p-=w),p){for(var P=0;P<p;P++)this._buffer[this._leftover+P]=f[y+P];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,f){var y=new s(l);y.update(f);var p=y.digest();return y.clean(),p}i.oneTimeAuth=o;function c(l,f){return l.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(l,f)}i.equal=c})(ep);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=sa,t=ep,s=Or,o=Le,c=Fi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function y(p){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,p.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return y.prototype.seal=function(p,w,P,I){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(p,T.length-p.length);var $=new Uint8Array(32);e.stream(this._key,T,$,4);var B=w.length+this.tagLength,k;if(I){if(I.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");k=I}else k=new Uint8Array(B);return e.streamXOR(this._key,T,w,k,4),this._authenticate(k.subarray(k.length-this.tagLength,k.length),$,k.subarray(0,k.length-this.tagLength),P),s.wipe(T),k},y.prototype.open=function(p,w,P,I){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(p,T.length-p.length);var $=new Uint8Array(32);e.stream(this._key,T,$,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,$,w.subarray(0,w.length-this.tagLength),P),!c.equal(B,w.subarray(w.length-this.tagLength,w.length)))return null;var k=w.length-this.tagLength,ae;if(I){if(I.length!==k)throw new Error("ChaCha20Poly1305: incorrect destination length");ae=I}else ae=new Uint8Array(k);return e.streamXOR(this._key,T,w.subarray(0,w.length-this.tagLength),ae,4),s.wipe(T),ae},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(p,w,P,I){var T=new t.Poly1305(w);I&&(T.update(I),I.length%16>0&&T.update(l.subarray(I.length%16))),T.update(P),P.length%16>0&&T.update(l.subarray(P.length%16));var $=new Uint8Array(8);I&&o.writeUint64LE(I.length,$),T.update($),o.writeUint64LE(P.length,$),T.update($);for(var B=T.digest(),k=0;k<B.length;k++)p[k]=B[k];T.clean(),s.wipe(B),s.wipe($)},y}();i.ChaCha20Poly1305=f})(Uu);var rp={},Ts={},ju={};Object.defineProperty(ju,"__esModule",{value:!0});function NE(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}ju.isSerializableHash=NE;Object.defineProperty(Ts,"__esModule",{value:!0});var Zr=ju,$E=Fi,DE=Or,ip=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Zr.isSerializableHash(this._inner)&&Zr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),DE.wipe(s)}return i.prototype.reset=function(){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Zr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Ts.HMAC=ip;function FE(i,e,t){var s=new ip(i,e);s.update(t);var o=s.digest();return s.clean(),o}Ts.hmac=FE;Ts.equal=$E.equal;Object.defineProperty(rp,"__esModule",{value:!0});var Af=Ts,Tf=Or,LE=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Af.hmac(this._hash,s,t);this._hmac=new Af.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),Tf.wipe(this._buffer),Tf.wipe(this._counter),this._bufpos=0},i}(),UE=rp.HKDF=LE,oa={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Or;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,p){if(p===void 0&&(p=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=y[w++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=c(this._temp,this._state,y,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=y[w++],p--;return this},f.prototype.finish=function(y){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,P=p/536870912|0,I=p<<3,T=p%64<56?64:128;this._buffer[w]=128;for(var $=w+1;$<T-8;$++)this._buffer[$]=0;e.writeUint32BE(P,this._buffer,T-8),e.writeUint32BE(I,this._buffer,T-4),c(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var $=0;$<this.digestLength/4;$++)e.writeUint32BE(this._state[$],y,$*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,p,w,P){for(;P>=64;){for(var I=y[0],T=y[1],$=y[2],B=y[3],k=y[4],ae=y[5],F=y[6],M=y[7],A=0;A<16;A++){var C=w+A*4;f[A]=e.readUint32BE(p,C)}for(var A=16;A<64;A++){var E=f[A-2],u=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=f[A-15];var b=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;f[A]=(u+f[A-7]|0)+(b+f[A-16]|0)}for(var A=0;A<64;A++){var u=(((k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7))+(k&ae^~k&F)|0)+(M+(o[A]+f[A]|0)|0)|0,b=((I>>>2|I<<32-2)^(I>>>13|I<<32-13)^(I>>>22|I<<32-22))+(I&T^I&$^T&$)|0;M=F,F=ae,ae=k,k=B+u|0,B=$,$=T,T=I,I=u+b|0}y[0]+=I,y[1]+=T,y[2]+=$,y[3]+=B,y[4]+=k,y[5]+=ae,y[6]+=F,y[7]+=M,w+=64,P-=64}return w}function l(f){var y=new s;y.update(f);var p=y.digest();return y.clean(),p}i.hash=l})(oa);var Mu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=Ln,t=Or;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(A){const C=new Float64Array(16);if(A)for(let E=0;E<A.length;E++)C[E]=A[E];return C}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(A){let C=1;for(let E=0;E<16;E++){let u=A[E]+C+65535;C=Math.floor(u/65536),A[E]=u-C*65536}A[0]+=C-1+37*(C-1)}function f(A,C,E){const u=~(E-1);for(let b=0;b<16;b++){const Y=u&(A[b]^C[b]);A[b]^=Y,C[b]^=Y}}function y(A,C){const E=s(),u=s();for(let b=0;b<16;b++)u[b]=C[b];l(u),l(u),l(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let G=1;G<15;G++)E[G]=u[G]-65535-(E[G-1]>>16&1),E[G-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const Y=E[15]>>16&1;E[14]&=65535,f(u,E,1-Y)}for(let b=0;b<16;b++)A[2*b]=u[b]&255,A[2*b+1]=u[b]>>8}function p(A,C){for(let E=0;E<16;E++)A[E]=C[2*E]+(C[2*E+1]<<8);A[15]&=32767}function w(A,C,E){for(let u=0;u<16;u++)A[u]=C[u]+E[u]}function P(A,C,E){for(let u=0;u<16;u++)A[u]=C[u]-E[u]}function I(A,C,E){let u,b,Y=0,G=0,ne=0,ce=0,de=0,m=0,O=0,ee=0,Q=0,K=0,V=0,J=0,re=0,be=0,se=0,we=0,le=0,ve=0,H=0,q=0,D=0,d=0,R=0,oe=0,fe=0,xe=0,ze=0,Ve=0,Ue=0,pt=0,gt=0,Me=E[0],Oe=E[1],$e=E[2],De=E[3],qe=E[4],Ae=E[5],Fe=E[6],Ie=E[7],Te=E[8],Be=E[9],Pe=E[10],ke=E[11],We=E[12],et=E[13],tt=E[14],Je=E[15];u=C[0],Y+=u*Me,G+=u*Oe,ne+=u*$e,ce+=u*De,de+=u*qe,m+=u*Ae,O+=u*Fe,ee+=u*Ie,Q+=u*Te,K+=u*Be,V+=u*Pe,J+=u*ke,re+=u*We,be+=u*et,se+=u*tt,we+=u*Je,u=C[1],G+=u*Me,ne+=u*Oe,ce+=u*$e,de+=u*De,m+=u*qe,O+=u*Ae,ee+=u*Fe,Q+=u*Ie,K+=u*Te,V+=u*Be,J+=u*Pe,re+=u*ke,be+=u*We,se+=u*et,we+=u*tt,le+=u*Je,u=C[2],ne+=u*Me,ce+=u*Oe,de+=u*$e,m+=u*De,O+=u*qe,ee+=u*Ae,Q+=u*Fe,K+=u*Ie,V+=u*Te,J+=u*Be,re+=u*Pe,be+=u*ke,se+=u*We,we+=u*et,le+=u*tt,ve+=u*Je,u=C[3],ce+=u*Me,de+=u*Oe,m+=u*$e,O+=u*De,ee+=u*qe,Q+=u*Ae,K+=u*Fe,V+=u*Ie,J+=u*Te,re+=u*Be,be+=u*Pe,se+=u*ke,we+=u*We,le+=u*et,ve+=u*tt,H+=u*Je,u=C[4],de+=u*Me,m+=u*Oe,O+=u*$e,ee+=u*De,Q+=u*qe,K+=u*Ae,V+=u*Fe,J+=u*Ie,re+=u*Te,be+=u*Be,se+=u*Pe,we+=u*ke,le+=u*We,ve+=u*et,H+=u*tt,q+=u*Je,u=C[5],m+=u*Me,O+=u*Oe,ee+=u*$e,Q+=u*De,K+=u*qe,V+=u*Ae,J+=u*Fe,re+=u*Ie,be+=u*Te,se+=u*Be,we+=u*Pe,le+=u*ke,ve+=u*We,H+=u*et,q+=u*tt,D+=u*Je,u=C[6],O+=u*Me,ee+=u*Oe,Q+=u*$e,K+=u*De,V+=u*qe,J+=u*Ae,re+=u*Fe,be+=u*Ie,se+=u*Te,we+=u*Be,le+=u*Pe,ve+=u*ke,H+=u*We,q+=u*et,D+=u*tt,d+=u*Je,u=C[7],ee+=u*Me,Q+=u*Oe,K+=u*$e,V+=u*De,J+=u*qe,re+=u*Ae,be+=u*Fe,se+=u*Ie,we+=u*Te,le+=u*Be,ve+=u*Pe,H+=u*ke,q+=u*We,D+=u*et,d+=u*tt,R+=u*Je,u=C[8],Q+=u*Me,K+=u*Oe,V+=u*$e,J+=u*De,re+=u*qe,be+=u*Ae,se+=u*Fe,we+=u*Ie,le+=u*Te,ve+=u*Be,H+=u*Pe,q+=u*ke,D+=u*We,d+=u*et,R+=u*tt,oe+=u*Je,u=C[9],K+=u*Me,V+=u*Oe,J+=u*$e,re+=u*De,be+=u*qe,se+=u*Ae,we+=u*Fe,le+=u*Ie,ve+=u*Te,H+=u*Be,q+=u*Pe,D+=u*ke,d+=u*We,R+=u*et,oe+=u*tt,fe+=u*Je,u=C[10],V+=u*Me,J+=u*Oe,re+=u*$e,be+=u*De,se+=u*qe,we+=u*Ae,le+=u*Fe,ve+=u*Ie,H+=u*Te,q+=u*Be,D+=u*Pe,d+=u*ke,R+=u*We,oe+=u*et,fe+=u*tt,xe+=u*Je,u=C[11],J+=u*Me,re+=u*Oe,be+=u*$e,se+=u*De,we+=u*qe,le+=u*Ae,ve+=u*Fe,H+=u*Ie,q+=u*Te,D+=u*Be,d+=u*Pe,R+=u*ke,oe+=u*We,fe+=u*et,xe+=u*tt,ze+=u*Je,u=C[12],re+=u*Me,be+=u*Oe,se+=u*$e,we+=u*De,le+=u*qe,ve+=u*Ae,H+=u*Fe,q+=u*Ie,D+=u*Te,d+=u*Be,R+=u*Pe,oe+=u*ke,fe+=u*We,xe+=u*et,ze+=u*tt,Ve+=u*Je,u=C[13],be+=u*Me,se+=u*Oe,we+=u*$e,le+=u*De,ve+=u*qe,H+=u*Ae,q+=u*Fe,D+=u*Ie,d+=u*Te,R+=u*Be,oe+=u*Pe,fe+=u*ke,xe+=u*We,ze+=u*et,Ve+=u*tt,Ue+=u*Je,u=C[14],se+=u*Me,we+=u*Oe,le+=u*$e,ve+=u*De,H+=u*qe,q+=u*Ae,D+=u*Fe,d+=u*Ie,R+=u*Te,oe+=u*Be,fe+=u*Pe,xe+=u*ke,ze+=u*We,Ve+=u*et,Ue+=u*tt,pt+=u*Je,u=C[15],we+=u*Me,le+=u*Oe,ve+=u*$e,H+=u*De,q+=u*qe,D+=u*Ae,d+=u*Fe,R+=u*Ie,oe+=u*Te,fe+=u*Be,xe+=u*Pe,ze+=u*ke,Ve+=u*We,Ue+=u*et,pt+=u*tt,gt+=u*Je,Y+=38*le,G+=38*ve,ne+=38*H,ce+=38*q,de+=38*D,m+=38*d,O+=38*R,ee+=38*oe,Q+=38*fe,K+=38*xe,V+=38*ze,J+=38*Ve,re+=38*Ue,be+=38*pt,se+=38*gt,b=1,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=m+b+65535,b=Math.floor(u/65536),m=u-b*65536,u=O+b+65535,b=Math.floor(u/65536),O=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,Y+=b-1+37*(b-1),b=1,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=m+b+65535,b=Math.floor(u/65536),m=u-b*65536,u=O+b+65535,b=Math.floor(u/65536),O=u-b*65536,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=Q+b+65535,b=Math.floor(u/65536),Q=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=V+b+65535,b=Math.floor(u/65536),V=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=be+b+65535,b=Math.floor(u/65536),be=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,Y+=b-1+37*(b-1),A[0]=Y,A[1]=G,A[2]=ne,A[3]=ce,A[4]=de,A[5]=m,A[6]=O,A[7]=ee,A[8]=Q,A[9]=K,A[10]=V,A[11]=J,A[12]=re,A[13]=be,A[14]=se,A[15]=we}function T(A,C){I(A,C,C)}function $(A,C){const E=s();for(let u=0;u<16;u++)E[u]=C[u];for(let u=253;u>=0;u--)T(E,E),u!==2&&u!==4&&I(E,E,C);for(let u=0;u<16;u++)A[u]=E[u]}function B(A,C){const E=new Uint8Array(32),u=new Float64Array(80),b=s(),Y=s(),G=s(),ne=s(),ce=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=A[Q];E[31]=A[31]&127|64,E[0]&=248,p(u,C);for(let Q=0;Q<16;Q++)Y[Q]=u[Q];b[0]=ne[0]=1;for(let Q=254;Q>=0;--Q){const K=E[Q>>>3]>>>(Q&7)&1;f(b,Y,K),f(G,ne,K),w(ce,b,G),P(b,b,G),w(G,Y,ne),P(Y,Y,ne),T(ne,ce),T(de,b),I(b,G,b),I(G,Y,ce),w(ce,b,G),P(b,b,G),T(Y,b),P(G,ne,de),I(b,G,c),w(b,b,ne),I(G,G,b),I(b,ne,de),I(ne,Y,u),T(Y,ce),f(b,Y,K),f(G,ne,K)}for(let Q=0;Q<16;Q++)u[Q+16]=b[Q],u[Q+32]=G[Q],u[Q+48]=Y[Q],u[Q+64]=ne[Q];const m=u.subarray(32),O=u.subarray(16);$(m,m),I(O,O,m);const ee=new Uint8Array(32);return y(ee,O),ee}i.scalarMult=B;function k(A){return B(A,o)}i.scalarMultBase=k;function ae(A){if(A.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(A);return{publicKey:k(C),secretKey:C}}i.generateKeyPairFromSeed=ae;function F(A){const C=(0,e.randomBytes)(32,A),E=ae(C);return(0,t.wipe)(C),E}i.generateKeyPair=F;function M(A,C,E=!1){if(A.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=B(A,C);if(E){let b=0;for(let Y=0;Y<u.length;Y++)b|=u[Y];if(b===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=M})(Mu);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=sp=lt.getLocation=lt.getLocationOrThrow=qu=lt.getNavigator=lt.getNavigatorOrThrow=np=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function nn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}lt.getFromWindow=nn;function Un(i){const e=nn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}lt.getFromWindowOrThrow=Un;function jE(){return Un("document")}lt.getDocumentOrThrow=jE;function ME(){return nn("document")}var np=lt.getDocument=ME;function qE(){return Un("navigator")}lt.getNavigatorOrThrow=qE;function HE(){return nn("navigator")}var qu=lt.getNavigator=HE;function zE(){return Un("location")}lt.getLocationOrThrow=zE;function BE(){return nn("location")}var sp=lt.getLocation=BE;function KE(){return Un("crypto")}lt.getCryptoOrThrow=KE;function VE(){return nn("crypto")}lt.getCrypto=VE;function kE(){return Un("localStorage")}lt.getLocalStorageOrThrow=kE;function GE(){return nn("localStorage")}lt.getLocalStorage=GE;var Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});var op=Hu.getWindowMetadata=void 0;const Rf=lt;function WE(){let i,e;try{i=Rf.getDocumentOrThrow(),e=Rf.getLocationOrThrow()}catch{return null}function t(){const P=i.getElementsByTagName("link"),I=[];for(let T=0;T<P.length;T++){const $=P[T],B=$.getAttribute("rel");if(B&&B.toLowerCase().indexOf("icon")>-1){const k=$.getAttribute("href");if(k)if(k.toLowerCase().indexOf("https:")===-1&&k.toLowerCase().indexOf("http:")===-1&&k.indexOf("//")!==0){let ae=e.protocol+"//"+e.host;if(k.indexOf("/")===0)ae+=k;else{const F=e.pathname.split("/");F.pop();const M=F.join("/");ae+=M+"/"+k}I.push(ae)}else if(k.indexOf("//")===0){const ae=e.protocol+k;I.push(ae)}else I.push(k)}}return I}function s(...P){const I=i.getElementsByTagName("meta");for(let T=0;T<I.length;T++){const $=I[T],B=["itemprop","property","name"].map(k=>$.getAttribute(k)).filter(k=>k?P.includes(k):!1);if(B.length&&B){const k=$.getAttribute("content");if(k)return k}}return""}function o(){let P=s("name","og:site_name","og:title","twitter:title");return P||(P=i.title),P}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),y=e.origin,p=t();return{description:f,url:y,icons:p,name:l}}op=Hu.getWindowMetadata=WE;var xs={},YE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ap="%[a-f0-9]{2}",Cf=new RegExp("("+ap+")|([^%]+?)","gi"),Nf=new RegExp("("+ap+")+","gi");function mu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],mu(t),mu(s))}function JE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Cf)||[],t=1;t<e.length;t++)i=mu(e,t).join(""),e=i.match(Cf)||[];return i}}function QE(i){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Nf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=JE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Nf.exec(i)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var XE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return QE(i)}},ZE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},e6=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=i[l];(o?e.indexOf(l)!==-1:e(l,f,i))&&(t[l]=f)}return t};(function(i){const e=YE,t=XE,s=ZE,o=e6,c=F=>F==null,l=Symbol("encodeFragmentIdentifier");function f(F){switch(F.arrayFormat){case"index":return M=>(A,C)=>{const E=A.length;return C===void 0||F.skipNull&&C===null||F.skipEmptyString&&C===""?A:C===null?[...A,[w(M,F),"[",E,"]"].join("")]:[...A,[w(M,F),"[",w(E,F),"]=",w(C,F)].join("")]};case"bracket":return M=>(A,C)=>C===void 0||F.skipNull&&C===null||F.skipEmptyString&&C===""?A:C===null?[...A,[w(M,F),"[]"].join("")]:[...A,[w(M,F),"[]=",w(C,F)].join("")];case"colon-list-separator":return M=>(A,C)=>C===void 0||F.skipNull&&C===null||F.skipEmptyString&&C===""?A:C===null?[...A,[w(M,F),":list="].join("")]:[...A,[w(M,F),":list=",w(C,F)].join("")];case"comma":case"separator":case"bracket-separator":{const M=F.arrayFormat==="bracket-separator"?"[]=":"=";return A=>(C,E)=>E===void 0||F.skipNull&&E===null||F.skipEmptyString&&E===""?C:(E=E===null?"":E,C.length===0?[[w(A,F),M,w(E,F)].join("")]:[[C,w(E,F)].join(F.arrayFormatSeparator)])}default:return M=>(A,C)=>C===void 0||F.skipNull&&C===null||F.skipEmptyString&&C===""?A:C===null?[...A,w(M,F)]:[...A,[w(M,F),"=",w(C,F)].join("")]}}function y(F){let M;switch(F.arrayFormat){case"index":return(A,C,E)=>{if(M=/\[(\d*)\]$/.exec(A),A=A.replace(/\[\d*\]$/,""),!M){E[A]=C;return}E[A]===void 0&&(E[A]={}),E[A][M[1]]=C};case"bracket":return(A,C,E)=>{if(M=/(\[\])$/.exec(A),A=A.replace(/\[\]$/,""),!M){E[A]=C;return}if(E[A]===void 0){E[A]=[C];return}E[A]=[].concat(E[A],C)};case"colon-list-separator":return(A,C,E)=>{if(M=/(:list)$/.exec(A),A=A.replace(/:list$/,""),!M){E[A]=C;return}if(E[A]===void 0){E[A]=[C];return}E[A]=[].concat(E[A],C)};case"comma":case"separator":return(A,C,E)=>{const u=typeof C=="string"&&C.includes(F.arrayFormatSeparator),b=typeof C=="string"&&!u&&P(C,F).includes(F.arrayFormatSeparator);C=b?P(C,F):C;const Y=u||b?C.split(F.arrayFormatSeparator).map(G=>P(G,F)):C===null?C:P(C,F);E[A]=Y};case"bracket-separator":return(A,C,E)=>{const u=/(\[\])$/.test(A);if(A=A.replace(/\[\]$/,""),!u){E[A]=C&&P(C,F);return}const b=C===null?[]:C.split(F.arrayFormatSeparator).map(Y=>P(Y,F));if(E[A]===void 0){E[A]=b;return}E[A]=[].concat(E[A],b)};default:return(A,C,E)=>{if(E[A]===void 0){E[A]=C;return}E[A]=[].concat(E[A],C)}}}function p(F){if(typeof F!="string"||F.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(F,M){return M.encode?M.strict?e(F):encodeURIComponent(F):F}function P(F,M){return M.decode?t(F):F}function I(F){return Array.isArray(F)?F.sort():typeof F=="object"?I(Object.keys(F)).sort((M,A)=>Number(M)-Number(A)).map(M=>F[M]):F}function T(F){const M=F.indexOf("#");return M!==-1&&(F=F.slice(0,M)),F}function $(F){let M="";const A=F.indexOf("#");return A!==-1&&(M=F.slice(A)),M}function B(F){F=T(F);const M=F.indexOf("?");return M===-1?"":F.slice(M+1)}function k(F,M){return M.parseNumbers&&!Number.isNaN(Number(F))&&typeof F=="string"&&F.trim()!==""?F=Number(F):M.parseBooleans&&F!==null&&(F.toLowerCase()==="true"||F.toLowerCase()==="false")&&(F=F.toLowerCase()==="true"),F}function ae(F,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),p(M.arrayFormatSeparator);const A=y(M),C=Object.create(null);if(typeof F!="string"||(F=F.trim().replace(/^[?#&]/,""),!F))return C;for(const E of F.split("&")){if(E==="")continue;let[u,b]=s(M.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?b:P(b,M),A(P(u,M),b,C)}for(const E of Object.keys(C)){const u=C[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=k(u[b],M);else C[E]=k(u,M)}return M.sort===!1?C:(M.sort===!0?Object.keys(C).sort():Object.keys(C).sort(M.sort)).reduce((E,u)=>{const b=C[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=I(b):E[u]=b,E},Object.create(null))}i.extract=B,i.parse=ae,i.stringify=(F,M)=>{if(!F)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),p(M.arrayFormatSeparator);const A=b=>M.skipNull&&c(F[b])||M.skipEmptyString&&F[b]==="",C=f(M),E={};for(const b of Object.keys(F))A(b)||(E[b]=F[b]);const u=Object.keys(E);return M.sort!==!1&&u.sort(M.sort),u.map(b=>{const Y=F[b];return Y===void 0?"":Y===null?w(b,M):Array.isArray(Y)?Y.length===0&&M.arrayFormat==="bracket-separator"?w(b,M)+"[]":Y.reduce(C(b),[]).join("&"):w(b,M)+"="+w(Y,M)}).filter(b=>b.length>0).join("&")},i.parseUrl=(F,M)=>{M=Object.assign({decode:!0},M);const[A,C]=s(F,"#");return Object.assign({url:A.split("?")[0]||"",query:ae(B(F),M)},M&&M.parseFragmentIdentifier&&C?{fragmentIdentifier:P(C,M)}:{})},i.stringifyUrl=(F,M)=>{M=Object.assign({encode:!0,strict:!0,[l]:!0},M);const A=T(F.url).split("?")[0]||"",C=i.extract(F.url),E=i.parse(C,{sort:!1}),u=Object.assign(E,F.query);let b=i.stringify(u,M);b&&(b=`?${b}`);let Y=$(F.url);return F.fragmentIdentifier&&(Y=`#${M[l]?w(F.fragmentIdentifier,M):F.fragmentIdentifier}`),`${A}${b}${Y}`},i.pick=(F,M,A)=>{A=Object.assign({parseFragmentIdentifier:!0,[l]:!1},A);const{url:C,query:E,fragmentIdentifier:u}=i.parseUrl(F,A);return i.stringifyUrl({url:C,query:o(E,M),fragmentIdentifier:u},A)},i.exclude=(F,M,A)=>{const C=Array.isArray(M)?E=>!M.includes(E):(E,u)=>!M(E,u);return i.pick(F,C,A)}})(xs);const t6={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},r6=":";function i6(i){const[e,t]=i.split(r6);return{namespace:e,reference:t}}function n6(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function cp(i,e){return i.includes(":")?[i]:e.chains||[]}const up="base10",ar="base16",bu="base64pad",zu="utf8",hp=0,sn=1,s6=0,$f=1,wu=12,Bu=32;function o6(){const i=Mu.generateKeyPair();return{privateKey:cr(i.secretKey,ar),publicKey:cr(i.publicKey,ar)}}function Eu(){const i=Ln.randomBytes(Bu);return cr(i,ar)}function a6(i,e){const t=Mu.sharedKey(vr(i,ar),vr(e,ar),!0),s=new UE(oa.SHA256,t).expand(Bu);return cr(s,ar)}function c6(i){const e=oa.hash(vr(i,ar));return cr(e,ar)}function Cn(i){const e=oa.hash(vr(i,zu));return cr(e,ar)}function u6(i){return vr(`${i}`,up)}function Rs(i){return Number(cr(i,up))}function h6(i){const e=u6(typeof i.type<"u"?i.type:hp);if(Rs(e)===sn&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?vr(i.senderPublicKey,ar):void 0,s=typeof i.iv<"u"?vr(i.iv,ar):Ln.randomBytes(wu),o=new Uu.ChaCha20Poly1305(vr(i.symKey,ar)).seal(s,vr(i.message,zu));return f6({type:e,sealed:o,iv:s,senderPublicKey:t})}function l6(i){const e=new Uu.ChaCha20Poly1305(vr(i.symKey,ar)),{sealed:t,iv:s}=Yo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return cr(o,zu)}function f6(i){if(Rs(i.type)===sn){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(tu([i.type,i.senderPublicKey,i.iv,i.sealed]),bu)}return cr(tu([i.type,i.iv,i.sealed]),bu)}function Yo(i){const e=vr(i,bu),t=e.slice(s6,$f),s=$f;if(Rs(t)===sn){const f=s+Bu,y=f+wu,p=e.slice(s,f),w=e.slice(f,y),P=e.slice(y);return{type:t,sealed:P,iv:w,senderPublicKey:p}}const o=s+wu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function d6(i,e){const t=Yo(i);return lp({type:Rs(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?cr(t.senderPublicKey,ar):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function lp(i){const e=(i==null?void 0:i.type)||hp;if(e===sn){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Df(i){return i.type===sn&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var p6=Object.defineProperty,Ff=Object.getOwnPropertySymbols,g6=Object.prototype.hasOwnProperty,y6=Object.prototype.propertyIsEnumerable,Lf=(i,e,t)=>e in i?p6(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Uf=(i,e)=>{for(var t in e||(e={}))g6.call(e,t)&&Lf(i,t,e[t]);if(Ff)for(var t of Ff(e))y6.call(e,t)&&Lf(i,t,e[t]);return i};const _6="ReactNative",xr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},v6="js";function Ku(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Cs(){return!np()&&!!qu()&&navigator.product===_6}function Ns(){return!Ku()&&!!qu()}function $s(){return Cs()?xr.reactNative:Ku()?xr.node:Ns()?xr.browser:xr.unknown}function m6(i,e){let t=xs.parse(i);return t=Uf(Uf({},t),e),i=xs.stringify(t),i}function b6(){return op()||{name:"",description:"",url:"",icons:[""]}}function w6(){if($s()===xr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=Om();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function E6(){var i;const e=$s();return e===xr.browser?[e,((i=sp())==null?void 0:i.host)||"unknown"].join(":"):e}function S6(i,e,t){const s=w6(),o=E6();return[[i,e].join("-"),[v6,t].join("-"),s,o].join("/")}function I6({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l}){const f=t.split("?"),y=S6(i,e,s),p={auth:o,ua:y,projectId:c,useOnCloseEvent:l||void 0},w=m6(f[1]||"",p);return f[0]+"?"+w}function tn(i,e){return i.filter(t=>e.includes(t)).length===i.length}function fp(i){return Object.fromEntries(i.entries())}function dp(i){return new Map(Object.entries(i))}function Tn(i=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(i||_e.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function Os(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function pp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function x6(i){return pp("topic",i)}function O6(i){return pp("id",i)}function gp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Vr(i,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(i))}function Ni(i){return Date.now()>=_e.toMiliseconds(i)}function Ht(i,e){return`${i}${e?`:${e}`:""}`}function Kc(i=[],e=[]){return[...new Set([...i,...e])]}async function P6({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=$s();l===xr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===xr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const A6="irn";function Su(i){return(i==null?void 0:i.relay)||{protocol:A6}}function Ko(i){const e=t6[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var T6=Object.defineProperty,jf=Object.getOwnPropertySymbols,R6=Object.prototype.hasOwnProperty,C6=Object.prototype.propertyIsEnumerable,Mf=(i,e,t)=>e in i?T6(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,N6=(i,e)=>{for(var t in e||(e={}))R6.call(e,t)&&Mf(i,t,e[t]);if(jf)for(var t of jf(e))C6.call(e,t)&&Mf(i,t,e[t]);return i};function $6(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function D6(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=xs.parse(c);return{protocol:s,topic:F6(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:$6(l)}}function F6(i){return i.startsWith("//")?i.substring(2):i}function L6(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function U6(i){return`${i.protocol}:${i.topic}@${i.version}?`+xs.stringify(N6({symKey:i.symKey},L6(i.relay)))}function jn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function j6(i){const e=[];return Object.values(i).forEach(t=>{e.push(...jn(t.accounts))}),e}function M6(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function q6(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.events)}),t}function H6(i,e){const t=Vo(i,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(i))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}function Vu(i){return i.includes(":")}function ys(i){return Vu(i)?i.split(":")[0]:i}const z6={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},B6={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function he(i,e){const{message:t,code:s}=B6[i];return{message:e?`${t} ${e}`:t,code:s}}function $t(i,e){const{message:t,code:s}=z6[i];return{message:e?`${t} ${e}`:t,code:s}}function ti(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Nn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function or(i){return typeof i>"u"}function kt(i,e){return e&&or(i)?!0:typeof i=="string"&&!!i.trim().length}function ku(i,e){return e&&or(i)?!0:typeof i=="number"&&!isNaN(i)}function K6(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return tn(o,s)?(s.forEach(l=>{const{accounts:f,methods:y,events:p}=i.namespaces[l],w=jn(f),P=t[l];(!tn(cp(l,P),w)||!tn(P.methods,y)||!tn(P.events,p))&&(c=!1)}),c):!1}function Jo(i){return kt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function V6(i){if(kt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Jo(t)}}return!1}function k6(i){if(kt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function G6(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function W6(i){return i==null?void 0:i.topic}function Y6(i,e){let t=null;return kt(i==null?void 0:i.publicKey,!1)||(t=he("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function qf(i){let e=!0;return ti(i)?i.length&&(e=i.every(t=>kt(t,!1))):e=!1,e}function J6(i,e,t){let s=null;return ti(e)&&e.length?e.forEach(o=>{s||Jo(o)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Jo(i)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Q6(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=J6(o,cp(o,c),`${e} ${t}`);l&&(s=l)}),s}function X6(i,e){let t=null;return ti(i)?i.forEach(s=>{t||V6(s)||(t=$t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=$t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Z6(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=X6(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function eS(i,e){let t=null;return qf(i==null?void 0:i.methods)?qf(i==null?void 0:i.events)||(t=$t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=$t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function yp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=eS(s,`${e}, namespace`);o&&(t=o)}),t}function tS(i,e,t){let s=null;if(i&&Nn(i)){const o=yp(i,e);o&&(s=o);const c=Q6(i,e,t);c&&(s=c)}else s=he("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Vo(i,e){let t=null;if(i&&Nn(i)){const s=yp(i,e);s&&(t=s);const o=Z6(i,e);o&&(t=o)}else t=he("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function _p(i){return kt(i.protocol,!0)}function rS(i,e){let t=!1;return e&&!i?t=!0:i&&ti(i)&&i.length&&i.forEach(s=>{t=_p(s)}),t}function iS(i){return typeof i=="number"}function yr(i){return typeof i<"u"&&typeof i!==null}function nS(i){return!(!i||typeof i!="object"||!i.code||!ku(i.code,!1)||!i.message||!kt(i.message,!1))}function sS(i){return!(or(i)||!kt(i.method,!1))}function oS(i){return!(or(i)||or(i.result)&&or(i.error)||!ku(i.id,!1)||!kt(i.jsonrpc,!1))}function aS(i){return!(or(i)||!kt(i.name,!1))}function Hf(i,e){return!(!Jo(e)||!j6(i).includes(e))}function cS(i,e,t){return kt(t,!1)?M6(i,e).includes(t):!1}function uS(i,e,t){return kt(t,!1)?q6(i,e).includes(t):!1}function zf(i,e,t){let s=null;const o=hS(i),c=lS(e),l=Object.keys(o),f=Object.keys(c),y=Bf(Object.keys(i)),p=Bf(Object.keys(e)),w=y.filter(P=>!p.includes(P));return w.length&&(s=he("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(e).toString()}`)),tn(l,f)||(s=he("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(P=>{if(!P.includes(":")||s)return;const I=jn(e[P].accounts);I.includes(P)||(s=he("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${P}
        Required: ${P}
        Approved: ${I.toString()}`))}),l.forEach(P=>{s||(tn(o[P].methods,c[P].methods)?tn(o[P].events,c[P].events)||(s=he("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${P}`)):s=he("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${P}`))}),s}function hS(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Bf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function lS(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=jn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function fS(i,e){return ku(i,!1)&&i<=e.max&&i>=e.min}function Kf(){const i=$s();return new Promise(e=>{switch(i){case xr.browser:e(dS());break;case xr.reactNative:e(pS());break;case xr.node:e(gS());break;default:e(!0)}})}function dS(){return Ns()&&(navigator==null?void 0:navigator.onLine)}async function pS(){if(Cs()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function gS(){return!0}function yS(i){switch($s()){case xr.browser:_S(i);break;case xr.reactNative:vS(i);break}}function _S(i){!Cs()&&Ns()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function vS(i){Cs()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Vc={};let qo=class{static get(e){return Vc[e]}static set(e,t){Vc[e]=t}static delete(e){delete Vc[e]}};const mS="PARSE_ERROR",bS="INVALID_REQUEST",wS="METHOD_NOT_FOUND",ES="INVALID_PARAMS",vp="INTERNAL_ERROR",Gu="SERVER_ERROR",SS=[-32700,-32600,-32601,-32602,-32603],ms={[mS]:{code:-32700,message:"Parse error"},[bS]:{code:-32600,message:"Invalid Request"},[wS]:{code:-32601,message:"Method not found"},[ES]:{code:-32602,message:"Invalid params"},[vp]:{code:-32603,message:"Internal error"},[Gu]:{code:-32e3,message:"Server error"}},mp=Gu;function IS(i){return SS.includes(i)}function Vf(i){return Object.keys(ms).includes(i)?ms[i]:ms[mp]}function xS(i){const e=Object.values(ms).find(t=>t.code===i);return e||ms[mp]}function bp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var wp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Iu=function(i,e){return Iu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Iu(i,e)};function OS(i,e){Iu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xu=function(){return xu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},xu.apply(this,arguments)};function PS(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function AS(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function TS(i,e){return function(t,s){e(t,s,i)}}function RS(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function CS(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(w){try{p(s.next(w))}catch(P){l(P)}}function y(w){try{p(s.throw(w))}catch(P){l(P)}}function p(w){w.done?c(w.value):o(w.value).then(f,y)}p((s=s.apply(i,e||[])).next())})}function NS(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(w){return y([p,w])}}function y(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(w){p=[6,w],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function $S(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function DS(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Ou(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ep(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function FS(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ep(arguments[e]));return i}function LS(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(i){return this instanceof Ps?(this.v=i,this):new Ps(i)}function US(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(I){s[I]&&(o[I]=function(T){return new Promise(function($,B){c.push([I,T,$,B])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch($){P(c[0][3],$)}}function y(I){I.value instanceof Ps?Promise.resolve(I.value.v).then(p,w):P(c[0][2],I)}function p(I){f("next",I)}function w(I){f("throw",I)}function P(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function jS(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ps(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function MS(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Ou=="function"?Ou(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,y){l=i[c](l),o(f,y,l.done,l.value)})}}function o(c,l,f,y){Promise.resolve(y).then(function(p){c({value:p,done:f})},l)}}function qS(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function HS(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function zS(i){return i&&i.__esModule?i:{default:i}}function BS(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function KS(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const VS=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xu},__asyncDelegator:jS,__asyncGenerator:US,__asyncValues:MS,__await:Ps,__awaiter:CS,__classPrivateFieldGet:BS,__classPrivateFieldSet:KS,__createBinding:$S,__decorate:AS,__exportStar:DS,__extends:OS,__generator:NS,__importDefault:zS,__importStar:HS,__makeTemplateObject:qS,__metadata:RS,__param:TS,__read:Ep,__rest:PS,__spread:FS,__spreadArrays:LS,__values:Ou},Symbol.toStringTag,{value:"Module"})),kS=Dn(VS);var pi={},kf;function GS(){if(kf)return pi;kf=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isBrowserCryptoAvailable=pi.getSubtleCrypto=pi.getBrowerCrypto=void 0;function i(){return(_r===null||_r===void 0?void 0:_r.crypto)||(_r===null||_r===void 0?void 0:_r.msCrypto)||{}}pi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}pi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return pi.isBrowserCryptoAvailable=t,pi}var gi={},Gf;function WS(){if(Gf)return gi;Gf=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowser=gi.isNode=gi.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}gi.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}gi.isNode=e;function t(){return!i()&&!e()}return gi.isBrowser=t,gi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=kS;e.__exportStar(GS(),i),e.__exportStar(WS(),i)})(wp);function Wu(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Sp(i=6){return BigInt(Wu(i))}function $n(i,e,t){return{id:t||Wu(),jsonrpc:"2.0",method:i,params:e}}function Yu(i,e){return{id:i,jsonrpc:"2.0",result:e}}function aa(i,e,t){return{id:i,jsonrpc:"2.0",error:YS(e,t)}}function YS(i,e){return typeof i>"u"?Vf(vp):(typeof i=="string"&&(i=Object.assign(Object.assign({},Vf(Gu)),{message:i})),typeof e<"u"&&(i.data=e),IS(i.code)&&(i=xS(i.code)),i)}class JS{}class QS extends JS{constructor(){super()}}class XS extends QS{constructor(e){super()}}const ZS="^https?:",e2="^wss?:";function t2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Ip(i,e){const t=t2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function Wf(i){return Ip(i,ZS)}function Yf(i){return Ip(i,e2)}function r2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function xp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Ju(i){return xp(i)&&"method"in i}function ca(i){return xp(i)&&(vi(i)||kr(i))}function vi(i){return"result"in i}function kr(i){return"error"in i}class mi extends XS{constructor(e){super(e),this.events=new Ur.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict($n(e.method,e.params||[],e.id||Sp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{kr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ca(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const i2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),n2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Jf=i=>i.split("?")[0],Qf=10,s2=i2();class o2{constructor(e){if(this.url=e,this.events=new Ur.EventEmitter,this.registering=!1,!Yf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Is(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Yf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=wp.isReactNative()?void 0:{rejectUnauthorized:!r2(e)},c=new s2(e,[],o);n2()?c.onerror=l=>{const f=l;s(this.emitError(f.error))}:c.on("error",l=>{s(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Fu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=aa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return bp(e,Jf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Qf&&this.events.setMaxListeners(Qf)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Jf(this.url)}`));return this.events.emit("register_error",t),t}}var Qo={exports:{}};Qo.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",y="[object Array]",p="[object AsyncFunction]",w="[object Boolean]",P="[object Date]",I="[object Error]",T="[object Function]",$="[object GeneratorFunction]",B="[object Map]",k="[object Number]",ae="[object Null]",F="[object Object]",M="[object Promise]",A="[object Proxy]",C="[object RegExp]",E="[object Set]",u="[object String]",b="[object Symbol]",Y="[object Undefined]",G="[object WeakMap]",ne="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",m="[object Float64Array]",O="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",K="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,se=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[m]=le[O]=le[ee]=le[Q]=le[K]=le[V]=le[J]=le[re]=!0,le[f]=le[y]=le[ne]=le[w]=le[ce]=le[P]=le[I]=le[T]=le[B]=le[k]=le[F]=le[C]=le[E]=le[u]=le[G]=!1;var ve=typeof _r=="object"&&_r&&_r.Object===Object&&_r,H=typeof self=="object"&&self&&self.Object===Object&&self,q=ve||H||Function("return this")(),D=e&&!e.nodeType&&e,d=D&&!0&&i&&!i.nodeType&&i,R=d&&d.exports===D,oe=R&&ve.process,fe=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),xe=fe&&fe.isTypedArray;function ze(S,L){for(var te=-1,pe=S==null?0:S.length,at=0,Ce=[];++te<pe;){var ft=S[te];L(ft,te,S)&&(Ce[at++]=ft)}return Ce}function Ve(S,L){for(var te=-1,pe=L.length,at=S.length;++te<pe;)S[at+te]=L[te];return S}function Ue(S,L){for(var te=-1,pe=S==null?0:S.length;++te<pe;)if(L(S[te],te,S))return!0;return!1}function pt(S,L){for(var te=-1,pe=Array(S);++te<S;)pe[te]=L(te);return pe}function gt(S){return function(L){return S(L)}}function Me(S,L){return S.has(L)}function Oe(S,L){return S==null?void 0:S[L]}function $e(S){var L=-1,te=Array(S.size);return S.forEach(function(pe,at){te[++L]=[at,pe]}),te}function De(S,L){return function(te){return S(L(te))}}function qe(S){var L=-1,te=Array(S.size);return S.forEach(function(pe){te[++L]=pe}),te}var Ae=Array.prototype,Fe=Function.prototype,Ie=Object.prototype,Te=q["__core-js_shared__"],Be=Fe.toString,Pe=Ie.hasOwnProperty,ke=function(){var S=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),We=Ie.toString,et=RegExp("^"+Be.call(Pe).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=R?q.Buffer:void 0,Je=q.Symbol,Zt=q.Uint8Array,ur=Ie.propertyIsEnumerable,Gr=Ae.splice,er=Je?Je.toStringTag:void 0,ri=Object.getOwnPropertySymbols,wi=tt?tt.isBuffer:void 0,Ui=De(Object.keys,Object),Et=mr(q,"DataView"),yt=mr(q,"Map"),St=mr(q,"Promise"),It=mr(q,"Set"),bt=mr(q,"WeakMap"),_t=mr(Object,"create"),Dt=ni(Et),Ft=ni(yt),xt=ni(St),Lt=ni(It),Ot=ni(bt),Tt=Je?Je.prototype:void 0,Pt=Tt?Tt.valueOf:void 0;function ht(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function Ut(){this.__data__=_t?_t(null):{},this.size=0}function jt(S){var L=this.has(S)&&delete this.__data__[S];return this.size-=L?1:0,L}function la(S){var L=this.__data__;if(_t){var te=L[S];return te===s?void 0:te}return Pe.call(L,S)?L[S]:void 0}function fa(S){var L=this.__data__;return _t?L[S]!==void 0:Pe.call(L,S)}function da(S,L){var te=this.__data__;return this.size+=this.has(S)?0:1,te[S]=_t&&L===void 0?s:L,this}ht.prototype.clear=Ut,ht.prototype.delete=jt,ht.prototype.get=la,ht.prototype.has=fa,ht.prototype.set=da;function Pr(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function pa(){this.__data__=[],this.size=0}function ga(S){var L=this.__data__,te=ji(L,S);if(te<0)return!1;var pe=L.length-1;return te==pe?L.pop():Gr.call(L,te,1),--this.size,!0}function ya(S){var L=this.__data__,te=ji(L,S);return te<0?void 0:L[te][1]}function _a(S){return ji(this.__data__,S)>-1}function va(S,L){var te=this.__data__,pe=ji(te,S);return pe<0?(++this.size,te.push([S,L])):te[pe][1]=L,this}Pr.prototype.clear=pa,Pr.prototype.delete=ga,Pr.prototype.get=ya,Pr.prototype.has=_a,Pr.prototype.set=va;function ii(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function an(){this.size=0,this.__data__={hash:new ht,map:new(yt||Pr),string:new ht}}function ma(S){var L=Ei(this,S).delete(S);return this.size-=L?1:0,L}function cn(S){return Ei(this,S).get(S)}function ba(S){return Ei(this,S).has(S)}function wa(S,L){var te=Ei(this,S),pe=te.size;return te.set(S,L),this.size+=te.size==pe?0:1,this}ii.prototype.clear=an,ii.prototype.delete=ma,ii.prototype.get=cn,ii.prototype.has=ba,ii.prototype.set=wa;function un(S){var L=-1,te=S==null?0:S.length;for(this.__data__=new ii;++L<te;)this.add(S[L])}function Fs(S){return this.__data__.set(S,s),this}function Ls(S){return this.__data__.has(S)}un.prototype.add=un.prototype.push=Fs,un.prototype.has=Ls;function jr(S){var L=this.__data__=new Pr(S);this.size=L.size}function Ea(){this.__data__=new Pr,this.size=0}function Sa(S){var L=this.__data__,te=L.delete(S);return this.size=L.size,te}function Ia(S){return this.__data__.get(S)}function xa(S){return this.__data__.has(S)}function Us(S,L){var te=this.__data__;if(te instanceof Pr){var pe=te.__data__;if(!yt||pe.length<t-1)return pe.push([S,L]),this.size=++te.size,this;te=this.__data__=new ii(pe)}return te.set(S,L),this.size=te.size,this}jr.prototype.clear=Ea,jr.prototype.delete=Sa,jr.prototype.get=Ia,jr.prototype.has=xa,jr.prototype.set=Us;function js(S,L){var te=fn(S),pe=!te&&Js(S),at=!te&&!pe&&Hn(S),Ce=!te&&!pe&&!at&&Zs(S),ft=te||pe||at||Ce,Mt=ft?pt(S.length,String):[],Qe=Mt.length;for(var ct in S)(L||Pe.call(S,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ce&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Vs(ct,Qe)))&&Mt.push(ct);return Mt}function ji(S,L){for(var te=S.length;te--;)if(Ys(S[te][0],L))return te;return-1}function Mn(S,L,te){var pe=L(S);return fn(S)?pe:Ve(pe,te(S))}function Mi(S){return S==null?S===void 0?Y:ae:er&&er in Object(S)?Bs(S):Aa(S)}function qn(S){return Hi(S)&&Mi(S)==f}function qi(S,L,te,pe,at){return S===L?!0:S==null||L==null||!Hi(S)&&!Hi(L)?S!==S&&L!==L:Ms(S,L,te,pe,qi,at)}function Ms(S,L,te,pe,at,Ce){var ft=fn(S),Mt=fn(L),Qe=ft?y:Wr(S),ct=Mt?y:Wr(L);Qe=Qe==f?F:Qe,ct=ct==f?F:ct;var Rt=Qe==F,hr=ct==F,qt=Qe==ct;if(qt&&Hn(S)){if(!Hn(L))return!1;ft=!0,Rt=!1}if(qt&&!Rt)return Ce||(Ce=new jr),ft||Zs(S)?hn(S,L,te,pe,at,Ce):Pa(S,L,Qe,te,pe,at,Ce);if(!(te&o)){var dt=Rt&&Pe.call(S,"__wrapped__"),tr=hr&&Pe.call(L,"__wrapped__");if(dt||tr){var Mr=dt?S.value():S,Ar=tr?L.value():L;return Ce||(Ce=new jr),at(Mr,Ar,te,pe,Ce)}}return qt?(Ce||(Ce=new jr),zs(S,L,te,pe,at,Ce)):!1}function Oa(S){if(!Xs(S)||Gs(S))return!1;var L=dn(S)?et:se;return L.test(ni(S))}function qs(S){return Hi(S)&&Qs(S.length)&&!!le[Mi(S)]}function Hs(S){if(!Ws(S))return Ui(S);var L=[];for(var te in Object(S))Pe.call(S,te)&&te!="constructor"&&L.push(te);return L}function hn(S,L,te,pe,at,Ce){var ft=te&o,Mt=S.length,Qe=L.length;if(Mt!=Qe&&!(ft&&Qe>Mt))return!1;var ct=Ce.get(S);if(ct&&Ce.get(L))return ct==L;var Rt=-1,hr=!0,qt=te&c?new un:void 0;for(Ce.set(S,L),Ce.set(L,S);++Rt<Mt;){var dt=S[Rt],tr=L[Rt];if(pe)var Mr=ft?pe(tr,dt,Rt,L,S,Ce):pe(dt,tr,Rt,S,L,Ce);if(Mr!==void 0){if(Mr)continue;hr=!1;break}if(qt){if(!Ue(L,function(Ar,Yr){if(!Me(qt,Yr)&&(dt===Ar||at(dt,Ar,te,pe,Ce)))return qt.push(Yr)})){hr=!1;break}}else if(!(dt===tr||at(dt,tr,te,pe,Ce))){hr=!1;break}}return Ce.delete(S),Ce.delete(L),hr}function Pa(S,L,te,pe,at,Ce,ft){switch(te){case ce:if(S.byteLength!=L.byteLength||S.byteOffset!=L.byteOffset)return!1;S=S.buffer,L=L.buffer;case ne:return!(S.byteLength!=L.byteLength||!Ce(new Zt(S),new Zt(L)));case w:case P:case k:return Ys(+S,+L);case I:return S.name==L.name&&S.message==L.message;case C:case u:return S==L+"";case B:var Mt=$e;case E:var Qe=pe&o;if(Mt||(Mt=qe),S.size!=L.size&&!Qe)return!1;var ct=ft.get(S);if(ct)return ct==L;pe|=c,ft.set(S,L);var Rt=hn(Mt(S),Mt(L),pe,at,Ce,ft);return ft.delete(S),Rt;case b:if(Pt)return Pt.call(S)==Pt.call(L)}return!1}function zs(S,L,te,pe,at,Ce){var ft=te&o,Mt=ln(S),Qe=Mt.length,ct=ln(L),Rt=ct.length;if(Qe!=Rt&&!ft)return!1;for(var hr=Qe;hr--;){var qt=Mt[hr];if(!(ft?qt in L:Pe.call(L,qt)))return!1}var dt=Ce.get(S);if(dt&&Ce.get(L))return dt==L;var tr=!0;Ce.set(S,L),Ce.set(L,S);for(var Mr=ft;++hr<Qe;){qt=Mt[hr];var Ar=S[qt],Yr=L[qt];if(pe)var zn=ft?pe(Yr,Ar,qt,L,S,Ce):pe(Ar,Yr,qt,S,L,Ce);if(!(zn===void 0?Ar===Yr||at(Ar,Yr,te,pe,Ce):zn)){tr=!1;break}Mr||(Mr=qt=="constructor")}if(tr&&!Mr){var zi=S.constructor,Kt=L.constructor;zi!=Kt&&"constructor"in S&&"constructor"in L&&!(typeof zi=="function"&&zi instanceof zi&&typeof Kt=="function"&&Kt instanceof Kt)&&(tr=!1)}return Ce.delete(S),Ce.delete(L),tr}function ln(S){return Mn(S,Ca,Ks)}function Ei(S,L){var te=S.__data__;return ks(L)?te[typeof L=="string"?"string":"hash"]:te.map}function mr(S,L){var te=Oe(S,L);return Oa(te)?te:void 0}function Bs(S){var L=Pe.call(S,er),te=S[er];try{S[er]=void 0;var pe=!0}catch{}var at=We.call(S);return pe&&(L?S[er]=te:delete S[er]),at}var Ks=ri?function(S){return S==null?[]:(S=Object(S),ze(ri(S),function(L){return ur.call(S,L)}))}:ot,Wr=Mi;(Et&&Wr(new Et(new ArrayBuffer(1)))!=ce||yt&&Wr(new yt)!=B||St&&Wr(St.resolve())!=M||It&&Wr(new It)!=E||bt&&Wr(new bt)!=G)&&(Wr=function(S){var L=Mi(S),te=L==F?S.constructor:void 0,pe=te?ni(te):"";if(pe)switch(pe){case Dt:return ce;case Ft:return B;case xt:return M;case Lt:return E;case Ot:return G}return L});function Vs(S,L){return L=L??l,!!L&&(typeof S=="number"||we.test(S))&&S>-1&&S%1==0&&S<L}function ks(S){var L=typeof S;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?S!=="__proto__":S===null}function Gs(S){return!!ke&&ke in S}function Ws(S){var L=S&&S.constructor,te=typeof L=="function"&&L.prototype||Ie;return S===te}function Aa(S){return We.call(S)}function ni(S){if(S!=null){try{return Be.call(S)}catch{}try{return S+""}catch{}}return""}function Ys(S,L){return S===L||S!==S&&L!==L}var Js=qn(function(){return arguments}())?qn:function(S){return Hi(S)&&Pe.call(S,"callee")&&!ur.call(S,"callee")},fn=Array.isArray;function Ta(S){return S!=null&&Qs(S.length)&&!dn(S)}var Hn=wi||st;function Ra(S,L){return qi(S,L)}function dn(S){if(!Xs(S))return!1;var L=Mi(S);return L==T||L==$||L==p||L==A}function Qs(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=l}function Xs(S){var L=typeof S;return S!=null&&(L=="object"||L=="function")}function Hi(S){return S!=null&&typeof S=="object"}var Zs=xe?gt(xe):qs;function Ca(S){return Ta(S)?js(S):Hs(S)}function ot(){return[]}function st(){return!1}i.exports=Ra})(Qo,Qo.exports);var a2=Qo.exports;const c2=Nd(a2);function u2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,y=i.charAt(0),p=Math.log(f)/Math.log(256),w=Math.log(256)/Math.log(f);function P($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var B=0,k=0,ae=0,F=$.length;ae!==F&&$[ae]===0;)ae++,B++;for(var M=(F-ae)*w+1>>>0,A=new Uint8Array(M);ae!==F;){for(var C=$[ae],E=0,u=M-1;(C!==0||E<k)&&u!==-1;u--,E++)C+=256*A[u]>>>0,A[u]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");k=E,ae++}for(var b=M-k;b!==M&&A[b]===0;)b++;for(var Y=y.repeat(B);b<M;++b)Y+=i.charAt(A[b]);return Y}function I($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var B=0;if($[B]!==" "){for(var k=0,ae=0;$[B]===y;)k++,B++;for(var F=($.length-B)*p+1>>>0,M=new Uint8Array(F);$[B];){var A=t[$.charCodeAt(B)];if(A===255)return;for(var C=0,E=F-1;(A!==0||C<ae)&&E!==-1;E--,C++)A+=f*M[E]>>>0,M[E]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");ae=C,B++}if($[B]!==" "){for(var u=F-ae;u!==F&&M[u]===0;)u++;for(var b=new Uint8Array(k+(F-u)),Y=k;u!==F;)b[Y++]=M[u++];return b}}}function T($){var B=I($);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:P,decodeUnsafe:I,decode:T}}var h2=u2,l2=h2;const Op=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},f2=i=>new TextEncoder().encode(i),d2=i=>new TextDecoder().decode(i);class p2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class g2{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Pp(this,e)}}class y2{constructor(e){this.decoders=e}or(e){return Pp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pp=(i,e)=>new y2({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});let _2=class{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new p2(e,t,s),this.decoder=new g2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const ua=({name:i,prefix:e,encode:t,decode:s})=>new _2(i,e,t,s),Ds=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=l2(t,e);return ua({prefix:i,name:e,encode:s,decode:c=>Op(o(c))})},v2=(i,e,t,s)=>{const o={};for(let w=0;w<e.length;++w)o[e[w]]=w;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,y=0,p=0;for(let w=0;w<c;++w){const P=o[i[w]];if(P===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|P,f+=t,f>=8&&(f-=8,l[p++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return l},m2=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Wt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ua({prefix:e,name:i,encode(o){return m2(o,s,t)},decode(o){return v2(o,s,t,i)}}),b2=ua({prefix:"\0",name:"identity",encode:i=>d2(i),decode:i=>f2(i)});var w2=Object.freeze({__proto__:null,identity:b2});const E2=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var S2=Object.freeze({__proto__:null,base2:E2});const I2=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var x2=Object.freeze({__proto__:null,base8:I2});const O2=Ds({prefix:"9",name:"base10",alphabet:"0123456789"});var P2=Object.freeze({__proto__:null,base10:O2});const A2=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),T2=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var R2=Object.freeze({__proto__:null,base16:A2,base16upper:T2});const C2=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),N2=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$2=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),D2=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),F2=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),L2=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),U2=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j2=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),M2=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var q2=Object.freeze({__proto__:null,base32:C2,base32upper:N2,base32pad:$2,base32padupper:D2,base32hex:F2,base32hexupper:L2,base32hexpad:U2,base32hexpadupper:j2,base32z:M2});const H2=Ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),z2=Ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B2=Object.freeze({__proto__:null,base36:H2,base36upper:z2});const K2=Ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),V2=Ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var k2=Object.freeze({__proto__:null,base58btc:K2,base58flickr:V2});const G2=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W2=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y2=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),J2=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Q2=Object.freeze({__proto__:null,base64:G2,base64pad:W2,base64url:Y2,base64urlpad:J2});const Ap=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X2=Ap.reduce((i,e,t)=>(i[t]=e,i),[]),Z2=Ap.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function e3(i){return i.reduce((e,t)=>(e+=X2[t],e),"")}function t3(i){const e=[];for(const t of i){const s=Z2[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const r3=ua({prefix:"🚀",name:"base256emoji",encode:e3,decode:t3});var i3=Object.freeze({__proto__:null,base256emoji:r3}),n3=Tp,Xf=128,s3=127,o3=~s3,a3=Math.pow(2,31);function Tp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=a3;)e[t++]=i&255|Xf,i/=128;for(;i&o3;)e[t++]=i&255|Xf,i>>>=7;return e[t]=i|0,Tp.bytes=t-s+1,e}var c3=Pu,u3=128,Zf=127;function Pu(i,s){var t=0,s=s||0,o=0,c=s,l,f=i.length;do{if(c>=f)throw Pu.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&Zf)<<o:(l&Zf)*Math.pow(2,o),o+=7}while(l>=u3);return Pu.bytes=c-s,t}var h3=Math.pow(2,7),l3=Math.pow(2,14),f3=Math.pow(2,21),d3=Math.pow(2,28),p3=Math.pow(2,35),g3=Math.pow(2,42),y3=Math.pow(2,49),_3=Math.pow(2,56),v3=Math.pow(2,63),m3=function(i){return i<h3?1:i<l3?2:i<f3?3:i<d3?4:i<p3?5:i<g3?6:i<y3?7:i<_3?8:i<v3?9:10},b3={encode:n3,decode:c3,encodingLength:m3},Rp=b3;const ed=(i,e,t=0)=>(Rp.encode(i,e,t),e),td=i=>Rp.encodingLength(i),Au=(i,e)=>{const t=e.byteLength,s=td(i),o=s+td(t),c=new Uint8Array(o+t);return ed(i,c,0),ed(t,c,s),c.set(e,o),new w3(i,t,e,c)};class w3{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Cp=({name:i,code:e,encode:t})=>new E3(i,e,t);class E3{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Au(this.code,t):t.then(s=>Au(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Np=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),S3=Cp({name:"sha2-256",code:18,encode:Np("SHA-256")}),I3=Cp({name:"sha2-512",code:19,encode:Np("SHA-512")});var x3=Object.freeze({__proto__:null,sha256:S3,sha512:I3});const $p=0,O3="identity",Dp=Op,P3=i=>Au($p,Dp(i)),A3={code:$p,name:O3,encode:Dp,digest:P3};var T3=Object.freeze({__proto__:null,identity:A3});new TextEncoder,new TextDecoder;const rd={...w2,...S2,...x2,...P2,...R2,...q2,...B2,...k2,...Q2,...i3};({...x3,...T3});function Fp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function R3(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Fp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Lp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const id=Lp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),kc=Lp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=R3(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),C3={utf8:id,"utf-8":id,hex:rd.base16,latin1:kc,ascii:kc,binary:kc,...rd};function N3(i,e="utf8"){const t=C3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Fp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const Up="wc",$3=2,Qu="core",$i=`${Up}@2:${Qu}:`,D3={name:Qu,logger:"error"},F3={database:":memory:"},L3="crypto",nd="client_ed25519_seed",U3=_e.ONE_DAY,j3="keychain",M3="0.3",q3="messages",H3="0.3",z3=_e.SIX_HOURS,B3="publisher",jp="irn",K3="error",Mp="wss://relay.walletconnect.com",sd="wss://relay.walletconnect.org",V3="relayer",Xt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},k3="_subscription",yi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},G3=_e.ONE_SECOND,W3="2.10.4",Y3=1e4,J3="0.3",Q3="WALLETCONNECT_CLIENT_ID",Kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},X3="subscription",Z3="0.3",eI=_e.FIVE_SECONDS*1e3,tI="pairing",rI="0.3",ls={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},_s={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ei={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},iI="history",nI="0.3",sI="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},oI="0.3",Gc="verify-api",Rn="https://verify.walletconnect.com",Tu="https://verify.walletconnect.org",aI=[Rn,Tu];class cI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=j3,this.version=M3,this.initialized=!1,this.storagePrefix=$i,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=he("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,fp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?dp(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class uI{constructor(e,t,s){this.core=e,this.logger=t,this.name=L3,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Pf(o);return Xd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=o6();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=Pf(c),f=Eu();return await IE(f,o,U3,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),y=a6(f,c);return this.setSymKey(y,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||c6(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=lp(l),y=Is(c);if(Df(f)){const I=f.senderPublicKey,T=f.receiverPublicKey;o=await this.generateSharedKey(I,T)}const p=this.getSymKey(o),{type:w,senderPublicKey:P}=f;return h6({type:w,symKey:p,message:y,senderPublicKey:P})},this.decode=async(o,c,l)=>{this.isInitialized();const f=d6(c,l);if(Df(f)){const y=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(y,p)}try{const y=this.getSymKey(o),p=l6({symKey:y,encoded:c});return Fu(p)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Yo(o);return Rs(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Yo(o);return c.senderPublicKey?cr(c.senderPublicKey,ar):void 0},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.keychain=s||new cI(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(nd)}catch{e=Eu(),await this.keychain.set(nd,e)}return N3(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class hI extends Pw{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=q3,this.version=H3,this.initialized=!1,this.storagePrefix=$i,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Cn(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=Cn(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=t}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,fp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?dp(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class lI extends Aw{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Ur.EventEmitter,this.name=B3,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||z3,y=Su(c),p=(c==null?void 0:c.prompt)||!1,w=(c==null?void 0:c.tag)||0,P=(c==null?void 0:c.id)||Sp().toString(),I={topic:s,message:o,opts:{ttl:f,relay:y,prompt:p,tag:w,id:P}},T=setTimeout(()=>this.queue.set(P,I),this.publishTimeout);try{await await Os(this.rpcPublish(s,o,f,y,p,w,P),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(P),this.relayer.events.emit(Xt.publish,I)}catch($){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(P),$;return}finally{clearTimeout(T)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,f){var y,p,w,P;const I={method:Ko(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return or((y=I.params)==null?void 0:y.prompt)&&((p=I.params)==null||delete p.prompt),or((w=I.params)==null?void 0:w.tag)&&((P=I.params)==null||delete P.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.request(I)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Xt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Xt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class fI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var dI=Object.defineProperty,pI=Object.defineProperties,gI=Object.getOwnPropertyDescriptors,od=Object.getOwnPropertySymbols,yI=Object.prototype.hasOwnProperty,_I=Object.prototype.propertyIsEnumerable,ad=(i,e,t)=>e in i?dI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,fs=(i,e)=>{for(var t in e||(e={}))yI.call(e,t)&&ad(i,t,e[t]);if(od)for(var t of od(e))_I.call(e,t)&&ad(i,t,e[t]);return i},Wc=(i,e)=>pI(i,gI(e));class vI extends Cw{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new fI,this.events=new Ur.EventEmitter,this.name=X3,this.version=Z3,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$i,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Su(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const l=new _e.Watch;l.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=eI&&(clearInterval(f),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(t,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Su(s);await this.rpcUnsubscribe(e,t,o);const c=$t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Ko(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Os(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}return Cn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Ko(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Os(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Ko(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Wc(fs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,fs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,fs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Kr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Kr.deleted,Wc(fs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Kr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Kr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ti(t)&&this.onBatchSubscribe(t.map((s,o)=>Wc(fs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Xt.connect,async()=>{await this.onConnect()}),this.relayer.on(Xt.disconnect,()=>{this.onDisconnect()}),this.events.on(Kr.created,async e=>{const t=Kr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Kr.deleted,async e=>{const t=Kr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var mI=Object.defineProperty,cd=Object.getOwnPropertySymbols,bI=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,ud=(i,e,t)=>e in i?mI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,EI=(i,e)=>{for(var t in e||(e={}))bI.call(e,t)&&ud(i,t,e[t]);if(cd)for(var t of cd(e))wI.call(e,t)&&ud(i,t,e[t]);return i};class SI extends Tw{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Ur.EventEmitter,this.name=V3,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Xt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Xt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(yi.payload,this.onPayloadHandler),this.provider.on(yi.connect,this.onConnectHandler),this.provider.on(yi.disconnect,this.onDisconnectHandler),this.provider.on(yi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||K3})),this.messages=new hI(this.logger,e.core),this.subscriber=new vI(this,this.logger),this.publisher=new lI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Mp,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${sd}...`),await this.restartTransport(sd)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Y3)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const l=f=>{f.topic===e&&(this.subscriber.off(Kr.created,l),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Kr.created,l)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Os(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Kr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Os(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(yi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Kf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new mi(new o2(I6({sdkVersion:W3,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ju(e)){if(!e.method.endsWith(k3))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(EI({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else ca(e)&&this.events.emit(Xt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Xt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Yu(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(yi.payload,this.onPayloadHandler),this.provider.off(yi.connect,this.onConnectHandler),this.provider.off(yi.disconnect,this.onDisconnectHandler),this.provider.off(yi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Xt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Kf();yS(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Xt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},_e.toMiliseconds(G3)))}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var II=Object.defineProperty,hd=Object.getOwnPropertySymbols,xI=Object.prototype.hasOwnProperty,OI=Object.prototype.propertyIsEnumerable,ld=(i,e,t)=>e in i?II(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,fd=(i,e)=>{for(var t in e||(e={}))xI.call(e,t)&&ld(i,t,e[t]);if(hd)for(var t of hd(e))OI.call(e,t)&&ld(i,t,e[t]);return i};class ha extends Rw{constructor(e,t,s,o=$i,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=J3,this.cached=[],this.initialized=!1,this.storagePrefix=$i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!or(l)?this.map.set(this.getKey(l),l):G6(l)?this.map.set(l.id,l):W6(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(y=>c2(f[y],l[y]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const y=fd(fd({},this.getData(l)),f);this.map.set(l,y),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=Ze.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class PI{constructor(e,t){this.core=e,this.logger=t,this.name=tI,this.version=rI,this.events=new Du,this.initialized=!1,this.storagePrefix=$i,this.ignoredPayloadTypes=[sn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Eu(),o=await this.core.crypto.setSymKey(s),c=Vr(_e.FIVE_MINUTES),l={protocol:jp},f={topic:o,expiry:c,relay:l,active:!1},y=U6({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l}=D6(s.uri);let f;if(this.pairings.keys.includes(o)&&(f=this.pairings.get(o),f.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l}));const y=Vr(_e.FIVE_MINUTES),p={topic:o,relay:l,expiry:y,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,y),s.activatePairing&&await this.activate({topic:o}),this.events.emit(_s.create,p),p},this.activate=async({topic:s})=>{this.isInitialized();const o=Vr(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:y}=Tn();this.events.once(Ht("pairing_ping",c),({error:p})=>{p?y(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",$t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=$n(o,c),f=await this.core.crypto.encode(s,l),y=ls[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,y),l.id},this.sendResult=async(s,o,c)=>{const l=Yu(s,c),f=await this.core.crypto.encode(o,l),y=await this.core.history.get(o,s),p=ls[y.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=aa(s,c),f=await this.core.crypto.encode(o,l),y=await this.core.history.get(o,s),p=ls[y.request.method]?ls[y.request.method].res:ls.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,$t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ni(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(_s.ping,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{vi(o)?this.events.emit(Ht("pairing_ping",c),{}):kr(o)&&this.events.emit(Ht("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(_s.delete,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=$t("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error($t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!yr(s)){const{message:o}=he("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!k6(s.uri)){const{message:o}=he("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!yr(s)){const{message:c}=he("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:c}=he("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:o}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ni(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=he("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Ze.generateChildLogger(t,this.name),this.pairings=new ha(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Xt.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{Ju(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ca(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async e=>{const{topic:t}=gp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(_s.expire,{topic:t}))})}}class AI extends Ow{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Ur.EventEmitter,this.name=iI,this.version=nI,this.cached=[],this.initialized=!1,this.storagePrefix=$i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Vr(_e.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ei.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ei.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ei.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:$n(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ei.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ei.created,e=>{const t=ei.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ei.updated,e=>{const t=ei.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ei.deleted,e=>{const t=ei.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class TI extends Nw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Ur.EventEmitter,this.name=sI,this.version=oI,this.cached=[],this.initialized=!1,this.storagePrefix=$i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Lr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Lr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(t,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return x6(e);if(typeof e=="number")return O6(e);const{message:t}=he("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Lr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,e=>{const t=Lr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.expired,e=>{const t=Lr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.deleted,e=>{const t=Lr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}}}class RI extends $w{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Gc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Cs()||!Ns())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Tu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),c=await this.fetchAttestation(s.attestationId,Tu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(_e.ONE_SECOND*2),l=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Gc))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=Gc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},_e.toMiliseconds(_e.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Rn;return aI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Rn}`),o=Rn),o},this.logger=Ze.generateChildLogger(t,this.name),this.verifyUrl=Rn,this.abortController=new AbortController,this.isDevEnv=Ku()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}var CI=Object.defineProperty,dd=Object.getOwnPropertySymbols,NI=Object.prototype.hasOwnProperty,$I=Object.prototype.propertyIsEnumerable,pd=(i,e,t)=>e in i?CI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,gd=(i,e)=>{for(var t in e||(e={}))NI.call(e,t)&&pd(i,t,e[t]);if(dd)for(var t of dd(e))$I.call(e,t)&&pd(i,t,e[t]);return i};class Xu extends xw{constructor(e){super(e),this.protocol=Up,this.version=$3,this.name=Qu,this.events=new Ur.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Mp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||D3.logger}));this.logger=Ze.generateChildLogger(t,this.name),this.heartbeat=new Fn.HeartBeat,this.crypto=new uI(this,this.logger,e==null?void 0:e.keychain),this.history=new AI(this,this.logger),this.expirer=new TI(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new tb(gd(gd({},F3),e==null?void 0:e.storageOptions)),this.relayer=new SI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new PI(this,this.logger),this.verify=new RI(this.projectId||"",this.logger)}static async init(e){const t=new Xu(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(Q3,s),t}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const DI=Xu,qp="wc",Hp=2,zp="client",Zu=`${qp}@${Hp}:${zp}:`,Yc={name:zp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},yd="WALLETCONNECT_DEEPLINK_CHOICE",FI="proposal",Bp="Proposal expired",LI="session",Ho=_e.SEVEN_DAYS,UI="engine",ds={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},Jc={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},_i={idle:"IDLE",active:"ACTIVE"},jI="request",MI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var qI=Object.defineProperty,HI=Object.defineProperties,zI=Object.getOwnPropertyDescriptors,_d=Object.getOwnPropertySymbols,BI=Object.prototype.hasOwnProperty,KI=Object.prototype.propertyIsEnumerable,vd=(i,e,t)=>e in i?qI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,gr=(i,e)=>{for(var t in e||(e={}))BI.call(e,t)&&vd(i,t,e[t]);if(_d)for(var t of _d(e))KI.call(e,t)&&vd(i,t,e[t]);return i},ps=(i,e)=>HI(i,zI(e));class VI extends Fw{constructor(e){super(e),this.name=UI,this.events=new Du,this.initialized=!1,this.ignoredPayloadTypes=[sn],this.requestQueue={state:_i.idle,queue:[]},this.sessionRequestQueue={state:_i.idle,queue:[]},this.requestQueueDelay=_e.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ds)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=ps(gr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:y}=s;let p=o,w,P=!1;if(p&&(P=this.client.core.pairing.pairings.get(p).active),!p||!P){const{topic:M,uri:A}=await this.client.core.pairing.create();p=M,w=A}const I=await this.client.core.crypto.generateKeyPair(),T=gr({requiredNamespaces:c,optionalNamespaces:l,relays:y??[{protocol:jp}],proposer:{publicKey:I,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:$,resolve:B,done:k}=Tn(_e.FIVE_MINUTES,Bp);if(this.events.once(Ht("session_connect"),async({error:M,session:A})=>{if(M)$(M);else if(A){A.self.publicKey=I;const C=ps(gr({},A),{requiredNamespaces:A.requiredNamespaces,optionalNamespaces:A.optionalNamespaces});await this.client.session.set(A.topic,C),await this.setExpiry(A.topic,A.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:A.peer.metadata}),B(C)}}),!p){const{message:M}=he("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(M)}const ae=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:T}),F=Vr(_e.FIVE_MINUTES);return await this.setProposal(ae,gr({id:ae,expiry:F},T)),{uri:w,approval:k}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:p,requiredNamespaces:w,optionalNamespaces:P}=f;y=y||"",Nn(w)||(w=H6(c,"approve()"));const I=await this.client.core.crypto.generateKeyPair(),T=p.publicKey,$=await this.client.core.crypto.generateSharedKey(I,T);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:p.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:I}}),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const B=gr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:P,pairingTopic:y,controller:{publicKey:I,metadata:this.client.metadata},expiry:Vr(Ho)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe($),await this.sendRequest({topic:$,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0});const k=ps(gr({},B),{topic:$,pairingTopic:y,acknowledged:!1,self:B.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:I});return await this.client.session.set($,k),await this.setExpiry($,Vr(Ho)),{topic:$,acknowledged:()=>new Promise(ae=>setTimeout(()=>ae(this.client.session.get($)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:y}=Tn();return this.events.once(Ht("session_update",c),({error:p})=>{p?y(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=Tn();return this.events.once(Ht("session_extend",o),({error:y})=>{y?f(y):l()}),await this.setExpiry(s,Vr(Ho)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l}=t,f=Wu(),{done:y,resolve:p,reject:w}=Tn(l,"Request expired. Please try again.");return this.events.once(Ht("session_request",f),({error:P,result:I})=>{P?w(P):p(I)}),await Promise.all([new Promise(async P=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(I=>w(I)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),P()}),new Promise(async P=>{const I=await this.client.core.storage.getItem(yd);P6({id:f,topic:c,wcDeepLink:I}),P()}),y()]).then(P=>P[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;vi(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):kr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=Tn();this.events.once(Ht("session_ping",o),({error:y})=>{y?f(y):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:$t("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>K6(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,$t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(yd).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,$t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=_i.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=ds.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l,verifyContext:f}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l,verifyContext:f}),s&&this.client.core.expirer.set(o,Vr(s))},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:p}=t,w=$n(o,c,y);if(Ns()&&MI.includes(o)){const T=Cn(JSON.stringify(w));this.client.core.verify.register({attestationId:T})}const P=await this.client.core.crypto.encode(s,w),I=ds[o].req;return l&&(I.ttl=l),f&&(I.id=f),this.client.core.history.set(s,w),p?(I.internal=ps(gr({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,P,I)):this.client.core.relayer.publish(s,P,I).catch(T=>this.client.logger.error(T)),w.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=Yu(s,c),y=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),w=ds[p.request.method].res;l?(w.internal=ps(gr({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,w)):this.client.core.relayer.publish(o,y,w).catch(P=>this.client.logger.error(P)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=aa(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=ds[f.request.method].res;this.client.core.relayer.publish(s,l,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{Ni(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ni(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===_i.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=_i.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=_i.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=he("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(gr({},s.params));const l=Vr(_e.FIVE_MINUTES),f=gr({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,f);const y=Cn(JSON.stringify(s)),p=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(vi(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const p=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const w=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:t})}else kr(s)&&(await this.client.proposal.delete(o,$t("USER_DISCONNECTED")),this.events.emit(Ht("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:y,namespaces:p,requiredNamespaces:w,optionalNamespaces:P,sessionProperties:I,pairingTopic:T}=s.params,$=gr({topic:t,relay:l,expiry:y,namespaces:p,acknowledged:!0,pairingTopic:T,requiredNamespaces:w,optionalNamespaces:P,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},I&&{sessionProperties:I});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(Ht("session_connect"),{session:$}),this.cleanupDuplicatePairings($)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;vi(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ht("session_approve",o),{})):kr(s)&&(await this.client.session.delete(t,$t("USER_DISCONNECTED")),this.events.emit(Ht("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=qo.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(gr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),qo.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;vi(s)?this.events.emit(Ht("session_update",o),{}):kr(s)&&this.events.emit(Ht("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Vr(Ho)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;vi(s)?this.events.emit(Ht("session_extend",o),{}):kr(s)&&this.events.emit(Ht("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{vi(s)?this.events.emit(Ht("session_ping",o),{}):kr(s)&&this.events.emit(Ht("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Xt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(gr({topic:t},c));const l=Cn(JSON.stringify($n("wc_sessionRequest",c,o))),f=this.client.session.get(t),y=await this.getVerifyContext(l,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;vi(s)?this.events.emit(Ht("session_request",o),{result:s.result}):kr(s)&&this.events.emit(Ht("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=qo.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(gr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),qo.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=_i.idle,this.processSessionRequestQueue()},_e.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===_i.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=_i.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,$n("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer},s.id))},this.isValidConnect=async t=>{if(!yr(t)){const{message:y}=he("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(or(s)||await this.isValidPairingTopic(s),!rS(f,!0)){const{message:y}=he("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!or(o)&&Nn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(c)&&Nn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),or(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=tS(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!yr(t))throw new Error(he("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Vo(o,"approve()");if(y)throw new Error(y.message);const p=zf(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!kt(c,!0)){const{message:w}=he("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}or(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!yr(t)){const{message:c}=he("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!nS(o)){const{message:c}=he("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!yr(t)){const{message:p}=he("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!_p(s)){const{message:p}=he("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=Y6(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Vo(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Ni(l)){const{message:p}=he("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!yr(t)){const{message:y}=he("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Vo(o,"update()");if(l)throw new Error(l.message);const f=zf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!yr(t)){const{message:o}=he("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!yr(t)){const{message:y}=he("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Hf(f,c)){const{message:y}=he("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!sS(o)){const{message:y}=he("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!cS(f,c,o.method)){const{message:y}=he("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(l&&!fS(l,Jc)){const{message:y}=he("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${Jc.min} and ${Jc.max}`);throw new Error(y)}},this.isValidRespond=async t=>{if(!yr(t)){const{message:c}=he("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!oS(o)){const{message:c}=he("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!yr(t)){const{message:o}=he("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!yr(t)){const{message:f}=he("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Hf(l,c)){const{message:f}=he("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!aS(o)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!uS(l,c,o.name)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!yr(t)){const{message:o}=he("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Rn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!kt(o,!1)){const{message:c}=he("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=he("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Xt.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{Ju(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ca(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async e=>{const{topic:t,id:s}=gp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,he("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(_s.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!kt(e,!1)){const{message:t}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ni(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=he("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!kt(e,!1)){const{message:t}=he("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=he("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ni(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=he("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(kt(e,!1)){const{message:t}=he("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=he("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!iS(e)){const{message:t}=he("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=he("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ni(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=he("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class kI extends ha{constructor(e,t){super(e,t,FI,Zu),this.core=e,this.logger=t}}class GI extends ha{constructor(e,t){super(e,t,LI,Zu),this.core=e,this.logger=t}}class WI extends ha{constructor(e,t){super(e,t,jI,Zu,s=>s.id),this.core=e,this.logger=t}}let YI=class Kp extends Dw{constructor(e){super(e),this.protocol=qp,this.version=Hp,this.name=Yc.name,this.events=new Ur.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Yc.name,this.metadata=(e==null?void 0:e.metadata)||b6();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Yc.logger}));this.core=(e==null?void 0:e.core)||new DI(e),this.logger=Ze.generateChildLogger(t,this.name),this.session=new GI(this.core,this.logger),this.proposal=new kI(this.core,this.logger),this.pendingRequest=new WI(this.core,this.logger),this.engine=new VI(this)}static async init(e){const t=new Kp(e);return await t.initialize(),t}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Ru={exports:{}};(function(i,e){var t=typeof self<"u"?self:_r,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(m){return m&&DataView.prototype.isPrototypeOf(m)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(m){return m&&p.indexOf(Object.prototype.toString.call(m))>-1};function P(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function I(m){return typeof m!="string"&&(m=String(m)),m}function T(m){var O={next:function(){var ee=m.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(O[Symbol.iterator]=function(){return O}),O}function $(m){this.map={},m instanceof $?m.forEach(function(O,ee){this.append(ee,O)},this):Array.isArray(m)?m.forEach(function(O){this.append(O[0],O[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(O){this.append(O,m[O])},this)}$.prototype.append=function(m,O){m=P(m),O=I(O);var ee=this.map[m];this.map[m]=ee?ee+", "+O:O},$.prototype.delete=function(m){delete this.map[P(m)]},$.prototype.get=function(m){return m=P(m),this.has(m)?this.map[m]:null},$.prototype.has=function(m){return this.map.hasOwnProperty(P(m))},$.prototype.set=function(m,O){this.map[P(m)]=I(O)},$.prototype.forEach=function(m,O){for(var ee in this.map)this.map.hasOwnProperty(ee)&&m.call(O,this.map[ee],ee,this)},$.prototype.keys=function(){var m=[];return this.forEach(function(O,ee){m.push(ee)}),T(m)},$.prototype.values=function(){var m=[];return this.forEach(function(O){m.push(O)}),T(m)},$.prototype.entries=function(){var m=[];return this.forEach(function(O,ee){m.push([ee,O])}),T(m)},f.iterable&&($.prototype[Symbol.iterator]=$.prototype.entries);function B(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function k(m){return new Promise(function(O,ee){m.onload=function(){O(m.result)},m.onerror=function(){ee(m.error)}})}function ae(m){var O=new FileReader,ee=k(O);return O.readAsArrayBuffer(m),ee}function F(m){var O=new FileReader,ee=k(O);return O.readAsText(m),ee}function M(m){for(var O=new Uint8Array(m),ee=new Array(O.length),Q=0;Q<O.length;Q++)ee[Q]=String.fromCharCode(O[Q]);return ee.join("")}function A(m){if(m.slice)return m.slice(0);var O=new Uint8Array(m.byteLength);return O.set(new Uint8Array(m)),O.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:f.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:f.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():f.arrayBuffer&&f.blob&&y(m)?(this._bodyArrayBuffer=A(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||w(m))?this._bodyArrayBuffer=A(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var m=B(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?B(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ae)}),this.text=function(){var m=B(this);if(m)return m;if(this._bodyBlob)return F(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(Y)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(m){var O=m.toUpperCase();return E.indexOf(O)>-1?O:m}function b(m,O){O=O||{};var ee=O.body;if(m instanceof b){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,O.headers||(this.headers=new $(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!ee&&m._bodyInit!=null&&(ee=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new $(O.headers)),this.method=u(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function Y(m){var O=new FormData;return m.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),K=Q.shift().replace(/\+/g," "),V=Q.join("=").replace(/\+/g," ");O.append(decodeURIComponent(K),decodeURIComponent(V))}}),O}function G(m){var O=new $,ee=m.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var K=Q.split(":"),V=K.shift().trim();if(V){var J=K.join(":").trim();O.append(V,J)}}),O}C.call(b.prototype);function ne(m,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new $(O.headers),this.url=O.url||"",this._initBody(m)}C.call(ne.prototype),ne.prototype.clone=function(){return new ne(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new $(this.headers),url:this.url})},ne.error=function(){var m=new ne(null,{status:0,statusText:""});return m.type="error",m};var ce=[301,302,303,307,308];ne.redirect=function(m,O){if(ce.indexOf(O)===-1)throw new RangeError("Invalid status code");return new ne(null,{status:O,headers:{location:m}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(O,ee){this.message=O,this.name=ee;var Q=Error(O);this.stack=Q.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function de(m,O){return new Promise(function(ee,Q){var K=new b(m,O);if(K.signal&&K.signal.aborted)return Q(new l.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:G(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var be="response"in V?V.response:V.responseText;ee(new ne(be,re))},V.onerror=function(){Q(new TypeError("Network request failed"))},V.ontimeout=function(){Q(new TypeError("Network request failed"))},V.onabort=function(){Q(new l.DOMException("Aborted","AbortError"))},V.open(K.method,K.url,!0),K.credentials==="include"?V.withCredentials=!0:K.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),K.headers.forEach(function(re,be){V.setRequestHeader(be,re)}),K.signal&&(K.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&K.signal.removeEventListener("abort",J)}),V.send(typeof K._bodyInit>"u"?null:K._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=$,c.Request=b,c.Response=ne),l.Headers=$,l.Request=b,l.Response=ne,l.fetch=de,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Ru,Ru.exports);var JI=Ru.exports;const md=Nd(JI),QI={Accept:"application/json","Content-Type":"application/json"},XI="POST",bd={headers:QI,method:XI},wd=10;class Li{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Ur.EventEmitter,this.isAvailable=!1,this.registering=!1,!Wf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Is(e),c=await(await md(this.url,Object.assign(Object.assign({},bd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Wf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Is({id:1,jsonrpc:"2.0",method:"test",params:[]});await md(e,Object.assign(Object.assign({},bd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Fu(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=aa(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return bp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>wd&&this.events.setMaxListeners(wd)}}const Ed="error",ZI="wss://relay.walletconnect.com",e5="wc",t5="universal_provider",Sd=`${e5}@2:${t5}:`,r5="https://rpc.walletconnect.com/v1/",bi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Cu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",p=500,w="__lodash_placeholder__",P=1,I=2,T=4,$=1,B=2,k=1,ae=2,F=4,M=8,A=16,C=32,E=64,u=128,b=256,Y=512,G=30,ne="...",ce=800,de=16,m=1,O=2,ee=3,Q=1/0,K=9007199254740991,V=17976931348623157e292,J=0/0,re=4294967295,be=re-1,se=re>>>1,we=[["ary",u],["bind",k],["bindKey",ae],["curry",M],["curryRight",A],["flip",Y],["partial",C],["partialRight",E],["rearg",b]],le="[object Arguments]",ve="[object Array]",H="[object AsyncFunction]",q="[object Boolean]",D="[object Date]",d="[object DOMException]",R="[object Error]",oe="[object Function]",fe="[object GeneratorFunction]",xe="[object Map]",ze="[object Number]",Ve="[object Null]",Ue="[object Object]",pt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",Oe="[object Set]",$e="[object String]",De="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Ie="[object ArrayBuffer]",Te="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",ur="[object Uint32Array]",Gr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wi=/&(?:amp|lt|gt|quot|#39);/g,Ui=/[&<>"']/g,Et=RegExp(wi.source),yt=RegExp(Ui.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,_t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,Lt=RegExp(xt.source),Ot=/^\s+/,Tt=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Ut=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,la=/[()=,{}\[\]\/\s]/,fa=/\\(\\)?/g,da=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pr=/\w*$/,pa=/^[-+]0x[0-9a-f]+$/i,ga=/^0b[01]+$/i,ya=/^\[object .+?Constructor\]$/,_a=/^0o[0-7]+$/i,va=/^(?:0|[1-9]\d*)$/,ii=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,an=/($^)/,ma=/['\n\r\u2028\u2029\\]/g,cn="\\ud800-\\udfff",ba="\\u0300-\\u036f",wa="\\ufe20-\\ufe2f",un="\\u20d0-\\u20ff",Fs=ba+wa+un,Ls="\\u2700-\\u27bf",jr="a-z\\xdf-\\xf6\\xf8-\\xff",Ea="\\xac\\xb1\\xd7\\xf7",Sa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ia="\\u2000-\\u206f",xa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Us="A-Z\\xc0-\\xd6\\xd8-\\xde",js="\\ufe0e\\ufe0f",ji=Ea+Sa+Ia+xa,Mn="['’]",Mi="["+cn+"]",qn="["+ji+"]",qi="["+Fs+"]",Ms="\\d+",Oa="["+Ls+"]",qs="["+jr+"]",Hs="[^"+cn+ji+Ms+Ls+jr+Us+"]",hn="\\ud83c[\\udffb-\\udfff]",Pa="(?:"+qi+"|"+hn+")",zs="[^"+cn+"]",ln="(?:\\ud83c[\\udde6-\\uddff]){2}",Ei="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="["+Us+"]",Bs="\\u200d",Ks="(?:"+qs+"|"+Hs+")",Wr="(?:"+mr+"|"+Hs+")",Vs="(?:"+Mn+"(?:d|ll|m|re|s|t|ve))?",ks="(?:"+Mn+"(?:D|LL|M|RE|S|T|VE))?",Gs=Pa+"?",Ws="["+js+"]?",Aa="(?:"+Bs+"(?:"+[zs,ln,Ei].join("|")+")"+Ws+Gs+")*",ni="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ys="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Js=Ws+Gs+Aa,fn="(?:"+[Oa,ln,Ei].join("|")+")"+Js,Ta="(?:"+[zs+qi+"?",qi,ln,Ei,Mi].join("|")+")",Hn=RegExp(Mn,"g"),Ra=RegExp(qi,"g"),dn=RegExp(hn+"(?="+hn+")|"+Ta+Js,"g"),Qs=RegExp([mr+"?"+qs+"+"+Vs+"(?="+[qn,mr,"$"].join("|")+")",Wr+"+"+ks+"(?="+[qn,mr+Ks,"$"].join("|")+")",mr+"?"+Ks+"+"+Vs,mr+"+"+ks,Ys,ni,Ms,fn].join("|"),"g"),Xs=RegExp("["+Bs+cn+Fs+js+"]"),Hi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ca=-1,ot={};ot[Be]=ot[Pe]=ot[ke]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[Zt]=ot[ur]=!0,ot[le]=ot[ve]=ot[Ie]=ot[q]=ot[Te]=ot[D]=ot[R]=ot[oe]=ot[xe]=ot[ze]=ot[Ue]=ot[Me]=ot[Oe]=ot[$e]=ot[Ae]=!1;var st={};st[le]=st[ve]=st[Ie]=st[Te]=st[q]=st[D]=st[Be]=st[Pe]=st[ke]=st[We]=st[et]=st[xe]=st[ze]=st[Ue]=st[Me]=st[Oe]=st[$e]=st[De]=st[tt]=st[Je]=st[Zt]=st[ur]=!0,st[R]=st[oe]=st[Ae]=!1;var S={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ce=parseInt,ft=typeof gs=="object"&&gs&&gs.Object===Object&&gs,Mt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=ft||Mt||Function("return this")(),ct=e&&!e.nodeType&&e,Rt=ct&&!0&&i&&!i.nodeType&&i,hr=Rt&&Rt.exports===ct,qt=hr&&ft.process,dt=function(){try{var U=Rt&&Rt.require&&Rt.require("util").types;return U||qt&&qt.binding&&qt.binding("util")}catch{}}(),tr=dt&&dt.isArrayBuffer,Mr=dt&&dt.isDate,Ar=dt&&dt.isMap,Yr=dt&&dt.isRegExp,zn=dt&&dt.isSet,zi=dt&&dt.isTypedArray;function Kt(U,W,z){switch(z.length){case 0:return U.call(W);case 1:return U.call(W,z[0]);case 2:return U.call(W,z[0],z[1]);case 3:return U.call(W,z[0],z[1],z[2])}return U.apply(W,z)}function Gp(U,W,z,ge){for(var Re=-1,rt=U==null?0:U.length;++Re<rt;){var zt=U[Re];W(ge,zt,z(zt),U)}return ge}function Tr(U,W){for(var z=-1,ge=U==null?0:U.length;++z<ge&&W(U[z],z,U)!==!1;);return U}function Wp(U,W){for(var z=U==null?0:U.length;z--&&W(U[z],z,U)!==!1;);return U}function rh(U,W){for(var z=-1,ge=U==null?0:U.length;++z<ge;)if(!W(U[z],z,U))return!1;return!0}function Si(U,W){for(var z=-1,ge=U==null?0:U.length,Re=0,rt=[];++z<ge;){var zt=U[z];W(zt,z,U)&&(rt[Re++]=zt)}return rt}function eo(U,W){var z=U==null?0:U.length;return!!z&&pn(U,W,0)>-1}function Na(U,W,z){for(var ge=-1,Re=U==null?0:U.length;++ge<Re;)if(z(W,U[ge]))return!0;return!1}function vt(U,W){for(var z=-1,ge=U==null?0:U.length,Re=Array(ge);++z<ge;)Re[z]=W(U[z],z,U);return Re}function Ii(U,W){for(var z=-1,ge=W.length,Re=U.length;++z<ge;)U[Re+z]=W[z];return U}function $a(U,W,z,ge){var Re=-1,rt=U==null?0:U.length;for(ge&&rt&&(z=U[++Re]);++Re<rt;)z=W(z,U[Re],Re,U);return z}function Yp(U,W,z,ge){var Re=U==null?0:U.length;for(ge&&Re&&(z=U[--Re]);Re--;)z=W(z,U[Re],Re,U);return z}function Da(U,W){for(var z=-1,ge=U==null?0:U.length;++z<ge;)if(W(U[z],z,U))return!0;return!1}var Jp=Fa("length");function Qp(U){return U.split("")}function Xp(U){return U.match(jt)||[]}function ih(U,W,z){var ge;return z(U,function(Re,rt,zt){if(W(Re,rt,zt))return ge=rt,!1}),ge}function to(U,W,z,ge){for(var Re=U.length,rt=z+(ge?1:-1);ge?rt--:++rt<Re;)if(W(U[rt],rt,U))return rt;return-1}function pn(U,W,z){return W===W?hg(U,W,z):to(U,nh,z)}function Zp(U,W,z,ge){for(var Re=z-1,rt=U.length;++Re<rt;)if(ge(U[Re],W))return Re;return-1}function nh(U){return U!==U}function sh(U,W){var z=U==null?0:U.length;return z?Ua(U,W)/z:J}function Fa(U){return function(W){return W==null?t:W[U]}}function La(U){return function(W){return U==null?t:U[W]}}function oh(U,W,z,ge,Re){return Re(U,function(rt,zt,ut){z=ge?(ge=!1,rt):W(z,rt,zt,ut)}),z}function eg(U,W){var z=U.length;for(U.sort(W);z--;)U[z]=U[z].value;return U}function Ua(U,W){for(var z,ge=-1,Re=U.length;++ge<Re;){var rt=W(U[ge]);rt!==t&&(z=z===t?rt:z+rt)}return z}function ja(U,W){for(var z=-1,ge=Array(U);++z<U;)ge[z]=W(z);return ge}function tg(U,W){return vt(W,function(z){return[z,U[z]]})}function ah(U){return U&&U.slice(0,lh(U)+1).replace(Ot,"")}function br(U){return function(W){return U(W)}}function Ma(U,W){return vt(W,function(z){return U[z]})}function Bn(U,W){return U.has(W)}function ch(U,W){for(var z=-1,ge=U.length;++z<ge&&pn(W,U[z],0)>-1;);return z}function uh(U,W){for(var z=U.length;z--&&pn(W,U[z],0)>-1;);return z}function rg(U,W){for(var z=U.length,ge=0;z--;)U[z]===W&&++ge;return ge}var ig=La(S),ng=La(L);function sg(U){return"\\"+pe[U]}function og(U,W){return U==null?t:U[W]}function gn(U){return Xs.test(U)}function ag(U){return Hi.test(U)}function cg(U){for(var W,z=[];!(W=U.next()).done;)z.push(W.value);return z}function qa(U){var W=-1,z=Array(U.size);return U.forEach(function(ge,Re){z[++W]=[Re,ge]}),z}function hh(U,W){return function(z){return U(W(z))}}function xi(U,W){for(var z=-1,ge=U.length,Re=0,rt=[];++z<ge;){var zt=U[z];(zt===W||zt===w)&&(U[z]=w,rt[Re++]=z)}return rt}function ro(U){var W=-1,z=Array(U.size);return U.forEach(function(ge){z[++W]=ge}),z}function ug(U){var W=-1,z=Array(U.size);return U.forEach(function(ge){z[++W]=[ge,ge]}),z}function hg(U,W,z){for(var ge=z-1,Re=U.length;++ge<Re;)if(U[ge]===W)return ge;return-1}function lg(U,W,z){for(var ge=z+1;ge--;)if(U[ge]===W)return ge;return ge}function yn(U){return gn(U)?dg(U):Jp(U)}function qr(U){return gn(U)?pg(U):Qp(U)}function lh(U){for(var W=U.length;W--&&Tt.test(U.charAt(W)););return W}var fg=La(te);function dg(U){for(var W=dn.lastIndex=0;dn.test(U);)++W;return W}function pg(U){return U.match(dn)||[]}function gg(U){return U.match(Qs)||[]}var yg=function U(W){W=W==null?Qe:_n.defaults(Qe.Object(),W,_n.pick(Qe,Zs));var z=W.Array,ge=W.Date,Re=W.Error,rt=W.Function,zt=W.Math,ut=W.Object,Ha=W.RegExp,_g=W.String,Rr=W.TypeError,io=z.prototype,vg=rt.prototype,vn=ut.prototype,no=W["__core-js_shared__"],so=vg.toString,nt=vn.hasOwnProperty,mg=0,fh=function(){var r=/[^.]+$/.exec(no&&no.keys&&no.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),oo=vn.toString,bg=so.call(ut),wg=Qe._,Eg=Ha("^"+so.call(nt).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ao=hr?W.Buffer:t,Oi=W.Symbol,co=W.Uint8Array,dh=ao?ao.allocUnsafe:t,uo=hh(ut.getPrototypeOf,ut),ph=ut.create,gh=vn.propertyIsEnumerable,ho=io.splice,yh=Oi?Oi.isConcatSpreadable:t,Kn=Oi?Oi.iterator:t,Bi=Oi?Oi.toStringTag:t,lo=function(){try{var r=Wi(ut,"defineProperty");return r({},"",{}),r}catch{}}(),Sg=W.clearTimeout!==Qe.clearTimeout&&W.clearTimeout,Ig=ge&&ge.now!==Qe.Date.now&&ge.now,xg=W.setTimeout!==Qe.setTimeout&&W.setTimeout,fo=zt.ceil,po=zt.floor,za=ut.getOwnPropertySymbols,Og=ao?ao.isBuffer:t,_h=W.isFinite,Pg=io.join,Ag=hh(ut.keys,ut),Bt=zt.max,Yt=zt.min,Tg=ge.now,Rg=W.parseInt,vh=zt.random,Cg=io.reverse,Ba=Wi(W,"DataView"),Vn=Wi(W,"Map"),Ka=Wi(W,"Promise"),mn=Wi(W,"Set"),kn=Wi(W,"WeakMap"),Gn=Wi(ut,"create"),go=kn&&new kn,bn={},Ng=Yi(Ba),$g=Yi(Vn),Dg=Yi(Ka),Fg=Yi(mn),Lg=Yi(kn),yo=Oi?Oi.prototype:t,Wn=yo?yo.valueOf:t,mh=yo?yo.toString:t;function _(r){if(At(r)&&!Ne(r)&&!(r instanceof Ye)){if(r instanceof Cr)return r;if(nt.call(r,"__wrapped__"))return bl(r)}return new Cr(r)}var wn=function(){function r(){}return function(n){if(!wt(n))return{};if(ph)return ph(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function _o(){}function Cr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}_.templateSettings={escape:St,evaluate:It,interpolate:bt,variable:"",imports:{_}},_.prototype=_o.prototype,_.prototype.constructor=_,Cr.prototype=wn(_o.prototype),Cr.prototype.constructor=Cr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Ug(){var r=new Ye(this.__wrapped__);return r.__actions__=lr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=lr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=lr(this.__views__),r}function jg(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Mg(){var r=this.__wrapped__.value(),n=this.__dir__,a=Ne(r),h=n<0,g=a?r.length:0,v=Q0(0,g,this.__views__),x=v.start,N=v.end,j=N-x,X=h?N:x-1,Z=this.__iteratees__,ie=Z.length,ue=0,ye=Yt(j,this.__takeCount__);if(!a||!h&&g==j&&ye==j)return Bh(r,this.__actions__);var Ee=[];e:for(;j--&&ue<ye;){X+=n;for(var He=-1,Se=r[X];++He<ie;){var Ge=Z[He],Xe=Ge.iteratee,Sr=Ge.type,nr=Xe(Se);if(Sr==O)Se=nr;else if(!nr){if(Sr==m)continue e;break e}}Ee[ue++]=Se}return Ee}Ye.prototype=wn(_o.prototype),Ye.prototype.constructor=Ye;function Ki(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function qg(){this.__data__=Gn?Gn(null):{},this.size=0}function Hg(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function zg(r){var n=this.__data__;if(Gn){var a=n[r];return a===y?t:a}return nt.call(n,r)?n[r]:t}function Bg(r){var n=this.__data__;return Gn?n[r]!==t:nt.call(n,r)}function Kg(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Gn&&n===t?y:n,this}Ki.prototype.clear=qg,Ki.prototype.delete=Hg,Ki.prototype.get=zg,Ki.prototype.has=Bg,Ki.prototype.set=Kg;function si(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Vg(){this.__data__=[],this.size=0}function kg(r){var n=this.__data__,a=vo(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():ho.call(n,a,1),--this.size,!0}function Gg(r){var n=this.__data__,a=vo(n,r);return a<0?t:n[a][1]}function Wg(r){return vo(this.__data__,r)>-1}function Yg(r,n){var a=this.__data__,h=vo(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}si.prototype.clear=Vg,si.prototype.delete=kg,si.prototype.get=Gg,si.prototype.has=Wg,si.prototype.set=Yg;function oi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Jg(){this.size=0,this.__data__={hash:new Ki,map:new(Vn||si),string:new Ki}}function Qg(r){var n=Ro(this,r).delete(r);return this.size-=n?1:0,n}function Xg(r){return Ro(this,r).get(r)}function Zg(r){return Ro(this,r).has(r)}function e0(r,n){var a=Ro(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}oi.prototype.clear=Jg,oi.prototype.delete=Qg,oi.prototype.get=Xg,oi.prototype.has=Zg,oi.prototype.set=e0;function Vi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new oi;++n<a;)this.add(r[n])}function t0(r){return this.__data__.set(r,y),this}function r0(r){return this.__data__.has(r)}Vi.prototype.add=Vi.prototype.push=t0,Vi.prototype.has=r0;function Hr(r){var n=this.__data__=new si(r);this.size=n.size}function i0(){this.__data__=new si,this.size=0}function n0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function s0(r){return this.__data__.get(r)}function o0(r){return this.__data__.has(r)}function a0(r,n){var a=this.__data__;if(a instanceof si){var h=a.__data__;if(!Vn||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new oi(h)}return a.set(r,n),this.size=a.size,this}Hr.prototype.clear=i0,Hr.prototype.delete=n0,Hr.prototype.get=s0,Hr.prototype.has=o0,Hr.prototype.set=a0;function bh(r,n){var a=Ne(r),h=!a&&Ji(r),g=!a&&!h&&Ci(r),v=!a&&!h&&!g&&xn(r),x=a||h||g||v,N=x?ja(r.length,_g):[],j=N.length;for(var X in r)(n||nt.call(r,X))&&!(x&&(X=="length"||g&&(X=="offset"||X=="parent")||v&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||hi(X,j)))&&N.push(X);return N}function wh(r){var n=r.length;return n?r[tc(0,n-1)]:t}function c0(r,n){return Co(lr(r),ki(n,0,r.length))}function u0(r){return Co(lr(r))}function Va(r,n,a){(a!==t&&!zr(r[n],a)||a===t&&!(n in r))&&ai(r,n,a)}function Yn(r,n,a){var h=r[n];(!(nt.call(r,n)&&zr(h,a))||a===t&&!(n in r))&&ai(r,n,a)}function vo(r,n){for(var a=r.length;a--;)if(zr(r[a][0],n))return a;return-1}function h0(r,n,a,h){return Pi(r,function(g,v,x){n(h,g,a(g),x)}),h}function Eh(r,n){return r&&Qr(n,Vt(n),r)}function l0(r,n){return r&&Qr(n,dr(n),r)}function ai(r,n,a){n=="__proto__"&&lo?lo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function ka(r,n){for(var a=-1,h=n.length,g=z(h),v=r==null;++a<h;)g[a]=v?t:Oc(r,n[a]);return g}function ki(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Nr(r,n,a,h,g,v){var x,N=n&P,j=n&I,X=n&T;if(a&&(x=g?a(r,h,g,v):a(r)),x!==t)return x;if(!wt(r))return r;var Z=Ne(r);if(Z){if(x=Z0(r),!N)return lr(r,x)}else{var ie=Jt(r),ue=ie==oe||ie==fe;if(Ci(r))return kh(r,N);if(ie==Ue||ie==le||ue&&!g){if(x=j||ue?{}:ll(r),!N)return j?z0(r,l0(x,r)):H0(r,Eh(x,r))}else{if(!st[ie])return g?r:{};x=ey(r,ie,N)}}v||(v=new Hr);var ye=v.get(r);if(ye)return ye;v.set(r,x),ql(r)?r.forEach(function(Se){x.add(Nr(Se,n,a,Se,r,v))}):jl(r)&&r.forEach(function(Se,Ge){x.set(Ge,Nr(Se,n,a,Ge,r,v))});var Ee=X?j?fc:lc:j?dr:Vt,He=Z?t:Ee(r);return Tr(He||r,function(Se,Ge){He&&(Ge=Se,Se=r[Ge]),Yn(x,Ge,Nr(Se,n,a,Ge,r,v))}),x}function f0(r){var n=Vt(r);return function(a){return Sh(a,r,n)}}function Sh(r,n,a){var h=a.length;if(r==null)return!h;for(r=ut(r);h--;){var g=a[h],v=n[g],x=r[g];if(x===t&&!(g in r)||!v(x))return!1}return!0}function Ih(r,n,a){if(typeof r!="function")throw new Rr(l);return rs(function(){r.apply(t,a)},n)}function Jn(r,n,a,h){var g=-1,v=eo,x=!0,N=r.length,j=[],X=n.length;if(!N)return j;a&&(n=vt(n,br(a))),h?(v=Na,x=!1):n.length>=o&&(v=Bn,x=!1,n=new Vi(n));e:for(;++g<N;){var Z=r[g],ie=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,x&&ie===ie){for(var ue=X;ue--;)if(n[ue]===ie)continue e;j.push(Z)}else v(n,ie,h)||j.push(Z)}return j}var Pi=Qh(Jr),xh=Qh(Wa,!0);function d0(r,n){var a=!0;return Pi(r,function(h,g,v){return a=!!n(h,g,v),a}),a}function mo(r,n,a){for(var h=-1,g=r.length;++h<g;){var v=r[h],x=n(v);if(x!=null&&(N===t?x===x&&!Er(x):a(x,N)))var N=x,j=v}return j}function p0(r,n,a,h){var g=r.length;for(a=je(a),a<0&&(a=-a>g?0:g+a),h=h===t||h>g?g:je(h),h<0&&(h+=g),h=a>h?0:zl(h);a<h;)r[a++]=n;return r}function Oh(r,n){var a=[];return Pi(r,function(h,g,v){n(h,g,v)&&a.push(h)}),a}function Gt(r,n,a,h,g){var v=-1,x=r.length;for(a||(a=ry),g||(g=[]);++v<x;){var N=r[v];n>0&&a(N)?n>1?Gt(N,n-1,a,h,g):Ii(g,N):h||(g[g.length]=N)}return g}var Ga=Xh(),Ph=Xh(!0);function Jr(r,n){return r&&Ga(r,n,Vt)}function Wa(r,n){return r&&Ph(r,n,Vt)}function bo(r,n){return Si(n,function(a){return li(r[a])})}function Gi(r,n){n=Ti(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[Xr(n[a++])];return a&&a==h?r:t}function Ah(r,n,a){var h=n(r);return Ne(r)?h:Ii(h,a(r))}function rr(r){return r==null?r===t?qe:Ve:Bi&&Bi in ut(r)?J0(r):uy(r)}function Ya(r,n){return r>n}function g0(r,n){return r!=null&&nt.call(r,n)}function y0(r,n){return r!=null&&n in ut(r)}function _0(r,n,a){return r>=Yt(n,a)&&r<Bt(n,a)}function Ja(r,n,a){for(var h=a?Na:eo,g=r[0].length,v=r.length,x=v,N=z(v),j=1/0,X=[];x--;){var Z=r[x];x&&n&&(Z=vt(Z,br(n))),j=Yt(Z.length,j),N[x]=!a&&(n||g>=120&&Z.length>=120)?new Vi(x&&Z):t}Z=r[0];var ie=-1,ue=N[0];e:for(;++ie<g&&X.length<j;){var ye=Z[ie],Ee=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(ue?Bn(ue,Ee):h(X,Ee,a))){for(x=v;--x;){var He=N[x];if(!(He?Bn(He,Ee):h(r[x],Ee,a)))continue e}ue&&ue.push(Ee),X.push(ye)}}return X}function v0(r,n,a,h){return Jr(r,function(g,v,x){n(h,a(g),v,x)}),h}function Qn(r,n,a){n=Ti(n,r),r=gl(r,n);var h=r==null?r:r[Xr(Dr(n))];return h==null?t:Kt(h,r,a)}function Th(r){return At(r)&&rr(r)==le}function m0(r){return At(r)&&rr(r)==Ie}function b0(r){return At(r)&&rr(r)==D}function Xn(r,n,a,h,g){return r===n?!0:r==null||n==null||!At(r)&&!At(n)?r!==r&&n!==n:w0(r,n,a,h,Xn,g)}function w0(r,n,a,h,g,v){var x=Ne(r),N=Ne(n),j=x?ve:Jt(r),X=N?ve:Jt(n);j=j==le?Ue:j,X=X==le?Ue:X;var Z=j==Ue,ie=X==Ue,ue=j==X;if(ue&&Ci(r)){if(!Ci(n))return!1;x=!0,Z=!1}if(ue&&!Z)return v||(v=new Hr),x||xn(r)?cl(r,n,a,h,g,v):W0(r,n,j,a,h,g,v);if(!(a&$)){var ye=Z&&nt.call(r,"__wrapped__"),Ee=ie&&nt.call(n,"__wrapped__");if(ye||Ee){var He=ye?r.value():r,Se=Ee?n.value():n;return v||(v=new Hr),g(He,Se,a,h,v)}}return ue?(v||(v=new Hr),Y0(r,n,a,h,g,v)):!1}function E0(r){return At(r)&&Jt(r)==xe}function Qa(r,n,a,h){var g=a.length,v=g,x=!h;if(r==null)return!v;for(r=ut(r);g--;){var N=a[g];if(x&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++g<v;){N=a[g];var j=N[0],X=r[j],Z=N[1];if(x&&N[2]){if(X===t&&!(j in r))return!1}else{var ie=new Hr;if(h)var ue=h(X,Z,j,r,n,ie);if(!(ue===t?Xn(Z,X,$|B,h,ie):ue))return!1}}return!0}function Rh(r){if(!wt(r)||ny(r))return!1;var n=li(r)?Eg:ya;return n.test(Yi(r))}function S0(r){return At(r)&&rr(r)==Me}function I0(r){return At(r)&&Jt(r)==Oe}function x0(r){return At(r)&&Uo(r.length)&&!!ot[rr(r)]}function Ch(r){return typeof r=="function"?r:r==null?pr:typeof r=="object"?Ne(r)?Dh(r[0],r[1]):$h(r):Zl(r)}function Xa(r){if(!ts(r))return Ag(r);var n=[];for(var a in ut(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function O0(r){if(!wt(r))return cy(r);var n=ts(r),a=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||a.push(h);return a}function Za(r,n){return r<n}function Nh(r,n){var a=-1,h=fr(r)?z(r.length):[];return Pi(r,function(g,v,x){h[++a]=n(g,v,x)}),h}function $h(r){var n=pc(r);return n.length==1&&n[0][2]?dl(n[0][0],n[0][1]):function(a){return a===r||Qa(a,r,n)}}function Dh(r,n){return yc(r)&&fl(n)?dl(Xr(r),n):function(a){var h=Oc(a,r);return h===t&&h===n?Pc(a,r):Xn(n,h,$|B)}}function wo(r,n,a,h,g){r!==n&&Ga(n,function(v,x){if(g||(g=new Hr),wt(v))P0(r,n,x,a,wo,h,g);else{var N=h?h(vc(r,x),v,x+"",r,n,g):t;N===t&&(N=v),Va(r,x,N)}},dr)}function P0(r,n,a,h,g,v,x){var N=vc(r,a),j=vc(n,a),X=x.get(j);if(X){Va(r,a,X);return}var Z=v?v(N,j,a+"",r,n,x):t,ie=Z===t;if(ie){var ue=Ne(j),ye=!ue&&Ci(j),Ee=!ue&&!ye&&xn(j);Z=j,ue||ye||Ee?Ne(N)?Z=N:Ct(N)?Z=lr(N):ye?(ie=!1,Z=kh(j,!0)):Ee?(ie=!1,Z=Gh(j,!0)):Z=[]:is(j)||Ji(j)?(Z=N,Ji(N)?Z=Bl(N):(!wt(N)||li(N))&&(Z=ll(j))):ie=!1}ie&&(x.set(j,Z),g(Z,j,h,v,x),x.delete(j)),Va(r,a,Z)}function Fh(r,n){var a=r.length;if(a)return n+=n<0?a:0,hi(n,a)?r[n]:t}function Lh(r,n,a){n.length?n=vt(n,function(v){return Ne(v)?function(x){return Gi(x,v.length===1?v[0]:v)}:v}):n=[pr];var h=-1;n=vt(n,br(me()));var g=Nh(r,function(v,x,N){var j=vt(n,function(X){return X(v)});return{criteria:j,index:++h,value:v}});return eg(g,function(v,x){return q0(v,x,a)})}function A0(r,n){return Uh(r,n,function(a,h){return Pc(r,h)})}function Uh(r,n,a){for(var h=-1,g=n.length,v={};++h<g;){var x=n[h],N=Gi(r,x);a(N,x)&&Zn(v,Ti(x,r),N)}return v}function T0(r){return function(n){return Gi(n,r)}}function ec(r,n,a,h){var g=h?Zp:pn,v=-1,x=n.length,N=r;for(r===n&&(n=lr(n)),a&&(N=vt(r,br(a)));++v<x;)for(var j=0,X=n[v],Z=a?a(X):X;(j=g(N,Z,j,h))>-1;)N!==r&&ho.call(N,j,1),ho.call(r,j,1);return r}function jh(r,n){for(var a=r?n.length:0,h=a-1;a--;){var g=n[a];if(a==h||g!==v){var v=g;hi(g)?ho.call(r,g,1):nc(r,g)}}return r}function tc(r,n){return r+po(vh()*(n-r+1))}function R0(r,n,a,h){for(var g=-1,v=Bt(fo((n-r)/(a||1)),0),x=z(v);v--;)x[h?v:++g]=r,r+=a;return x}function rc(r,n){var a="";if(!r||n<1||n>K)return a;do n%2&&(a+=r),n=po(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return mc(pl(r,n,pr),r+"")}function C0(r){return wh(On(r))}function N0(r,n){var a=On(r);return Co(a,ki(n,0,a.length))}function Zn(r,n,a,h){if(!wt(r))return r;n=Ti(n,r);for(var g=-1,v=n.length,x=v-1,N=r;N!=null&&++g<v;){var j=Xr(n[g]),X=a;if(j==="__proto__"||j==="constructor"||j==="prototype")return r;if(g!=x){var Z=N[j];X=h?h(Z,j,N):t,X===t&&(X=wt(Z)?Z:hi(n[g+1])?[]:{})}Yn(N,j,X),N=N[j]}return r}var Mh=go?function(r,n){return go.set(r,n),r}:pr,$0=lo?function(r,n){return lo(r,"toString",{configurable:!0,enumerable:!1,value:Tc(n),writable:!0})}:pr;function D0(r){return Co(On(r))}function $r(r,n,a){var h=-1,g=r.length;n<0&&(n=-n>g?0:g+n),a=a>g?g:a,a<0&&(a+=g),g=n>a?0:a-n>>>0,n>>>=0;for(var v=z(g);++h<g;)v[h]=r[h+n];return v}function F0(r,n){var a;return Pi(r,function(h,g,v){return a=n(h,g,v),!a}),!!a}function Eo(r,n,a){var h=0,g=r==null?h:r.length;if(typeof n=="number"&&n===n&&g<=se){for(;h<g;){var v=h+g>>>1,x=r[v];x!==null&&!Er(x)&&(a?x<=n:x<n)?h=v+1:g=v}return g}return ic(r,n,pr,a)}function ic(r,n,a,h){var g=0,v=r==null?0:r.length;if(v===0)return 0;n=a(n);for(var x=n!==n,N=n===null,j=Er(n),X=n===t;g<v;){var Z=po((g+v)/2),ie=a(r[Z]),ue=ie!==t,ye=ie===null,Ee=ie===ie,He=Er(ie);if(x)var Se=h||Ee;else X?Se=Ee&&(h||ue):N?Se=Ee&&ue&&(h||!ye):j?Se=Ee&&ue&&!ye&&(h||!He):ye||He?Se=!1:Se=h?ie<=n:ie<n;Se?g=Z+1:v=Z}return Yt(v,be)}function qh(r,n){for(var a=-1,h=r.length,g=0,v=[];++a<h;){var x=r[a],N=n?n(x):x;if(!a||!zr(N,j)){var j=N;v[g++]=x===0?0:x}}return v}function Hh(r){return typeof r=="number"?r:Er(r)?J:+r}function wr(r){if(typeof r=="string")return r;if(Ne(r))return vt(r,wr)+"";if(Er(r))return mh?mh.call(r):"";var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Ai(r,n,a){var h=-1,g=eo,v=r.length,x=!0,N=[],j=N;if(a)x=!1,g=Na;else if(v>=o){var X=n?null:k0(r);if(X)return ro(X);x=!1,g=Bn,j=new Vi}else j=n?[]:N;e:for(;++h<v;){var Z=r[h],ie=n?n(Z):Z;if(Z=a||Z!==0?Z:0,x&&ie===ie){for(var ue=j.length;ue--;)if(j[ue]===ie)continue e;n&&j.push(ie),N.push(Z)}else g(j,ie,a)||(j!==N&&j.push(ie),N.push(Z))}return N}function nc(r,n){return n=Ti(n,r),r=gl(r,n),r==null||delete r[Xr(Dr(n))]}function zh(r,n,a,h){return Zn(r,n,a(Gi(r,n)),h)}function So(r,n,a,h){for(var g=r.length,v=h?g:-1;(h?v--:++v<g)&&n(r[v],v,r););return a?$r(r,h?0:v,h?v+1:g):$r(r,h?v+1:0,h?g:v)}function Bh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),$a(n,function(h,g){return g.func.apply(g.thisArg,Ii([h],g.args))},a)}function sc(r,n,a){var h=r.length;if(h<2)return h?Ai(r[0]):[];for(var g=-1,v=z(h);++g<h;)for(var x=r[g],N=-1;++N<h;)N!=g&&(v[g]=Jn(v[g]||x,r[N],n,a));return Ai(Gt(v,1),n,a)}function Kh(r,n,a){for(var h=-1,g=r.length,v=n.length,x={};++h<g;){var N=h<v?n[h]:t;a(x,r[h],N)}return x}function oc(r){return Ct(r)?r:[]}function ac(r){return typeof r=="function"?r:pr}function Ti(r,n){return Ne(r)?r:yc(r,n)?[r]:ml(it(r))}var L0=Ke;function Ri(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:$r(r,n,a)}var Vh=Sg||function(r){return Qe.clearTimeout(r)};function kh(r,n){if(n)return r.slice();var a=r.length,h=dh?dh(a):new r.constructor(a);return r.copy(h),h}function cc(r){var n=new r.constructor(r.byteLength);return new co(n).set(new co(r)),n}function U0(r,n){var a=n?cc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function j0(r){var n=new r.constructor(r.source,Pr.exec(r));return n.lastIndex=r.lastIndex,n}function M0(r){return Wn?ut(Wn.call(r)):{}}function Gh(r,n){var a=n?cc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function Wh(r,n){if(r!==n){var a=r!==t,h=r===null,g=r===r,v=Er(r),x=n!==t,N=n===null,j=n===n,X=Er(n);if(!N&&!X&&!v&&r>n||v&&x&&j&&!N&&!X||h&&x&&j||!a&&j||!g)return 1;if(!h&&!v&&!X&&r<n||X&&a&&g&&!h&&!v||N&&a&&g||!x&&g||!j)return-1}return 0}function q0(r,n,a){for(var h=-1,g=r.criteria,v=n.criteria,x=g.length,N=a.length;++h<x;){var j=Wh(g[h],v[h]);if(j){if(h>=N)return j;var X=a[h];return j*(X=="desc"?-1:1)}}return r.index-n.index}function Yh(r,n,a,h){for(var g=-1,v=r.length,x=a.length,N=-1,j=n.length,X=Bt(v-x,0),Z=z(j+X),ie=!h;++N<j;)Z[N]=n[N];for(;++g<x;)(ie||g<v)&&(Z[a[g]]=r[g]);for(;X--;)Z[N++]=r[g++];return Z}function Jh(r,n,a,h){for(var g=-1,v=r.length,x=-1,N=a.length,j=-1,X=n.length,Z=Bt(v-N,0),ie=z(Z+X),ue=!h;++g<Z;)ie[g]=r[g];for(var ye=g;++j<X;)ie[ye+j]=n[j];for(;++x<N;)(ue||g<v)&&(ie[ye+a[x]]=r[g++]);return ie}function lr(r,n){var a=-1,h=r.length;for(n||(n=z(h));++a<h;)n[a]=r[a];return n}function Qr(r,n,a,h){var g=!a;a||(a={});for(var v=-1,x=n.length;++v<x;){var N=n[v],j=h?h(a[N],r[N],N,a,r):t;j===t&&(j=r[N]),g?ai(a,N,j):Yn(a,N,j)}return a}function H0(r,n){return Qr(r,gc(r),n)}function z0(r,n){return Qr(r,ul(r),n)}function Io(r,n){return function(a,h){var g=Ne(a)?Gp:h0,v=n?n():{};return g(a,r,me(h,2),v)}}function En(r){return Ke(function(n,a){var h=-1,g=a.length,v=g>1?a[g-1]:t,x=g>2?a[2]:t;for(v=r.length>3&&typeof v=="function"?(g--,v):t,x&&ir(a[0],a[1],x)&&(v=g<3?t:v,g=1),n=ut(n);++h<g;){var N=a[h];N&&r(n,N,h,v)}return n})}function Qh(r,n){return function(a,h){if(a==null)return a;if(!fr(a))return r(a,h);for(var g=a.length,v=n?g:-1,x=ut(a);(n?v--:++v<g)&&h(x[v],v,x)!==!1;);return a}}function Xh(r){return function(n,a,h){for(var g=-1,v=ut(n),x=h(n),N=x.length;N--;){var j=x[r?N:++g];if(a(v[j],j,v)===!1)break}return n}}function B0(r,n,a){var h=n&k,g=es(r);function v(){var x=this&&this!==Qe&&this instanceof v?g:r;return x.apply(h?a:this,arguments)}return v}function Zh(r){return function(n){n=it(n);var a=gn(n)?qr(n):t,h=a?a[0]:n.charAt(0),g=a?Ri(a,1).join(""):n.slice(1);return h[r]()+g}}function Sn(r){return function(n){return $a(Ql(Jl(n).replace(Hn,"")),r,"")}}function es(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=wn(r.prototype),h=r.apply(a,n);return wt(h)?h:a}}function K0(r,n,a){var h=es(r);function g(){for(var v=arguments.length,x=z(v),N=v,j=In(g);N--;)x[N]=arguments[N];var X=v<3&&x[0]!==j&&x[v-1]!==j?[]:xi(x,j);if(v-=X.length,v<a)return nl(r,n,xo,g.placeholder,t,x,X,t,t,a-v);var Z=this&&this!==Qe&&this instanceof g?h:r;return Kt(Z,this,x)}return g}function el(r){return function(n,a,h){var g=ut(n);if(!fr(n)){var v=me(a,3);n=Vt(n),a=function(N){return v(g[N],N,g)}}var x=r(n,a,h);return x>-1?g[v?n[x]:x]:t}}function tl(r){return ui(function(n){var a=n.length,h=a,g=Cr.prototype.thru;for(r&&n.reverse();h--;){var v=n[h];if(typeof v!="function")throw new Rr(l);if(g&&!x&&To(v)=="wrapper")var x=new Cr([],!0)}for(h=x?h:a;++h<a;){v=n[h];var N=To(v),j=N=="wrapper"?dc(v):t;j&&_c(j[0])&&j[1]==(u|M|C|b)&&!j[4].length&&j[9]==1?x=x[To(j[0])].apply(x,j[3]):x=v.length==1&&_c(v)?x[N]():x.thru(v)}return function(){var X=arguments,Z=X[0];if(x&&X.length==1&&Ne(Z))return x.plant(Z).value();for(var ie=0,ue=a?n[ie].apply(this,X):Z;++ie<a;)ue=n[ie].call(this,ue);return ue}})}function xo(r,n,a,h,g,v,x,N,j,X){var Z=n&u,ie=n&k,ue=n&ae,ye=n&(M|A),Ee=n&Y,He=ue?t:es(r);function Se(){for(var Ge=arguments.length,Xe=z(Ge),Sr=Ge;Sr--;)Xe[Sr]=arguments[Sr];if(ye)var nr=In(Se),Ir=rg(Xe,nr);if(h&&(Xe=Yh(Xe,h,g,ye)),v&&(Xe=Jh(Xe,v,x,ye)),Ge-=Ir,ye&&Ge<X){var Nt=xi(Xe,nr);return nl(r,n,xo,Se.placeholder,a,Xe,Nt,N,j,X-Ge)}var Br=ie?a:this,di=ue?Br[r]:r;return Ge=Xe.length,N?Xe=hy(Xe,N):Ee&&Ge>1&&Xe.reverse(),Z&&j<Ge&&(Xe.length=j),this&&this!==Qe&&this instanceof Se&&(di=He||es(di)),di.apply(Br,Xe)}return Se}function rl(r,n){return function(a,h){return v0(a,r,n(h),{})}}function Oo(r,n){return function(a,h){var g;if(a===t&&h===t)return n;if(a!==t&&(g=a),h!==t){if(g===t)return h;typeof a=="string"||typeof h=="string"?(a=wr(a),h=wr(h)):(a=Hh(a),h=Hh(h)),g=r(a,h)}return g}}function uc(r){return ui(function(n){return n=vt(n,br(me())),Ke(function(a){var h=this;return r(n,function(g){return Kt(g,h,a)})})})}function Po(r,n){n=n===t?" ":wr(n);var a=n.length;if(a<2)return a?rc(n,r):n;var h=rc(n,fo(r/yn(n)));return gn(n)?Ri(qr(h),0,r).join(""):h.slice(0,r)}function V0(r,n,a,h){var g=n&k,v=es(r);function x(){for(var N=-1,j=arguments.length,X=-1,Z=h.length,ie=z(Z+j),ue=this&&this!==Qe&&this instanceof x?v:r;++X<Z;)ie[X]=h[X];for(;j--;)ie[X++]=arguments[++N];return Kt(ue,g?a:this,ie)}return x}function il(r){return function(n,a,h){return h&&typeof h!="number"&&ir(n,a,h)&&(a=h=t),n=fi(n),a===t?(a=n,n=0):a=fi(a),h=h===t?n<a?1:-1:fi(h),R0(n,a,h,r)}}function Ao(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Fr(n),a=Fr(a)),r(n,a)}}function nl(r,n,a,h,g,v,x,N,j,X){var Z=n&M,ie=Z?x:t,ue=Z?t:x,ye=Z?v:t,Ee=Z?t:v;n|=Z?C:E,n&=~(Z?E:C),n&F||(n&=~(k|ae));var He=[r,n,g,ye,ie,Ee,ue,N,j,X],Se=a.apply(t,He);return _c(r)&&yl(Se,He),Se.placeholder=h,_l(Se,r,n)}function hc(r){var n=zt[r];return function(a,h){if(a=Fr(a),h=h==null?0:Yt(je(h),292),h&&_h(a)){var g=(it(a)+"e").split("e"),v=n(g[0]+"e"+(+g[1]+h));return g=(it(v)+"e").split("e"),+(g[0]+"e"+(+g[1]-h))}return n(a)}}var k0=mn&&1/ro(new mn([,-0]))[1]==Q?function(r){return new mn(r)}:Nc;function sl(r){return function(n){var a=Jt(n);return a==xe?qa(n):a==Oe?ug(n):tg(n,r(n))}}function ci(r,n,a,h,g,v,x,N){var j=n&ae;if(!j&&typeof r!="function")throw new Rr(l);var X=h?h.length:0;if(X||(n&=~(C|E),h=g=t),x=x===t?x:Bt(je(x),0),N=N===t?N:je(N),X-=g?g.length:0,n&E){var Z=h,ie=g;h=g=t}var ue=j?t:dc(r),ye=[r,n,a,h,g,Z,ie,v,x,N];if(ue&&ay(ye,ue),r=ye[0],n=ye[1],a=ye[2],h=ye[3],g=ye[4],N=ye[9]=ye[9]===t?j?0:r.length:Bt(ye[9]-X,0),!N&&n&(M|A)&&(n&=~(M|A)),!n||n==k)var Ee=B0(r,n,a);else n==M||n==A?Ee=K0(r,n,N):(n==C||n==(k|C))&&!g.length?Ee=V0(r,n,a,h):Ee=xo.apply(t,ye);var He=ue?Mh:yl;return _l(He(Ee,ye),r,n)}function ol(r,n,a,h){return r===t||zr(r,vn[a])&&!nt.call(h,a)?n:r}function al(r,n,a,h,g,v){return wt(r)&&wt(n)&&(v.set(n,r),wo(r,n,t,al,v),v.delete(n)),r}function G0(r){return is(r)?t:r}function cl(r,n,a,h,g,v){var x=a&$,N=r.length,j=n.length;if(N!=j&&!(x&&j>N))return!1;var X=v.get(r),Z=v.get(n);if(X&&Z)return X==n&&Z==r;var ie=-1,ue=!0,ye=a&B?new Vi:t;for(v.set(r,n),v.set(n,r);++ie<N;){var Ee=r[ie],He=n[ie];if(h)var Se=x?h(He,Ee,ie,n,r,v):h(Ee,He,ie,r,n,v);if(Se!==t){if(Se)continue;ue=!1;break}if(ye){if(!Da(n,function(Ge,Xe){if(!Bn(ye,Xe)&&(Ee===Ge||g(Ee,Ge,a,h,v)))return ye.push(Xe)})){ue=!1;break}}else if(!(Ee===He||g(Ee,He,a,h,v))){ue=!1;break}}return v.delete(r),v.delete(n),ue}function W0(r,n,a,h,g,v,x){switch(a){case Te:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Ie:return!(r.byteLength!=n.byteLength||!v(new co(r),new co(n)));case q:case D:case ze:return zr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case Me:case $e:return r==n+"";case xe:var N=qa;case Oe:var j=h&$;if(N||(N=ro),r.size!=n.size&&!j)return!1;var X=x.get(r);if(X)return X==n;h|=B,x.set(r,n);var Z=cl(N(r),N(n),h,g,v,x);return x.delete(r),Z;case De:if(Wn)return Wn.call(r)==Wn.call(n)}return!1}function Y0(r,n,a,h,g,v){var x=a&$,N=lc(r),j=N.length,X=lc(n),Z=X.length;if(j!=Z&&!x)return!1;for(var ie=j;ie--;){var ue=N[ie];if(!(x?ue in n:nt.call(n,ue)))return!1}var ye=v.get(r),Ee=v.get(n);if(ye&&Ee)return ye==n&&Ee==r;var He=!0;v.set(r,n),v.set(n,r);for(var Se=x;++ie<j;){ue=N[ie];var Ge=r[ue],Xe=n[ue];if(h)var Sr=x?h(Xe,Ge,ue,n,r,v):h(Ge,Xe,ue,r,n,v);if(!(Sr===t?Ge===Xe||g(Ge,Xe,a,h,v):Sr)){He=!1;break}Se||(Se=ue=="constructor")}if(He&&!Se){var nr=r.constructor,Ir=n.constructor;nr!=Ir&&"constructor"in r&&"constructor"in n&&!(typeof nr=="function"&&nr instanceof nr&&typeof Ir=="function"&&Ir instanceof Ir)&&(He=!1)}return v.delete(r),v.delete(n),He}function ui(r){return mc(pl(r,t,Sl),r+"")}function lc(r){return Ah(r,Vt,gc)}function fc(r){return Ah(r,dr,ul)}var dc=go?function(r){return go.get(r)}:Nc;function To(r){for(var n=r.name+"",a=bn[n],h=nt.call(bn,n)?a.length:0;h--;){var g=a[h],v=g.func;if(v==null||v==r)return g.name}return n}function In(r){var n=nt.call(_,"placeholder")?_:r;return n.placeholder}function me(){var r=_.iteratee||Rc;return r=r===Rc?Ch:r,arguments.length?r(arguments[0],arguments[1]):r}function Ro(r,n){var a=r.__data__;return iy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function pc(r){for(var n=Vt(r),a=n.length;a--;){var h=n[a],g=r[h];n[a]=[h,g,fl(g)]}return n}function Wi(r,n){var a=og(r,n);return Rh(a)?a:t}function J0(r){var n=nt.call(r,Bi),a=r[Bi];try{r[Bi]=t;var h=!0}catch{}var g=oo.call(r);return h&&(n?r[Bi]=a:delete r[Bi]),g}var gc=za?function(r){return r==null?[]:(r=ut(r),Si(za(r),function(n){return gh.call(r,n)}))}:$c,ul=za?function(r){for(var n=[];r;)Ii(n,gc(r)),r=uo(r);return n}:$c,Jt=rr;(Ba&&Jt(new Ba(new ArrayBuffer(1)))!=Te||Vn&&Jt(new Vn)!=xe||Ka&&Jt(Ka.resolve())!=pt||mn&&Jt(new mn)!=Oe||kn&&Jt(new kn)!=Ae)&&(Jt=function(r){var n=rr(r),a=n==Ue?r.constructor:t,h=a?Yi(a):"";if(h)switch(h){case Ng:return Te;case $g:return xe;case Dg:return pt;case Fg:return Oe;case Lg:return Ae}return n});function Q0(r,n,a){for(var h=-1,g=a.length;++h<g;){var v=a[h],x=v.size;switch(v.type){case"drop":r+=x;break;case"dropRight":n-=x;break;case"take":n=Yt(n,r+x);break;case"takeRight":r=Bt(r,n-x);break}}return{start:r,end:n}}function X0(r){var n=r.match(ht);return n?n[1].split(Ut):[]}function hl(r,n,a){n=Ti(n,r);for(var h=-1,g=n.length,v=!1;++h<g;){var x=Xr(n[h]);if(!(v=r!=null&&a(r,x)))break;r=r[x]}return v||++h!=g?v:(g=r==null?0:r.length,!!g&&Uo(g)&&hi(x,g)&&(Ne(r)||Ji(r)))}function Z0(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function ll(r){return typeof r.constructor=="function"&&!ts(r)?wn(uo(r)):{}}function ey(r,n,a){var h=r.constructor;switch(n){case Ie:return cc(r);case q:case D:return new h(+r);case Te:return U0(r,a);case Be:case Pe:case ke:case We:case et:case tt:case Je:case Zt:case ur:return Gh(r,a);case xe:return new h;case ze:case $e:return new h(r);case Me:return j0(r);case Oe:return new h;case De:return M0(r)}}function ty(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Pt,`{
/* [wrapped with `+n+`] */
`)}function ry(r){return Ne(r)||Ji(r)||!!(yh&&r&&r[yh])}function hi(r,n){var a=typeof r;return n=n??K,!!n&&(a=="number"||a!="symbol"&&va.test(r))&&r>-1&&r%1==0&&r<n}function ir(r,n,a){if(!wt(a))return!1;var h=typeof n;return(h=="number"?fr(a)&&hi(n,a.length):h=="string"&&n in a)?zr(a[n],r):!1}function yc(r,n){if(Ne(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Er(r)?!0:Dt.test(r)||!_t.test(r)||n!=null&&r in ut(n)}function iy(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function _c(r){var n=To(r),a=_[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var h=dc(a);return!!h&&r===h[0]}function ny(r){return!!fh&&fh in r}var sy=no?li:Dc;function ts(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||vn;return r===a}function fl(r){return r===r&&!wt(r)}function dl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ut(a))}}function oy(r){var n=Fo(r,function(h){return a.size===p&&a.clear(),h}),a=n.cache;return n}function ay(r,n){var a=r[1],h=n[1],g=a|h,v=g<(k|ae|u),x=h==u&&a==M||h==u&&a==b&&r[7].length<=n[8]||h==(u|b)&&n[7].length<=n[8]&&a==M;if(!(v||x))return r;h&k&&(r[2]=n[2],g|=a&k?0:F);var N=n[3];if(N){var j=r[3];r[3]=j?Yh(j,N,n[4]):N,r[4]=j?xi(r[3],w):n[4]}return N=n[5],N&&(j=r[5],r[5]=j?Jh(j,N,n[6]):N,r[6]=j?xi(r[5],w):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:Yt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=g,r}function cy(r){var n=[];if(r!=null)for(var a in ut(r))n.push(a);return n}function uy(r){return oo.call(r)}function pl(r,n,a){return n=Bt(n===t?r.length-1:n,0),function(){for(var h=arguments,g=-1,v=Bt(h.length-n,0),x=z(v);++g<v;)x[g]=h[n+g];g=-1;for(var N=z(n+1);++g<n;)N[g]=h[g];return N[n]=a(x),Kt(r,this,N)}}function gl(r,n){return n.length<2?r:Gi(r,$r(n,0,-1))}function hy(r,n){for(var a=r.length,h=Yt(n.length,a),g=lr(r);h--;){var v=n[h];r[h]=hi(v,a)?g[v]:t}return r}function vc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var yl=vl(Mh),rs=xg||function(r,n){return Qe.setTimeout(r,n)},mc=vl($0);function _l(r,n,a){var h=n+"";return mc(r,ty(h,ly(X0(h),a)))}function vl(r){var n=0,a=0;return function(){var h=Tg(),g=de-(h-a);if(a=h,g>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Co(r,n){var a=-1,h=r.length,g=h-1;for(n=n===t?h:n;++a<n;){var v=tc(a,g),x=r[v];r[v]=r[a],r[a]=x}return r.length=n,r}var ml=oy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ft,function(a,h,g,v){n.push(g?v.replace(fa,"$1"):h||a)}),n});function Xr(r){if(typeof r=="string"||Er(r))return r;var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function Yi(r){if(r!=null){try{return so.call(r)}catch{}try{return r+""}catch{}}return""}function ly(r,n){return Tr(we,function(a){var h="_."+a[0];n&a[1]&&!eo(r,h)&&r.push(h)}),r.sort()}function bl(r){if(r instanceof Ye)return r.clone();var n=new Cr(r.__wrapped__,r.__chain__);return n.__actions__=lr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function fy(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=Bt(je(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var g=0,v=0,x=z(fo(h/n));g<h;)x[v++]=$r(r,g,g+=n);return x}function dy(r){for(var n=-1,a=r==null?0:r.length,h=0,g=[];++n<a;){var v=r[n];v&&(g[h++]=v)}return g}function py(){var r=arguments.length;if(!r)return[];for(var n=z(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return Ii(Ne(a)?lr(a):[a],Gt(n,1))}var gy=Ke(function(r,n){return Ct(r)?Jn(r,Gt(n,1,Ct,!0)):[]}),yy=Ke(function(r,n){var a=Dr(n);return Ct(a)&&(a=t),Ct(r)?Jn(r,Gt(n,1,Ct,!0),me(a,2)):[]}),_y=Ke(function(r,n){var a=Dr(n);return Ct(a)&&(a=t),Ct(r)?Jn(r,Gt(n,1,Ct,!0),t,a):[]});function vy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),$r(r,n<0?0:n,h)):[]}function my(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,$r(r,0,n<0?0:n)):[]}function by(r,n){return r&&r.length?So(r,me(n,3),!0,!0):[]}function wy(r,n){return r&&r.length?So(r,me(n,3),!0):[]}function Ey(r,n,a,h){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&ir(r,n,a)&&(a=0,h=g),p0(r,n,a,h)):[]}function wl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:je(a);return g<0&&(g=Bt(h+g,0)),to(r,me(n,3),g)}function El(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=h-1;return a!==t&&(g=je(a),g=a<0?Bt(h+g,0):Yt(g,h-1)),to(r,me(n,3),g,!0)}function Sl(r){var n=r==null?0:r.length;return n?Gt(r,1):[]}function Sy(r){var n=r==null?0:r.length;return n?Gt(r,Q):[]}function Iy(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:je(n),Gt(r,n)):[]}function xy(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var g=r[n];h[g[0]]=g[1]}return h}function Il(r){return r&&r.length?r[0]:t}function Oy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:je(a);return g<0&&(g=Bt(h+g,0)),pn(r,n,g)}function Py(r){var n=r==null?0:r.length;return n?$r(r,0,-1):[]}var Ay=Ke(function(r){var n=vt(r,oc);return n.length&&n[0]===r[0]?Ja(n):[]}),Ty=Ke(function(r){var n=Dr(r),a=vt(r,oc);return n===Dr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?Ja(a,me(n,2)):[]}),Ry=Ke(function(r){var n=Dr(r),a=vt(r,oc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?Ja(a,t,n):[]});function Cy(r,n){return r==null?"":Pg.call(r,n)}function Dr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Ny(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var g=h;return a!==t&&(g=je(a),g=g<0?Bt(h+g,0):Yt(g,h-1)),n===n?lg(r,n,g):to(r,nh,g,!0)}function $y(r,n){return r&&r.length?Fh(r,je(n)):t}var Dy=Ke(xl);function xl(r,n){return r&&r.length&&n&&n.length?ec(r,n):r}function Fy(r,n,a){return r&&r.length&&n&&n.length?ec(r,n,me(a,2)):r}function Ly(r,n,a){return r&&r.length&&n&&n.length?ec(r,n,t,a):r}var Uy=ui(function(r,n){var a=r==null?0:r.length,h=ka(r,n);return jh(r,vt(n,function(g){return hi(g,a)?+g:g}).sort(Wh)),h});function jy(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,g=[],v=r.length;for(n=me(n,3);++h<v;){var x=r[h];n(x,h,r)&&(a.push(x),g.push(h))}return jh(r,g),a}function bc(r){return r==null?r:Cg.call(r)}function My(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&ir(r,n,a)?(n=0,a=h):(n=n==null?0:je(n),a=a===t?h:je(a)),$r(r,n,a)):[]}function qy(r,n){return Eo(r,n)}function Hy(r,n,a){return ic(r,n,me(a,2))}function zy(r,n){var a=r==null?0:r.length;if(a){var h=Eo(r,n);if(h<a&&zr(r[h],n))return h}return-1}function By(r,n){return Eo(r,n,!0)}function Ky(r,n,a){return ic(r,n,me(a,2),!0)}function Vy(r,n){var a=r==null?0:r.length;if(a){var h=Eo(r,n,!0)-1;if(zr(r[h],n))return h}return-1}function ky(r){return r&&r.length?qh(r):[]}function Gy(r,n){return r&&r.length?qh(r,me(n,2)):[]}function Wy(r){var n=r==null?0:r.length;return n?$r(r,1,n):[]}function Yy(r,n,a){return r&&r.length?(n=a||n===t?1:je(n),$r(r,0,n<0?0:n)):[]}function Jy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,$r(r,n<0?0:n,h)):[]}function Qy(r,n){return r&&r.length?So(r,me(n,3),!1,!0):[]}function Xy(r,n){return r&&r.length?So(r,me(n,3)):[]}var Zy=Ke(function(r){return Ai(Gt(r,1,Ct,!0))}),e_=Ke(function(r){var n=Dr(r);return Ct(n)&&(n=t),Ai(Gt(r,1,Ct,!0),me(n,2))}),t_=Ke(function(r){var n=Dr(r);return n=typeof n=="function"?n:t,Ai(Gt(r,1,Ct,!0),t,n)});function r_(r){return r&&r.length?Ai(r):[]}function i_(r,n){return r&&r.length?Ai(r,me(n,2)):[]}function n_(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ai(r,t,n):[]}function wc(r){if(!(r&&r.length))return[];var n=0;return r=Si(r,function(a){if(Ct(a))return n=Bt(a.length,n),!0}),ja(n,function(a){return vt(r,Fa(a))})}function Ol(r,n){if(!(r&&r.length))return[];var a=wc(r);return n==null?a:vt(a,function(h){return Kt(n,t,h)})}var s_=Ke(function(r,n){return Ct(r)?Jn(r,n):[]}),o_=Ke(function(r){return sc(Si(r,Ct))}),a_=Ke(function(r){var n=Dr(r);return Ct(n)&&(n=t),sc(Si(r,Ct),me(n,2))}),c_=Ke(function(r){var n=Dr(r);return n=typeof n=="function"?n:t,sc(Si(r,Ct),t,n)}),u_=Ke(wc);function h_(r,n){return Kh(r||[],n||[],Yn)}function l_(r,n){return Kh(r||[],n||[],Zn)}var f_=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Ol(r,a)});function Pl(r){var n=_(r);return n.__chain__=!0,n}function d_(r,n){return n(r),r}function No(r,n){return n(r)}var p_=ui(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,g=function(v){return ka(v,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!hi(a)?this.thru(g):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:No,args:[g],thisArg:t}),new Cr(h,this.__chain__).thru(function(v){return n&&!v.length&&v.push(t),v}))});function g_(){return Pl(this)}function y_(){return new Cr(this.value(),this.__chain__)}function __(){this.__values__===t&&(this.__values__=Hl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function v_(){return this}function m_(r){for(var n,a=this;a instanceof _o;){var h=bl(a);h.__index__=0,h.__values__=t,n?g.__wrapped__=h:n=h;var g=h;a=a.__wrapped__}return g.__wrapped__=r,n}function b_(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:No,args:[bc],thisArg:t}),new Cr(n,this.__chain__)}return this.thru(bc)}function w_(){return Bh(this.__wrapped__,this.__actions__)}var E_=Io(function(r,n,a){nt.call(r,a)?++r[a]:ai(r,a,1)});function S_(r,n,a){var h=Ne(r)?rh:d0;return a&&ir(r,n,a)&&(n=t),h(r,me(n,3))}function I_(r,n){var a=Ne(r)?Si:Oh;return a(r,me(n,3))}var x_=el(wl),O_=el(El);function P_(r,n){return Gt($o(r,n),1)}function A_(r,n){return Gt($o(r,n),Q)}function T_(r,n,a){return a=a===t?1:je(a),Gt($o(r,n),a)}function Al(r,n){var a=Ne(r)?Tr:Pi;return a(r,me(n,3))}function Tl(r,n){var a=Ne(r)?Wp:xh;return a(r,me(n,3))}var R_=Io(function(r,n,a){nt.call(r,a)?r[a].push(n):ai(r,a,[n])});function C_(r,n,a,h){r=fr(r)?r:On(r),a=a&&!h?je(a):0;var g=r.length;return a<0&&(a=Bt(g+a,0)),jo(r)?a<=g&&r.indexOf(n,a)>-1:!!g&&pn(r,n,a)>-1}var N_=Ke(function(r,n,a){var h=-1,g=typeof n=="function",v=fr(r)?z(r.length):[];return Pi(r,function(x){v[++h]=g?Kt(n,x,a):Qn(x,n,a)}),v}),$_=Io(function(r,n,a){ai(r,a,n)});function $o(r,n){var a=Ne(r)?vt:Nh;return a(r,me(n,3))}function D_(r,n,a,h){return r==null?[]:(Ne(n)||(n=n==null?[]:[n]),a=h?t:a,Ne(a)||(a=a==null?[]:[a]),Lh(r,n,a))}var F_=Io(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function L_(r,n,a){var h=Ne(r)?$a:oh,g=arguments.length<3;return h(r,me(n,4),a,g,Pi)}function U_(r,n,a){var h=Ne(r)?Yp:oh,g=arguments.length<3;return h(r,me(n,4),a,g,xh)}function j_(r,n){var a=Ne(r)?Si:Oh;return a(r,Lo(me(n,3)))}function M_(r){var n=Ne(r)?wh:C0;return n(r)}function q_(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=je(n);var h=Ne(r)?c0:N0;return h(r,n)}function H_(r){var n=Ne(r)?u0:D0;return n(r)}function z_(r){if(r==null)return 0;if(fr(r))return jo(r)?yn(r):r.length;var n=Jt(r);return n==xe||n==Oe?r.size:Xa(r).length}function B_(r,n,a){var h=Ne(r)?Da:F0;return a&&ir(r,n,a)&&(n=t),h(r,me(n,3))}var K_=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&ir(r,n[0],n[1])?n=[]:a>2&&ir(n[0],n[1],n[2])&&(n=[n[0]]),Lh(r,Gt(n,1),[])}),Do=Ig||function(){return Qe.Date.now()};function V_(r,n){if(typeof n!="function")throw new Rr(l);return r=je(r),function(){if(--r<1)return n.apply(this,arguments)}}function Rl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,ci(r,u,t,t,t,t,n)}function Cl(r,n){var a;if(typeof n!="function")throw new Rr(l);return r=je(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Ec=Ke(function(r,n,a){var h=k;if(a.length){var g=xi(a,In(Ec));h|=C}return ci(r,h,n,a,g)}),Nl=Ke(function(r,n,a){var h=k|ae;if(a.length){var g=xi(a,In(Nl));h|=C}return ci(n,h,r,a,g)});function $l(r,n,a){n=a?t:n;var h=ci(r,M,t,t,t,t,t,n);return h.placeholder=$l.placeholder,h}function Dl(r,n,a){n=a?t:n;var h=ci(r,A,t,t,t,t,t,n);return h.placeholder=Dl.placeholder,h}function Fl(r,n,a){var h,g,v,x,N,j,X=0,Z=!1,ie=!1,ue=!0;if(typeof r!="function")throw new Rr(l);n=Fr(n)||0,wt(a)&&(Z=!!a.leading,ie="maxWait"in a,v=ie?Bt(Fr(a.maxWait)||0,n):v,ue="trailing"in a?!!a.trailing:ue);function ye(Nt){var Br=h,di=g;return h=g=t,X=Nt,x=r.apply(di,Br),x}function Ee(Nt){return X=Nt,N=rs(Ge,n),Z?ye(Nt):x}function He(Nt){var Br=Nt-j,di=Nt-X,ef=n-Br;return ie?Yt(ef,v-di):ef}function Se(Nt){var Br=Nt-j,di=Nt-X;return j===t||Br>=n||Br<0||ie&&di>=v}function Ge(){var Nt=Do();if(Se(Nt))return Xe(Nt);N=rs(Ge,He(Nt))}function Xe(Nt){return N=t,ue&&h?ye(Nt):(h=g=t,x)}function Sr(){N!==t&&Vh(N),X=0,h=j=g=N=t}function nr(){return N===t?x:Xe(Do())}function Ir(){var Nt=Do(),Br=Se(Nt);if(h=arguments,g=this,j=Nt,Br){if(N===t)return Ee(j);if(ie)return Vh(N),N=rs(Ge,n),ye(j)}return N===t&&(N=rs(Ge,n)),x}return Ir.cancel=Sr,Ir.flush=nr,Ir}var k_=Ke(function(r,n){return Ih(r,1,n)}),G_=Ke(function(r,n,a){return Ih(r,Fr(n)||0,a)});function W_(r){return ci(r,Y)}function Fo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Rr(l);var a=function(){var h=arguments,g=n?n.apply(this,h):h[0],v=a.cache;if(v.has(g))return v.get(g);var x=r.apply(this,h);return a.cache=v.set(g,x)||v,x};return a.cache=new(Fo.Cache||oi),a}Fo.Cache=oi;function Lo(r){if(typeof r!="function")throw new Rr(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Y_(r){return Cl(2,r)}var J_=L0(function(r,n){n=n.length==1&&Ne(n[0])?vt(n[0],br(me())):vt(Gt(n,1),br(me()));var a=n.length;return Ke(function(h){for(var g=-1,v=Yt(h.length,a);++g<v;)h[g]=n[g].call(this,h[g]);return Kt(r,this,h)})}),Sc=Ke(function(r,n){var a=xi(n,In(Sc));return ci(r,C,t,n,a)}),Ll=Ke(function(r,n){var a=xi(n,In(Ll));return ci(r,E,t,n,a)}),Q_=ui(function(r,n){return ci(r,b,t,t,t,n)});function X_(r,n){if(typeof r!="function")throw new Rr(l);return n=n===t?n:je(n),Ke(r,n)}function Z_(r,n){if(typeof r!="function")throw new Rr(l);return n=n==null?0:Bt(je(n),0),Ke(function(a){var h=a[n],g=Ri(a,0,n);return h&&Ii(g,h),Kt(r,this,g)})}function ev(r,n,a){var h=!0,g=!0;if(typeof r!="function")throw new Rr(l);return wt(a)&&(h="leading"in a?!!a.leading:h,g="trailing"in a?!!a.trailing:g),Fl(r,n,{leading:h,maxWait:n,trailing:g})}function tv(r){return Rl(r,1)}function rv(r,n){return Sc(ac(n),r)}function iv(){if(!arguments.length)return[];var r=arguments[0];return Ne(r)?r:[r]}function nv(r){return Nr(r,T)}function sv(r,n){return n=typeof n=="function"?n:t,Nr(r,T,n)}function ov(r){return Nr(r,P|T)}function av(r,n){return n=typeof n=="function"?n:t,Nr(r,P|T,n)}function cv(r,n){return n==null||Sh(r,n,Vt(n))}function zr(r,n){return r===n||r!==r&&n!==n}var uv=Ao(Ya),hv=Ao(function(r,n){return r>=n}),Ji=Th(function(){return arguments}())?Th:function(r){return At(r)&&nt.call(r,"callee")&&!gh.call(r,"callee")},Ne=z.isArray,lv=tr?br(tr):m0;function fr(r){return r!=null&&Uo(r.length)&&!li(r)}function Ct(r){return At(r)&&fr(r)}function fv(r){return r===!0||r===!1||At(r)&&rr(r)==q}var Ci=Og||Dc,dv=Mr?br(Mr):b0;function pv(r){return At(r)&&r.nodeType===1&&!is(r)}function gv(r){if(r==null)return!0;if(fr(r)&&(Ne(r)||typeof r=="string"||typeof r.splice=="function"||Ci(r)||xn(r)||Ji(r)))return!r.length;var n=Jt(r);if(n==xe||n==Oe)return!r.size;if(ts(r))return!Xa(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function yv(r,n){return Xn(r,n)}function _v(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?Xn(r,n,t,a):!!h}function Ic(r){if(!At(r))return!1;var n=rr(r);return n==R||n==d||typeof r.message=="string"&&typeof r.name=="string"&&!is(r)}function vv(r){return typeof r=="number"&&_h(r)}function li(r){if(!wt(r))return!1;var n=rr(r);return n==oe||n==fe||n==H||n==gt}function Ul(r){return typeof r=="number"&&r==je(r)}function Uo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=K}function wt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function At(r){return r!=null&&typeof r=="object"}var jl=Ar?br(Ar):E0;function mv(r,n){return r===n||Qa(r,n,pc(n))}function bv(r,n,a){return a=typeof a=="function"?a:t,Qa(r,n,pc(n),a)}function wv(r){return Ml(r)&&r!=+r}function Ev(r){if(sy(r))throw new Re(c);return Rh(r)}function Sv(r){return r===null}function Iv(r){return r==null}function Ml(r){return typeof r=="number"||At(r)&&rr(r)==ze}function is(r){if(!At(r)||rr(r)!=Ue)return!1;var n=uo(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&so.call(a)==bg}var xc=Yr?br(Yr):S0;function xv(r){return Ul(r)&&r>=-K&&r<=K}var ql=zn?br(zn):I0;function jo(r){return typeof r=="string"||!Ne(r)&&At(r)&&rr(r)==$e}function Er(r){return typeof r=="symbol"||At(r)&&rr(r)==De}var xn=zi?br(zi):x0;function Ov(r){return r===t}function Pv(r){return At(r)&&Jt(r)==Ae}function Av(r){return At(r)&&rr(r)==Fe}var Tv=Ao(Za),Rv=Ao(function(r,n){return r<=n});function Hl(r){if(!r)return[];if(fr(r))return jo(r)?qr(r):lr(r);if(Kn&&r[Kn])return cg(r[Kn]());var n=Jt(r),a=n==xe?qa:n==Oe?ro:On;return a(r)}function fi(r){if(!r)return r===0?r:0;if(r=Fr(r),r===Q||r===-Q){var n=r<0?-1:1;return n*V}return r===r?r:0}function je(r){var n=fi(r),a=n%1;return n===n?a?n-a:n:0}function zl(r){return r?ki(je(r),0,re):0}function Fr(r){if(typeof r=="number")return r;if(Er(r))return J;if(wt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=wt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=ah(r);var a=ga.test(r);return a||_a.test(r)?Ce(r.slice(2),a?2:8):pa.test(r)?J:+r}function Bl(r){return Qr(r,dr(r))}function Cv(r){return r?ki(je(r),-K,K):r===0?r:0}function it(r){return r==null?"":wr(r)}var Nv=En(function(r,n){if(ts(n)||fr(n)){Qr(n,Vt(n),r);return}for(var a in n)nt.call(n,a)&&Yn(r,a,n[a])}),Kl=En(function(r,n){Qr(n,dr(n),r)}),Mo=En(function(r,n,a,h){Qr(n,dr(n),r,h)}),$v=En(function(r,n,a,h){Qr(n,Vt(n),r,h)}),Dv=ui(ka);function Fv(r,n){var a=wn(r);return n==null?a:Eh(a,n)}var Lv=Ke(function(r,n){r=ut(r);var a=-1,h=n.length,g=h>2?n[2]:t;for(g&&ir(n[0],n[1],g)&&(h=1);++a<h;)for(var v=n[a],x=dr(v),N=-1,j=x.length;++N<j;){var X=x[N],Z=r[X];(Z===t||zr(Z,vn[X])&&!nt.call(r,X))&&(r[X]=v[X])}return r}),Uv=Ke(function(r){return r.push(t,al),Kt(Vl,t,r)});function jv(r,n){return ih(r,me(n,3),Jr)}function Mv(r,n){return ih(r,me(n,3),Wa)}function qv(r,n){return r==null?r:Ga(r,me(n,3),dr)}function Hv(r,n){return r==null?r:Ph(r,me(n,3),dr)}function zv(r,n){return r&&Jr(r,me(n,3))}function Bv(r,n){return r&&Wa(r,me(n,3))}function Kv(r){return r==null?[]:bo(r,Vt(r))}function Vv(r){return r==null?[]:bo(r,dr(r))}function Oc(r,n,a){var h=r==null?t:Gi(r,n);return h===t?a:h}function kv(r,n){return r!=null&&hl(r,n,g0)}function Pc(r,n){return r!=null&&hl(r,n,y0)}var Gv=rl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=oo.call(n)),r[n]=a},Tc(pr)),Wv=rl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=oo.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},me),Yv=Ke(Qn);function Vt(r){return fr(r)?bh(r):Xa(r)}function dr(r){return fr(r)?bh(r,!0):O0(r)}function Jv(r,n){var a={};return n=me(n,3),Jr(r,function(h,g,v){ai(a,n(h,g,v),h)}),a}function Qv(r,n){var a={};return n=me(n,3),Jr(r,function(h,g,v){ai(a,g,n(h,g,v))}),a}var Xv=En(function(r,n,a){wo(r,n,a)}),Vl=En(function(r,n,a,h){wo(r,n,a,h)}),Zv=ui(function(r,n){var a={};if(r==null)return a;var h=!1;n=vt(n,function(v){return v=Ti(v,r),h||(h=v.length>1),v}),Qr(r,fc(r),a),h&&(a=Nr(a,P|I|T,G0));for(var g=n.length;g--;)nc(a,n[g]);return a});function e1(r,n){return kl(r,Lo(me(n)))}var t1=ui(function(r,n){return r==null?{}:A0(r,n)});function kl(r,n){if(r==null)return{};var a=vt(fc(r),function(h){return[h]});return n=me(n),Uh(r,a,function(h,g){return n(h,g[0])})}function r1(r,n,a){n=Ti(n,r);var h=-1,g=n.length;for(g||(g=1,r=t);++h<g;){var v=r==null?t:r[Xr(n[h])];v===t&&(h=g,v=a),r=li(v)?v.call(r):v}return r}function i1(r,n,a){return r==null?r:Zn(r,n,a)}function n1(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Zn(r,n,a,h)}var Gl=sl(Vt),Wl=sl(dr);function s1(r,n,a){var h=Ne(r),g=h||Ci(r)||xn(r);if(n=me(n,4),a==null){var v=r&&r.constructor;g?a=h?new v:[]:wt(r)?a=li(v)?wn(uo(r)):{}:a={}}return(g?Tr:Jr)(r,function(x,N,j){return n(a,x,N,j)}),a}function o1(r,n){return r==null?!0:nc(r,n)}function a1(r,n,a){return r==null?r:zh(r,n,ac(a))}function c1(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:zh(r,n,ac(a),h)}function On(r){return r==null?[]:Ma(r,Vt(r))}function u1(r){return r==null?[]:Ma(r,dr(r))}function h1(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=Fr(a),a=a===a?a:0),n!==t&&(n=Fr(n),n=n===n?n:0),ki(Fr(r),n,a)}function l1(r,n,a){return n=fi(n),a===t?(a=n,n=0):a=fi(a),r=Fr(r),_0(r,n,a)}function f1(r,n,a){if(a&&typeof a!="boolean"&&ir(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=fi(r),n===t?(n=r,r=0):n=fi(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var g=vh();return Yt(r+g*(n-r+at("1e-"+((g+"").length-1))),n)}return tc(r,n)}var d1=Sn(function(r,n,a){return n=n.toLowerCase(),r+(a?Yl(n):n)});function Yl(r){return Ac(it(r).toLowerCase())}function Jl(r){return r=it(r),r&&r.replace(ii,ig).replace(Ra,"")}function p1(r,n,a){r=it(r),n=wr(n);var h=r.length;a=a===t?h:ki(je(a),0,h);var g=a;return a-=n.length,a>=0&&r.slice(a,g)==n}function g1(r){return r=it(r),r&&yt.test(r)?r.replace(Ui,ng):r}function y1(r){return r=it(r),r&&Lt.test(r)?r.replace(xt,"\\$&"):r}var _1=Sn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),v1=Sn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),m1=Zh("toLowerCase");function b1(r,n,a){r=it(r),n=je(n);var h=n?yn(r):0;if(!n||h>=n)return r;var g=(n-h)/2;return Po(po(g),a)+r+Po(fo(g),a)}function w1(r,n,a){r=it(r),n=je(n);var h=n?yn(r):0;return n&&h<n?r+Po(n-h,a):r}function E1(r,n,a){r=it(r),n=je(n);var h=n?yn(r):0;return n&&h<n?Po(n-h,a)+r:r}function S1(r,n,a){return a||n==null?n=0:n&&(n=+n),Rg(it(r).replace(Ot,""),n||0)}function I1(r,n,a){return(a?ir(r,n,a):n===t)?n=1:n=je(n),rc(it(r),n)}function x1(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var O1=Sn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function P1(r,n,a){return a&&typeof a!="number"&&ir(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!xc(n))&&(n=wr(n),!n&&gn(r))?Ri(qr(r),0,a):r.split(n,a)):[]}var A1=Sn(function(r,n,a){return r+(a?" ":"")+Ac(n)});function T1(r,n,a){return r=it(r),a=a==null?0:ki(je(a),0,r.length),n=wr(n),r.slice(a,a+n.length)==n}function R1(r,n,a){var h=_.templateSettings;a&&ir(r,n,a)&&(n=t),r=it(r),n=Mo({},n,h,ol);var g=Mo({},n.imports,h.imports,ol),v=Vt(g),x=Ma(g,v),N,j,X=0,Z=n.interpolate||an,ie="__p += '",ue=Ha((n.escape||an).source+"|"+Z.source+"|"+(Z===bt?da:an).source+"|"+(n.evaluate||an).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ca+"]")+`
`;r.replace(ue,function(Se,Ge,Xe,Sr,nr,Ir){return Xe||(Xe=Sr),ie+=r.slice(X,Ir).replace(ma,sg),Ge&&(N=!0,ie+=`' +
__e(`+Ge+`) +
'`),nr&&(j=!0,ie+=`';
`+nr+`;
__p += '`),Xe&&(ie+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),X=Ir+Se.length,Se}),ie+=`';
`;var Ee=nt.call(n,"variable")&&n.variable;if(!Ee)ie=`with (obj) {
`+ie+`
}
`;else if(la.test(Ee))throw new Re(f);ie=(j?ie.replace(Gr,""):ie).replace(er,"$1").replace(ri,"$1;"),ie="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var He=Xl(function(){return rt(v,ye+"return "+ie).apply(t,x)});if(He.source=ie,Ic(He))throw He;return He}function C1(r){return it(r).toLowerCase()}function N1(r){return it(r).toUpperCase()}function $1(r,n,a){if(r=it(r),r&&(a||n===t))return ah(r);if(!r||!(n=wr(n)))return r;var h=qr(r),g=qr(n),v=ch(h,g),x=uh(h,g)+1;return Ri(h,v,x).join("")}function D1(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,lh(r)+1);if(!r||!(n=wr(n)))return r;var h=qr(r),g=uh(h,qr(n))+1;return Ri(h,0,g).join("")}function F1(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(Ot,"");if(!r||!(n=wr(n)))return r;var h=qr(r),g=ch(h,qr(n));return Ri(h,g).join("")}function L1(r,n){var a=G,h=ne;if(wt(n)){var g="separator"in n?n.separator:g;a="length"in n?je(n.length):a,h="omission"in n?wr(n.omission):h}r=it(r);var v=r.length;if(gn(r)){var x=qr(r);v=x.length}if(a>=v)return r;var N=a-yn(h);if(N<1)return h;var j=x?Ri(x,0,N).join(""):r.slice(0,N);if(g===t)return j+h;if(x&&(N+=j.length-N),xc(g)){if(r.slice(N).search(g)){var X,Z=j;for(g.global||(g=Ha(g.source,it(Pr.exec(g))+"g")),g.lastIndex=0;X=g.exec(Z);)var ie=X.index;j=j.slice(0,ie===t?N:ie)}}else if(r.indexOf(wr(g),N)!=N){var ue=j.lastIndexOf(g);ue>-1&&(j=j.slice(0,ue))}return j+h}function U1(r){return r=it(r),r&&Et.test(r)?r.replace(wi,fg):r}var j1=Sn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Ac=Zh("toUpperCase");function Ql(r,n,a){return r=it(r),n=a?t:n,n===t?ag(r)?gg(r):Xp(r):r.match(n)||[]}var Xl=Ke(function(r,n){try{return Kt(r,t,n)}catch(a){return Ic(a)?a:new Re(a)}}),M1=ui(function(r,n){return Tr(n,function(a){a=Xr(a),ai(r,a,Ec(r[a],r))}),r});function q1(r){var n=r==null?0:r.length,a=me();return r=n?vt(r,function(h){if(typeof h[1]!="function")throw new Rr(l);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var g=-1;++g<n;){var v=r[g];if(Kt(v[0],this,h))return Kt(v[1],this,h)}})}function H1(r){return f0(Nr(r,P))}function Tc(r){return function(){return r}}function z1(r,n){return r==null||r!==r?n:r}var B1=tl(),K1=tl(!0);function pr(r){return r}function Rc(r){return Ch(typeof r=="function"?r:Nr(r,P))}function V1(r){return $h(Nr(r,P))}function k1(r,n){return Dh(r,Nr(n,P))}var G1=Ke(function(r,n){return function(a){return Qn(a,r,n)}}),W1=Ke(function(r,n){return function(a){return Qn(r,a,n)}});function Cc(r,n,a){var h=Vt(n),g=bo(n,h);a==null&&!(wt(n)&&(g.length||!h.length))&&(a=n,n=r,r=this,g=bo(n,Vt(n)));var v=!(wt(a)&&"chain"in a)||!!a.chain,x=li(r);return Tr(g,function(N){var j=n[N];r[N]=j,x&&(r.prototype[N]=function(){var X=this.__chain__;if(v||X){var Z=r(this.__wrapped__),ie=Z.__actions__=lr(this.__actions__);return ie.push({func:j,args:arguments,thisArg:r}),Z.__chain__=X,Z}return j.apply(r,Ii([this.value()],arguments))})}),r}function Y1(){return Qe._===this&&(Qe._=wg),this}function Nc(){}function J1(r){return r=je(r),Ke(function(n){return Fh(n,r)})}var Q1=uc(vt),X1=uc(rh),Z1=uc(Da);function Zl(r){return yc(r)?Fa(Xr(r)):T0(r)}function em(r){return function(n){return r==null?t:Gi(r,n)}}var tm=il(),rm=il(!0);function $c(){return[]}function Dc(){return!1}function im(){return{}}function nm(){return""}function sm(){return!0}function om(r,n){if(r=je(r),r<1||r>K)return[];var a=re,h=Yt(r,re);n=me(n),r-=re;for(var g=ja(h,n);++a<r;)n(a);return g}function am(r){return Ne(r)?vt(r,Xr):Er(r)?[r]:lr(ml(it(r)))}function cm(r){var n=++mg;return it(r)+n}var um=Oo(function(r,n){return r+n},0),hm=hc("ceil"),lm=Oo(function(r,n){return r/n},1),fm=hc("floor");function dm(r){return r&&r.length?mo(r,pr,Ya):t}function pm(r,n){return r&&r.length?mo(r,me(n,2),Ya):t}function gm(r){return sh(r,pr)}function ym(r,n){return sh(r,me(n,2))}function _m(r){return r&&r.length?mo(r,pr,Za):t}function vm(r,n){return r&&r.length?mo(r,me(n,2),Za):t}var mm=Oo(function(r,n){return r*n},1),bm=hc("round"),wm=Oo(function(r,n){return r-n},0);function Em(r){return r&&r.length?Ua(r,pr):0}function Sm(r,n){return r&&r.length?Ua(r,me(n,2)):0}return _.after=V_,_.ary=Rl,_.assign=Nv,_.assignIn=Kl,_.assignInWith=Mo,_.assignWith=$v,_.at=Dv,_.before=Cl,_.bind=Ec,_.bindAll=M1,_.bindKey=Nl,_.castArray=iv,_.chain=Pl,_.chunk=fy,_.compact=dy,_.concat=py,_.cond=q1,_.conforms=H1,_.constant=Tc,_.countBy=E_,_.create=Fv,_.curry=$l,_.curryRight=Dl,_.debounce=Fl,_.defaults=Lv,_.defaultsDeep=Uv,_.defer=k_,_.delay=G_,_.difference=gy,_.differenceBy=yy,_.differenceWith=_y,_.drop=vy,_.dropRight=my,_.dropRightWhile=by,_.dropWhile=wy,_.fill=Ey,_.filter=I_,_.flatMap=P_,_.flatMapDeep=A_,_.flatMapDepth=T_,_.flatten=Sl,_.flattenDeep=Sy,_.flattenDepth=Iy,_.flip=W_,_.flow=B1,_.flowRight=K1,_.fromPairs=xy,_.functions=Kv,_.functionsIn=Vv,_.groupBy=R_,_.initial=Py,_.intersection=Ay,_.intersectionBy=Ty,_.intersectionWith=Ry,_.invert=Gv,_.invertBy=Wv,_.invokeMap=N_,_.iteratee=Rc,_.keyBy=$_,_.keys=Vt,_.keysIn=dr,_.map=$o,_.mapKeys=Jv,_.mapValues=Qv,_.matches=V1,_.matchesProperty=k1,_.memoize=Fo,_.merge=Xv,_.mergeWith=Vl,_.method=G1,_.methodOf=W1,_.mixin=Cc,_.negate=Lo,_.nthArg=J1,_.omit=Zv,_.omitBy=e1,_.once=Y_,_.orderBy=D_,_.over=Q1,_.overArgs=J_,_.overEvery=X1,_.overSome=Z1,_.partial=Sc,_.partialRight=Ll,_.partition=F_,_.pick=t1,_.pickBy=kl,_.property=Zl,_.propertyOf=em,_.pull=Dy,_.pullAll=xl,_.pullAllBy=Fy,_.pullAllWith=Ly,_.pullAt=Uy,_.range=tm,_.rangeRight=rm,_.rearg=Q_,_.reject=j_,_.remove=jy,_.rest=X_,_.reverse=bc,_.sampleSize=q_,_.set=i1,_.setWith=n1,_.shuffle=H_,_.slice=My,_.sortBy=K_,_.sortedUniq=ky,_.sortedUniqBy=Gy,_.split=P1,_.spread=Z_,_.tail=Wy,_.take=Yy,_.takeRight=Jy,_.takeRightWhile=Qy,_.takeWhile=Xy,_.tap=d_,_.throttle=ev,_.thru=No,_.toArray=Hl,_.toPairs=Gl,_.toPairsIn=Wl,_.toPath=am,_.toPlainObject=Bl,_.transform=s1,_.unary=tv,_.union=Zy,_.unionBy=e_,_.unionWith=t_,_.uniq=r_,_.uniqBy=i_,_.uniqWith=n_,_.unset=o1,_.unzip=wc,_.unzipWith=Ol,_.update=a1,_.updateWith=c1,_.values=On,_.valuesIn=u1,_.without=s_,_.words=Ql,_.wrap=rv,_.xor=o_,_.xorBy=a_,_.xorWith=c_,_.zip=u_,_.zipObject=h_,_.zipObjectDeep=l_,_.zipWith=f_,_.entries=Gl,_.entriesIn=Wl,_.extend=Kl,_.extendWith=Mo,Cc(_,_),_.add=um,_.attempt=Xl,_.camelCase=d1,_.capitalize=Yl,_.ceil=hm,_.clamp=h1,_.clone=nv,_.cloneDeep=ov,_.cloneDeepWith=av,_.cloneWith=sv,_.conformsTo=cv,_.deburr=Jl,_.defaultTo=z1,_.divide=lm,_.endsWith=p1,_.eq=zr,_.escape=g1,_.escapeRegExp=y1,_.every=S_,_.find=x_,_.findIndex=wl,_.findKey=jv,_.findLast=O_,_.findLastIndex=El,_.findLastKey=Mv,_.floor=fm,_.forEach=Al,_.forEachRight=Tl,_.forIn=qv,_.forInRight=Hv,_.forOwn=zv,_.forOwnRight=Bv,_.get=Oc,_.gt=uv,_.gte=hv,_.has=kv,_.hasIn=Pc,_.head=Il,_.identity=pr,_.includes=C_,_.indexOf=Oy,_.inRange=l1,_.invoke=Yv,_.isArguments=Ji,_.isArray=Ne,_.isArrayBuffer=lv,_.isArrayLike=fr,_.isArrayLikeObject=Ct,_.isBoolean=fv,_.isBuffer=Ci,_.isDate=dv,_.isElement=pv,_.isEmpty=gv,_.isEqual=yv,_.isEqualWith=_v,_.isError=Ic,_.isFinite=vv,_.isFunction=li,_.isInteger=Ul,_.isLength=Uo,_.isMap=jl,_.isMatch=mv,_.isMatchWith=bv,_.isNaN=wv,_.isNative=Ev,_.isNil=Iv,_.isNull=Sv,_.isNumber=Ml,_.isObject=wt,_.isObjectLike=At,_.isPlainObject=is,_.isRegExp=xc,_.isSafeInteger=xv,_.isSet=ql,_.isString=jo,_.isSymbol=Er,_.isTypedArray=xn,_.isUndefined=Ov,_.isWeakMap=Pv,_.isWeakSet=Av,_.join=Cy,_.kebabCase=_1,_.last=Dr,_.lastIndexOf=Ny,_.lowerCase=v1,_.lowerFirst=m1,_.lt=Tv,_.lte=Rv,_.max=dm,_.maxBy=pm,_.mean=gm,_.meanBy=ym,_.min=_m,_.minBy=vm,_.stubArray=$c,_.stubFalse=Dc,_.stubObject=im,_.stubString=nm,_.stubTrue=sm,_.multiply=mm,_.nth=$y,_.noConflict=Y1,_.noop=Nc,_.now=Do,_.pad=b1,_.padEnd=w1,_.padStart=E1,_.parseInt=S1,_.random=f1,_.reduce=L_,_.reduceRight=U_,_.repeat=I1,_.replace=x1,_.result=r1,_.round=bm,_.runInContext=U,_.sample=M_,_.size=z_,_.snakeCase=O1,_.some=B_,_.sortedIndex=qy,_.sortedIndexBy=Hy,_.sortedIndexOf=zy,_.sortedLastIndex=By,_.sortedLastIndexBy=Ky,_.sortedLastIndexOf=Vy,_.startCase=A1,_.startsWith=T1,_.subtract=wm,_.sum=Em,_.sumBy=Sm,_.template=R1,_.times=om,_.toFinite=fi,_.toInteger=je,_.toLength=zl,_.toLower=C1,_.toNumber=Fr,_.toSafeInteger=Cv,_.toString=it,_.toUpper=N1,_.trim=$1,_.trimEnd=D1,_.trimStart=F1,_.truncate=L1,_.unescape=U1,_.uniqueId=cm,_.upperCase=j1,_.upperFirst=Ac,_.each=Al,_.eachRight=Tl,_.first=Il,Cc(_,function(){var r={};return Jr(_,function(n,a){nt.call(_.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),_.VERSION=s,Tr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){_[r].placeholder=_}),Tr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Bt(je(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Yt(a,h.__takeCount__):h.__views__.push({size:Yt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Tr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==m||a==ee;Ye.prototype[r]=function(g){var v=this.clone();return v.__iteratees__.push({iteratee:me(g,3),type:a}),v.__filtered__=v.__filtered__||h,v}}),Tr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Tr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(pr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return Qn(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(Lo(me(r)))},Ye.prototype.slice=function(r,n){r=je(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=je(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Jr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),g=_[h?"take"+(n=="last"?"Right":""):n],v=h||/^find/.test(n);g&&(_.prototype[n]=function(){var x=this.__wrapped__,N=h?[1]:arguments,j=x instanceof Ye,X=N[0],Z=j||Ne(x),ie=function(Ge){var Xe=g.apply(_,Ii([Ge],N));return h&&ue?Xe[0]:Xe};Z&&a&&typeof X=="function"&&X.length!=1&&(j=Z=!1);var ue=this.__chain__,ye=!!this.__actions__.length,Ee=v&&!ue,He=j&&!ye;if(!v&&Z){x=He?x:new Ye(this);var Se=r.apply(x,N);return Se.__actions__.push({func:No,args:[ie],thisArg:t}),new Cr(Se,ue)}return Ee&&He?r.apply(this,N):(Se=this.thru(ie),Ee?h?Se.value()[0]:Se.value():Se)})}),Tr(["pop","push","shift","sort","splice","unshift"],function(r){var n=io[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);_.prototype[r]=function(){var g=arguments;if(h&&!this.__chain__){var v=this.value();return n.apply(Ne(v)?v:[],g)}return this[a](function(x){return n.apply(Ne(x)?x:[],g)})}}),Jr(Ye.prototype,function(r,n){var a=_[n];if(a){var h=a.name+"";nt.call(bn,h)||(bn[h]=[]),bn[h].push({name:n,func:a})}}),bn[xo(t,ae).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=Ug,Ye.prototype.reverse=jg,Ye.prototype.value=Mg,_.prototype.at=p_,_.prototype.chain=g_,_.prototype.commit=y_,_.prototype.next=__,_.prototype.plant=m_,_.prototype.reverse=b_,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=w_,_.prototype.first=_.prototype.head,Kn&&(_.prototype[Kn]=v_),_},_n=yg();Rt?((Rt.exports=_n)._=_n,ct._=_n):Qe._=_n}).call(gs)})(Cu,Cu.exports);var i5=Object.defineProperty,n5=Object.defineProperties,s5=Object.getOwnPropertyDescriptors,Id=Object.getOwnPropertySymbols,o5=Object.prototype.hasOwnProperty,a5=Object.prototype.propertyIsEnumerable,xd=(i,e,t)=>e in i?i5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,zo=(i,e)=>{for(var t in e||(e={}))o5.call(e,t)&&xd(i,t,e[t]);if(Id)for(var t of Id(e))a5.call(e,t)&&xd(i,t,e[t]);return i},c5=(i,e)=>n5(i,s5(e));function Di(i,e,t){var s;const o=i6(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${r5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function on(i){return i.includes(":")?i.split(":")[1]:i}function Vp(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function u5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function h5(i={},e={}){const t=Od(i),s=Od(e);return Cu.exports.merge(t,s)}function Od(i){var e,t,s,o;const c={};if(!Nn(i))return c;for(const[l,f]of Object.entries(i)){const y=Vu(l)?[l]:f.chains,p=f.methods||[],w=f.events||[],P=f.rpcMap||{},I=ys(l);c[I]=c5(zo(zo({},c[I]),f),{chains:Kc(y,(e=c[I])==null?void 0:e.chains),methods:Kc(p,(t=c[I])==null?void 0:t.methods),events:Kc(w,(s=c[I])==null?void 0:s.events),rpcMap:zo(zo({},P),(o=c[I])==null?void 0:o.rpcMap)})}return c}function l5(i){return i.includes(":")?i.split(":")[2]:i}function f5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=Vu(t)?[t]:s.chains?s.chains:Vp(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function Qc(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):i.includes(":")?Number(i.split(":")[1]):Number(i)}const kp={},mt=i=>kp[i],Xc=(i,e)=>{kp[i]=e};class d5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=on(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class p5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Di(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(on(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class g5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=on(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class y5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=on(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class _5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=on(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class v5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=on(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class m5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=on(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new mi(new Li(s,mt("disableProviderPing")))}}class b5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Di(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(bi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Di(e,this.namespace);return typeof s>"u"?void 0:new mi(new Li(s,mt("disableProviderPing")))}}var w5=Object.defineProperty,E5=Object.defineProperties,S5=Object.getOwnPropertyDescriptors,Pd=Object.getOwnPropertySymbols,I5=Object.prototype.hasOwnProperty,x5=Object.prototype.propertyIsEnumerable,Ad=(i,e,t)=>e in i?w5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Bo=(i,e)=>{for(var t in e||(e={}))I5.call(e,t)&&Ad(i,t,e[t]);if(Pd)for(var t of Pd(e))x5.call(e,t)&&Ad(i,t,e[t]);return i},Zc=(i,e)=>E5(i,S5(e));class eh{constructor(e){this.events=new Du,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ed})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new eh(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Bo({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=f5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Bp)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ti(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await YI.init({logger:this.providerOpts.logger||Ed,relayUrl:this.providerOpts.relayUrl||ZI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ys(t)))];Xc("client",this.client),Xc("events",this.events),Xc("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=u5(t,this.session),o=Vp(s),c=h5(this.namespaces,this.optionalNamespaces),l=Zc(Bo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new p5({namespace:l});break;case"solana":this.rpcProviders[t]=new g5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new y5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new d5({namespace:l});break;case"cip34":this.rpcProviders[t]=new _5({namespace:l});break;case"elrond":this.rpcProviders[t]=new v5({namespace:l});break;case"multiversx":this.rpcProviders[t]=new m5({namespace:l});break;case"near":this.rpcProviders[t]=new b5({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ti(o)&&this.events.emit("accountsChanged",o.map(l5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=ys(o),f=Qc(o)!==Qc(c)?`${l}:${Qc(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Zc(Bo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Zc(Bo({},$t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(bi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>ys(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=ys(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Sd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Sd}/${e}`)}}const O5=eh,P5="wc",A5="ethereum_provider",T5=`${P5}@2:${A5}:`,R5="https://rpc.walletconnect.com/v1/",Nu=["eth_sendTransaction","personal_sign"],C5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],$u=["chainChanged","accountsChanged"],N5=["chainChanged","accountsChanged","message","disconnect","connect"];var $5=Object.defineProperty,D5=Object.defineProperties,F5=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,L5=Object.prototype.hasOwnProperty,U5=Object.prototype.propertyIsEnumerable,Rd=(i,e,t)=>e in i?$5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vs=(i,e)=>{for(var t in e||(e={}))L5.call(e,t)&&Rd(i,t,e[t]);if(Td)for(var t of Td(e))U5.call(e,t)&&Rd(i,t,e[t]);return i},Cd=(i,e)=>D5(i,F5(e));function Xo(i){return Number(i[0].split(":")[1])}function eu(i){return`0x${i.toString(16)}`}function j5(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=i;if(!ti(e))throw new Error("Invalid chains");const y={chains:e,methods:s||Nu,events:c||$u,rpcMap:vs({},e.length?{[Xo(e)]:f[Xo(e)]}:{})},p=c==null?void 0:c.filter(T=>!$u.includes(T)),w=s==null?void 0:s.filter(T=>!Nu.includes(T));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(w!=null&&w.length))return{required:e.length?y:void 0};const P=(p==null?void 0:p.length)&&(w==null?void 0:w.length)||!t,I={chains:[...new Set(P?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:C5))],events:[...new Set(y.events.concat(l!=null&&l.length?l:N5))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?I:void 0}}class th{constructor(){this.events=new Ur.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=T5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new th;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=j5(this.rpc);try{const o=await new Promise(async(l,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Cd(vs({namespaces:vs({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=n6(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:eu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",eu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Cd(vs({},$t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",eu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Nu:[],y=o.length?(e==null?void 0:e.events)||$u:[],p=(e==null?void 0:e.optionalMethods)||[],w=(e==null?void 0:e.optionalEvents)||[],P=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),I=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(T=>this.formatChainId(T)),optionalChains:c.map(T=>this.formatChainId(T)),methods:f,events:y,optionalMethods:p,optionalEvents:w,rpcMap:P,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:I,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Xo(this.rpc.chains):Xo(this.rpc.optionalChains),this.signer=await O5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{t=require("@walletconnect/modal").WalletConnectModal}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(vs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&ti(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ti(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${R5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Z5=th;export{Z5 as EthereumProvider,N5 as OPTIONAL_EVENTS,C5 as OPTIONAL_METHODS,$u as REQUIRED_EVENTS,Nu as REQUIRED_METHODS,th as default};
